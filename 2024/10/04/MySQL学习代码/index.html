<!DOCTYPE html><html lang="en" theme-mode="dark"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>MySQL学习代码 | blog</title><link rel="icon" type="image/x-icon" href="/favicon.ico"><link rel="preload" as="font" crossorigin="anonymous" href="/font/Bender.ttf"><link rel="preload" as="font" crossorigin="anonymous" href="/font/BenderLight.ttf"><link rel="preload" as="font" crossorigin="anonymous" href="/font/JetBrainsMono-Regular.woff2"><link rel="stylesheet" href="/css/arknights.css"><style>@font-face {
  font-family: Bender;
  src: local('Bender'), url("/font/Bender.ttf"), url("/font/Bender.otf");
}
@font-face {
  font-family: BenderLight;
  src: local('BenderLight'), url("/font/BenderLight.ttf");
}
@font-face {
  font-family: 'JetBrains Mono';
  src: local('JetBrains Mono'), url('/font/JetBrainsMono-Regular.woff2') format('woff2');
}
</style><script>var config = {"root":"/","search":{"preload":false,"activeHolder":"Enter here","blurHolder":"Search","noResult":"Data \"$0\" not found"},"code":{"codeInfo":"$0 - $1 lines","copy":"copy"}}</script><link type="text/css" rel="stylesheet" href="/lib/encrypt/hbe.style.css"><script src="//unpkg.com/mermaid@10.5.0/dist/mermaid.min.js"></script><link type="text/css" rel="stylesheet" href="//unpkg.com/lightgallery@2.7.1/css/lightgallery.css"><link type="text/css" rel="stylesheet" href="//unpkg.com/lightgallery@2.7.1/css/lg-zoom.css"><link type="text/css" rel="stylesheet" href="//unpkg.com/lightgallery@2.7.1/css/lg-thumbnail.css"><link type="text/css" rel="stylesheet" href="/lib/fontawesome/css/all.min.css"><script>if (window.localStorage.getItem('theme-mode') === 'light')
 document.documentElement.setAttribute('theme-mode', 'light')
if (window.localStorage.getItem('theme-mode') === 'dark')
 document.documentElement.setAttribute('theme-mode', 'dark')</script><style>@font-face {
 font-family: BenderLight;
 src: local('Bender'), url("/font/BenderLight.woff2") format('woff2');
}
@font-face {
 font-family: 'JetBrains Mono';
 src: local('JetBrains Mono'), url('/font/JetBrainsMono-Regular.woff2') format('woff2');
}</style><style>:root {
 --dark-background: url('https://ak.hypergryph.com/assets/index/images/ak/pc/bk.jpg');
 --light-background: url('/img/bk.jpg');
 --theme-encrypt-confirm: 'confirm'
}</style><script defer src="/js/arknights.js"></script><script defer src="/js/search.js"></script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script defer type="module">import mermaid from '//unpkg.com/mermaid@10.5.0/dist/mermaid.esm.mjs';
window.mermaid = mermaid;
code.paintMermaid();
</script><script async src="//unpkg.com/lightgallery@2.7.1/lightgallery.min.js"></script><script async src="//unpkg.com/lightgallery@2.7.1/plugins/zoom/lg-zoom.min.js"></script><script async src="//unpkg.com/lightgallery@2.7.1/plugins/thumbnail/lg-thumbnail.min.js"></script><script async src="/lib/encrypt/hbe.js"></script><script async src="/js/pjax.js"></script><script class="pjax-js">reset= () => {document.querySelector('.lg-container')?.remove()
lightGallery(document.getElementById('post-bg'), {
  plugins: [lgZoom,lgThumbnail],
  selector: '.item-img'})}</script><script>window.addEventListener("load",() => {pjax = new Pjax({
 cacheBust: false,
 selectors: ['title','article','#aside-block','.pjax-js','data-pjax','.busuanzi'],
 switches: {'article': Pjax.switches.sideBySide},
 switchesOptions: {
   'article': {
     classNames: {
       remove: "pjax-out",
       add: "pjax-in"
     }
   }
 }
});
document.addEventListener("pjax:complete", reset);document.addEventListener('pjax:success', _ => bszCaller.fetch(
 "//busuanzi.ibruce.info/busuanzi?jsonpCallback=BusuanziCallback", a => {
  bszTag.texts(a),
  bszTag.shows()
}));reset()})</script><script class="pjax-js">reset= () => {document.querySelector('.lg-container')?.remove()
lightGallery(document.getElementById('post-bg'), {
  plugins: [lgZoom,lgThumbnail],
  selector: '.item-img'})}</script><script>window.addEventListener("load",() => {pjax = new Pjax({
 cacheBust: false,
 selectors: ['title','article','#aside-block','.pjax-js'],
 switches: {'article': Pjax.switches.sideBySide},
 switchesOptions: {
   'article': {
     classNames: {
       remove: "pjax-out",
       add: "pjax-in"
     }
   }
 }
});
document.addEventListener("pjax:complete", reset);reset()})</script><meta name="generator" content="Hexo 7.3.0"></head><body><div class="loading" style="opacity: 0;"><div class="loadingBar left"></div><div class="loadingBar right"></div></div><main><header class="closed"><div class="navBtn"><i class="navBtnIcon"><span class="navBtnIconBar"></span><span class="navBtnIconBar"></span><span class="navBtnIconBar"></span></i></div><nav><div class="navItem" id="search-header"><span class="navItemTitle"><input autocomplete="off" autocorrect="off" autocapitalize="none" placeholder="Search" spellcheck="false" maxlength="50" type="text" id="search-input"></span></div><div class="navItem" id="search-holder"></div><div class="search-popup" tabindex="0"><div id="search-result"></div></div><ol class="navContent"><li class="navItem"><a class="navBlock" href="/"><span class="navItemTitle">Home</span></a></li><li class="navItem" matchdata="categories,tags"><a class="navBlock" href="/archives/"><span class="navItemTitle">Archives</span></a></li></ol></nav></header><article><div id="post-bg"><div id="post-title"><h1>MySQL学习代码</h1></div><hr><div id="post-content"><h1>MySQL学习代码</h1>
<h2 id="SQL"><a href="#SQL" class="headerlink" title="SQL"></a>SQL</h2>
<blockquote>
<p>全称 Structured Query Language, 结构化查询语言。操作关系型数据库的编程语言，定义了一套操作关系型数据库统一标准。</p>
</blockquote>
<h3 id="SQL通用语法"><a href="#SQL通用语法" class="headerlink" title="SQL通用语法"></a>SQL通用语法</h3>
<blockquote>
<p>在学习具体的SQL语句之前，先来了解一下SQL语言的同于语法。</p>
<ol>
<li>SQL语句可以单行或多行书写,以分号结尾。</li>
<li>SQL语句可以使用空格/缩进来增强语句的可读性。</li>
<li>MySQL数据库的SQL语句不区分大小写，关键字建议使用大写。</li>
<li>注释:<br>
单行注释:-- 注释内容 或 # 注释内容<br>
多行注释:/** 注释内容*  */</li>
</ol>
</blockquote>
<h3 id="SQL分类"><a href="#SQL分类" class="headerlink" title="SQL分类"></a>SQL分类</h3>
<p>SQL 语句，根据其功能，主要分为四类:DDL、DML、DQL、DCL 。</p>
<table>
<thead>
<tr>
<th style="text-align:center">分类</th>
<th style="text-align:center">全称</th>
<th style="text-align:center">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">DDL</td>
<td style="text-align:center">Data Definition Language</td>
<td style="text-align:center">数据定义语言，用来定义数据库对象（数据库，表，字段)</td>
</tr>
<tr>
<td style="text-align:center">DML</td>
<td style="text-align:center">Data Manipulation Language</td>
<td style="text-align:center">数据操作语言，用来对数据库表中的数据进行增删改</td>
</tr>
<tr>
<td style="text-align:center">DQL</td>
<td style="text-align:center">Data Query Language</td>
<td style="text-align:center">数据查询语言，用来查询数据库中表的记录</td>
</tr>
<tr>
<td style="text-align:center">DCL</td>
<td style="text-align:center">Data Control Language</td>
<td style="text-align:center">数据控制语言，用来创建数据库用户、控制数据库的访问权限</td>
</tr>
</tbody>
</table>
<h2 id="MySQL数据库基本操作—DDL"><a href="#MySQL数据库基本操作—DDL" class="headerlink" title="MySQL数据库基本操作—DDL"></a>MySQL数据库基本操作—DDL</h2>
<blockquote>
<p>DDL：（Data Definition Language）,数据定义语言，该语言部分包括以下内容：</p>
<blockquote>
<ol>
<li>对数据库的常用操作</li>
<li>对表结构的常用操作</li>
<li>修改表结构</li>
</ol>
</blockquote>
</blockquote>
<h3 id="数据库操作"><a href="#数据库操作" class="headerlink" title="数据库操作"></a>数据库操作</h3>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">-- 查看所有的数据库（结尾一定要加英文[;]，表示语句结束）</span><br><span class="line">show databases;</span><br><span class="line">-- 创建数据库（其中 [if not exists] 为可选参数,表示如果不存在再创建，存在不会创建；[charset=utf8] 为编码方式，可选）</span><br><span class="line">create database [if not exists] mydb1 [charset=utf8];</span><br><span class="line">-- 切换（选择要操作的）数据库(mydb1为数据库名)</span><br><span class="line">use mydb1;</span><br><span class="line">-- 删除数据库（[if exists] 表示如果有再删除，可选）</span><br><span class="line">drop database [if exists] mydb1;</span><br><span class="line">-- 修改数据库编码（不常用）</span><br><span class="line">alter database mydb1 character set utf8;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="表创建—格式"><a href="#表创建—格式" class="headerlink" title="表创建—格式"></a>表创建—格式</h3>
<blockquote>
<p>创建表是构建一张空表，指定这个表的名字，这个表有几列，每一列叫什么名字，以及每一列存储的数据类型。</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">-- 创建表格式</span><br><span class="line">create table [if not exists] 表名 (</span><br><span class="line">    字段名1 类型[(宽度)] [约束条件] [comment &#x27;字段说明&#x27;],</span><br><span class="line">    字段名2 类型[(宽度)] [约束条件] [comment &#x27;字段说明&#x27;],</span><br><span class="line">    字段名3 类型[(宽度)] [约束条件] [comment &#x27;字段说明&#x27;]</span><br><span class="line">)[表的一些设置];</span><br><span class="line"></span><br><span class="line">-- 列如：</span><br><span class="line">-- 选择表（数据库）</span><br><span class="line">use mydb1;</span><br><span class="line">-- 创建表</span><br><span class="line">create table if not exists student (</span><br><span class="line">	sid int,</span><br><span class="line">    name varchar(20),</span><br><span class="line">    gender varchar(10),</span><br><span class="line">    age int,</span><br><span class="line">    birth date,</span><br><span class="line">	address varchar(30),		</span><br><span class="line">    score double</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="数据类型—数值类型-数字类型"><a href="#数据类型—数值类型-数字类型" class="headerlink" title="数据类型—数值类型-数字类型"></a>数据类型—数值类型(数字类型)</h3>
<blockquote>
<p>1、数据类型</p>
<blockquote>
<p>数据类型是指在创建表的时候为表中字段指定数据类型，只有数据符合类型要求才能存储起来，使用数据类型的原则是够用就行，尽量使用取值范围小的，而不用大的，这样可以更多的节省存储空间.</p>
</blockquote>
</blockquote>
<ol>
<li>数值类型</li>
</ol>
<p>![](C:\Users\14546\OneDrive\图片\SQL\屏幕截图 2024-07-10 160651.png)</p>
<ul>
<li></li>
</ul>
<h3 id="数据类型—字符串类型"><a href="#数据类型—字符串类型" class="headerlink" title="数据类型—字符串类型"></a>数据类型—字符串类型</h3>
<p>![幕截图 2024-07-10 16570](C:\Users\14546\OneDrive\图片\SQL\屏幕截图 2024-07-10 165708.png)</p>
<h3 id="数据类型—日期和时间类型"><a href="#数据类型—日期和时间类型" class="headerlink" title="数据类型—日期和时间类型"></a>数据类型—日期和时间类型</h3>
<p>![幕截图 2024-07-10 17232](C:\Users\14546\OneDrive\图片\SQL\屏幕截图 2024-07-10 172325.png)</p>
<h4 id="还有-null-类型"><a href="#还有-null-类型" class="headerlink" title="还有-null-类型"></a>还有 null 类型</h4>
<blockquote>
<ul>
<li>没有值，未知</li>
<li>不要使用NULL值进行计算</li>
</ul>
</blockquote>
<h3 id="数据库的字段属性"><a href="#数据库的字段属性" class="headerlink" title="数据库的字段属性"></a>数据库的字段属性</h3>
<blockquote>
<p><strong>UnSigned</strong></p>
<blockquote>
<ul>
<li>没有值，未知</li>
<li>不要使用NULL值进行计算</li>
</ul>
</blockquote>
<p><strong>ZEROFILL</strong></p>
<blockquote>
<ul>
<li>0填充的</li>
<li>不足位数的用0来填充 , 如int(3),5则为005</li>
</ul>
</blockquote>
<p><strong>Auto_InCrement</strong></p>
<blockquote>
<ul>
<li>通常理解为自增，自动在上一条记录的基础上默认+1</li>
<li>通常用来设计唯一的主键，必须是整数类型</li>
<li>可定义起始值和步长
<ul>
<li>
<ul>
<li>当前表设置步长(AUTO_INCREMENT=100) : 只影响当前表</li>
<li>SET @@auto_increment_increment=5 ; 影响所有使用自增的表(全局)</li>
</ul>
</li>
</ul>
</li>
</ul>
</blockquote>
<p><strong>NULL 和 NOT NULL</strong></p>
<blockquote>
<ul>
<li>默认为NULL , 即没有插入该列的数值</li>
<li>如果设置为NOT NULL , 则该列必须有值</li>
</ul>
</blockquote>
<p><strong>DEFAULT</strong></p>
<blockquote>
<ul>
<li>默认的</li>
<li>用于设置默认值</li>
<li>例如,性别字段,默认为&quot;男&quot; , 否则为 “女” ; 若无指定该列的值 , 则默认值为&quot;男&quot;的值</li>
</ul>
</blockquote>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">-- 例子：执行 desc 表名; 后会出现以下结果</span><br><span class="line">CREATE TABLE IF NOT EXISTS `student`(</span><br><span class="line">	`id` INT(4)	NOT NULL AUTO_INCREMENT COMMENT &#x27;学号&#x27;,</span><br><span class="line">	`name` VARCHAR(30) NOT NULL DEFAULT &#x27;匿名&#x27; COMMENT &#x27;姓名&#x27;,</span><br><span class="line">	`pwd` VARCHAR(20) NOT NULL DEFAULT &#x27;123456&#x27; COMMENT &#x27;密码&#x27;,</span><br><span class="line">	`sex` VARCHAR(2) NOT NULL DEFAULT &#x27;女&#x27; COMMENT &#x27;性别&#x27;,</span><br><span class="line">	`birthday` DATETIME DEFAULT NULL COMMENT &#x27;出生日期&#x27;,</span><br><span class="line">	`address` VARCHAR(100) DEFAULT NULL COMMENT &#x27;家庭住址&#x27;,</span><br><span class="line">	`email` VARCHAR(50) DEFAULT NULL COMMENT &#x27;邮箱&#x27;,</span><br><span class="line">	PRIMARY KEY (`id`)</span><br><span class="line">)ENGINE=INNODB DEFAULT CHARSET=utf8</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="表的其他操作"><a href="#表的其他操作" class="headerlink" title="表的其他操作"></a>表的其他操作</h3>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">-- 查看当前数据库的所有表名称</span><br><span class="line">show tables;</span><br><span class="line">-- 查看指定某个表的创建语句</span><br><span class="line">show create table 表名;</span><br><span class="line">-- 查看表结构</span><br><span class="line">desc 表名;</span><br><span class="line">-- 删除表</span><br><span class="line">drop table 表名;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="修改表结构"><a href="#修改表结构" class="headerlink" title="修改表结构"></a>修改表结构</h3>
<h4 id="修改表添加列（字段）"><a href="#修改表添加列（字段）" class="headerlink" title="修改表添加列（字段）"></a>修改表添加列（字段）</h4>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">-- 为表添加新列（字段）</span><br><span class="line">alter table 表名 add 列名 类型(长度) [约束];</span><br><span class="line">-- 例子：为student表添加一个新的字段为：系别 dept 类型为 varchar(20)</span><br><span class="line">alter table student add dept varchar(20);</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h4 id="修改列名和类型"><a href="#修改列名和类型" class="headerlink" title="修改列名和类型"></a>修改列名和类型</h4>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">-- 语法格式</span><br><span class="line">alter table 表名 change 旧列名 新列名 类型(长度) [约束];</span><br><span class="line">-- 例子：为student表的 dept 字段更换为 department varchar(30)</span><br><span class="line">alter table student change dept department varchar(30);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h4 id="修改表删除列"><a href="#修改表删除列" class="headerlink" title="修改表删除列"></a>修改表删除列</h4>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">-- 语法格式</span><br><span class="line">alter table 表名 drop 列名;</span><br><span class="line">-- 例如：删除student表中department这列</span><br><span class="line">alter table student drop department;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h4 id="修改表名"><a href="#修改表名" class="headerlink" title="修改表名"></a>修改表名</h4>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">-- 语法格式</span><br><span class="line">rename table 表名 to 新表名;</span><br><span class="line">-- 例子：将表student改名成stu</span><br><span class="line">rename table student to stu;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h2 id="MySQL数据库基本操作—DML"><a href="#MySQL数据库基本操作—DML" class="headerlink" title="MySQL数据库基本操作—DML"></a>MySQL数据库基本操作—DML</h2>
<h3 id="DML基本介绍"><a href="#DML基本介绍" class="headerlink" title="DML基本介绍"></a>DML基本介绍</h3>
<blockquote>
<p>DML是指数据操作语言，英文全称是Data Manipulation Language，用来对数据库中表的数据记录进行更新（增删改）。</p>
<p><strong>关键字：</strong></p>
<blockquote>
<ul>
<li>插入insert</li>
<li>删除delete</li>
<li>更新update</li>
</ul>
</blockquote>
</blockquote>
<h3 id="数据插入"><a href="#数据插入" class="headerlink" title="数据插入"></a>数据插入</h3>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">-- 语法格式</span><br><span class="line">-- 向表中插入某些（列和值要相互对应）</span><br><span class="line">insert into 表(列名1，列名2，列名3...) values(值1，值2，值3...)；</span><br><span class="line">-- 向表中插入所有列</span><br><span class="line">insert into 表 values(值1，值2，值3...);</span><br><span class="line"></span><br><span class="line">-- 例子：</span><br><span class="line">insert into student(sid,name,gender,age,birth,address,score) values(1001,&#x27;张三&#x27;,&#x27;男&#x27;,18,&#x27;1996-12-23&#x27;,&#x27;北京&#x27;,83.5);</span><br><span class="line">insert into student values(1001,&#x27;张三&#x27;,&#x27;男&#x27;,18,&#x27;1996-12-23&#x27;,&#x27;北京&#x27;,83.5);</span><br><span class="line">-- 一次添加多行数据</span><br><span class="line">insert into student values(1001,&#x27;张三&#x27;,&#x27;男&#x27;,18,&#x27;1996-12-23&#x27;,&#x27;北京&#x27;,83.5),</span><br><span class="line">						(1002,&#x27;李四&#x27;,&#x27;男&#x27;,19,&#x27;1997-12-23&#x27;,&#x27;北京&#x27;,85.5);</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="数据修改"><a href="#数据修改" class="headerlink" title="数据修改"></a>数据修改</h3>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">-- 语法格式</span><br><span class="line">update 表名 set 字段名 = 值,字段名 = 值...;</span><br><span class="line">update 表名 set 字段名 = 值,字段名 = 值... where 条件;</span><br><span class="line"></span><br><span class="line">-- 例子：</span><br><span class="line">-- 将所有学生的地址修改为重庆</span><br><span class="line">update student set address = &#x27;重庆&#x27;;</span><br><span class="line">-- 将sid为1004的学生的地址修改为北京</span><br><span class="line">update student set address = &#x27;北京&#x27; where sid = 1004;</span><br><span class="line">-- 将sid大于1004的学生的地址修改为上海</span><br><span class="line">update student set address = &#x27;北京&#x27; where sid &gt; 1004;</span><br><span class="line">-- 将sid为1005的学生的地址修改为北京，成绩修改为100</span><br><span class="line">update student set address = &#x27;北京&#x27;,score = 100 where sid = 1005;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="数据删除"><a href="#数据删除" class="headerlink" title="数据删除"></a>数据删除</h3>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">-- 语法格式（delete 不加条件会清空该表所有数据）</span><br><span class="line">delete from 表名 [where 条件];</span><br><span class="line">truncate table 表名 或者 truncate 表名;</span><br><span class="line"></span><br><span class="line">-- 例子</span><br><span class="line">-- 1.删除sid为1004的学生数据</span><br><span class="line">delete from student where sid = 1004;</span><br><span class="line">-- 2.删除表所有数据</span><br><span class="line">delete from student;</span><br><span class="line">-- 3.清空表数据</span><br><span class="line">-- 方式一</span><br><span class="line">truncate table student;</span><br><span class="line">-- 方式二</span><br><span class="line">truncate student;</span><br><span class="line"></span><br><span class="line">-- 注意：delete 和 truncate 原理不同，delete 只删除内容，而 truncate 类似于 drop table，可以理解为是将整个表删除，然后再创建该表；</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h2 id="MySQL约束"><a href="#MySQL约束" class="headerlink" title="MySQL约束"></a>MySQL约束</h2>
<h3 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h3>
<h4 id="概念："><a href="#概念：" class="headerlink" title="概念："></a>概念：</h4>
<blockquote>
<p>约束英文：constraint</p>
<p>约束实际上就是表中数据的限制条件。</p>
</blockquote>
<h4 id="作用"><a href="#作用" class="headerlink" title="作用"></a>作用</h4>
<blockquote>
<p>表在设计的时候加入约束的目的就是为了保证表中的记录完整性和有效性，比如用户表有些列的值(手机号）不能为空，有些列的值（身份证号)不能重复。</p>
</blockquote>
<h4 id="分类"><a href="#分类" class="headerlink" title="分类"></a>分类</h4>
<blockquote>
<ul>
<li>主键约束(primary key) PK</li>
<li>自增长约束(auto_increment)</li>
<li>非空约束(not null)</li>
<li>唯一性约束(unique)</li>
<li>默认约束(default)</li>
<li>零填充约束(zerofill)</li>
<li>外键约束(foreign key) FK</li>
<li>检查约束(8.0.16版本之后) (check)</li>
</ul>
</blockquote>
<h3 id="主键约束"><a href="#主键约束" class="headerlink" title="主键约束"></a>主键约束*</h3>
<h4 id="概念：-2"><a href="#概念：-2" class="headerlink" title="概念：-2"></a>概念：</h4>
<blockquote>
<ul>
<li>MySQL主键约束是一个列或者多个列的组合，<strong>其值能唯一地标识表中的每一行,方便在RDBMS中尽快的找到某一行。</strong></li>
<li>主键约束相当于唯一约束+非空约束的组合，主键约束列不允许重复，也不允许出现空值。</li>
<li>每个表最多只允许一个主键。</li>
<li>主键约束的关键字是：<strong>primary key</strong></li>
<li>当创建主键的约束时，系统默认会在所在的列和列组合上建立对应的唯一索引。</li>
</ul>
</blockquote>
<h4 id="操作"><a href="#操作" class="headerlink" title="操作"></a>操作</h4>
<blockquote>
<ul>
<li>添加单列主键</li>
</ul>
<p>创建单列主键有两种方式，一种是在定义字段的同时指定主键，一种是定义完字段之后指定主键。</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">-- 方式1——语法：</span><br><span class="line">	-- 在 create table 语句中，通过 primary key 关键字来指定主键。</span><br><span class="line">	-- 在定义字段的同时指定主键，语法格式如下：</span><br><span class="line">create table 表名 (</span><br><span class="line">	...</span><br><span class="line">    &lt;字段名&gt; &lt;数据类型&gt; primary key,</span><br><span class="line">    ...</span><br><span class="line">);</span><br><span class="line">-- 方式1——实现：</span><br><span class="line">create table emp1 (</span><br><span class="line">	eid int primay key,</span><br><span class="line">    name varchar(20),</span><br><span class="line">    deptId int,</span><br><span class="line">    salary double</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">-- 方式2——语法：</span><br><span class="line">	-- 在定义字段的同时指定主键，语法格式如下：</span><br><span class="line">create table 表名 (</span><br><span class="line">	...</span><br><span class="line">    [constraint &lt;约束名&gt;] primary key [字段名]</span><br><span class="line">);</span><br><span class="line">-- 方式2——实现：</span><br><span class="line">create table emp2 (</span><br><span class="line">	eid int,</span><br><span class="line">    name varchar(20),</span><br><span class="line">    deptId int,</span><br><span class="line">    salary double,</span><br><span class="line">    constraint pk1 primary key(eid)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<blockquote>
<ul>
<li>添加多列联合主键</li>
</ul>
<p>所谓的联合主键，就是这个主键是由一张表中多个字段组成的。</p>
<p>注意：</p>
<pre><code>	1. 当主键是由多个字段组成时，不能直接在字段名后面声明主键约束。
	2. 一张表只能有一个主键，联合主键也是一个主键。
	3. 联合主键各列不能为空。
</code></pre>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">-- 语法：</span><br><span class="line">create table 表名 (</span><br><span class="line">	...</span><br><span class="line">    primary key(字段1，字段2，...，字段n)</span><br><span class="line">);</span><br><span class="line">-- 实现：</span><br><span class="line">create table emp3 (</span><br><span class="line">	name varchar(20),</span><br><span class="line">    deptId int,</span><br><span class="line">    salary double,</span><br><span class="line">    primary key(name, deptId)</span><br><span class="line">);</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<blockquote>
<ul>
<li>
<p>通过修改表结构添加主键</p>
<p>主键约束不仅可以在创建表的同时创建，也可以在修改表时添加。</p>
</li>
</ul>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">-- 语法：</span><br><span class="line">create table 表名 (</span><br><span class="line">	...</span><br><span class="line">);</span><br><span class="line">alter table &lt;表名&gt; add primary key (字段列表)；</span><br><span class="line"></span><br><span class="line">-- 实现：</span><br><span class="line">-- 添加单列主键</span><br><span class="line">create table emp4 (</span><br><span class="line">	eid int,</span><br><span class="line">    name varchar(20),</span><br><span class="line">    deptId int,</span><br><span class="line">    salary double</span><br><span class="line">);</span><br><span class="line">alter table emp4 add primary key (eid);</span><br><span class="line"></span><br><span class="line">-- 添加多列主键(联合)</span><br><span class="line">create table emp5 (</span><br><span class="line">	eid int,</span><br><span class="line">    name varchar(20),</span><br><span class="line">    deptId int,</span><br><span class="line">    salary double</span><br><span class="line">);</span><br><span class="line">alter table emp5 add primary key (eid, deptId);</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<blockquote>
<ul>
<li>删除主键约束</li>
</ul>
<p>一个表中不需要主键约束时，就需要从表中将其删除。删除主键约束的方法要比创建主键约束容易的多。</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">-- 格式</span><br><span class="line">alter table &lt;数据库名&gt; drop primary key;</span><br><span class="line"></span><br><span class="line">-- 实现</span><br><span class="line">-- 删除单列主键</span><br><span class="line">alter table emp1 drop primary key;</span><br><span class="line"></span><br><span class="line">-- 删除联合主键</span><br><span class="line">alter table emp5 drop primary key;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="自增长约束-auto-increment"><a href="#自增长约束-auto-increment" class="headerlink" title="自增长约束-auto-increment"></a>自增长约束(auto_increment)</h3>
<h4 id="概念：-3"><a href="#概念：-3" class="headerlink" title="概念：-3"></a>概念：</h4>
<blockquote>
<p>在MySQL中，当主键定义为自增长后，这个主键的值就不再需要用户输入数据了，而由数据库系统根据定义自动赋值。每增加一条记录，主键会自动以相同的步长进行增长。</p>
<p>通过给字段添加 <strong>auto_increment</strong> 属性来实现主键自增长。</p>
<p>一般搭配主键使用，提高健壮性。</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">-- 语法</span><br><span class="line">字段名 数据类型 auto_increment;</span><br><span class="line"></span><br><span class="line">-- 操作</span><br><span class="line">create table t_user1 (</span><br><span class="line">	id int primary key auto_increment，</span><br><span class="line">    name varchar(20)</span><br><span class="line">);</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<blockquote>
<ul>
<li>
<p>特点：</p>
<ol>
<li>
<p>默认情况下，auto_increment的初始值是 1，每新增一条记录，字段值自动加 1。</p>
</li>
<li>
<p>一个表中只能有一个字段使用 auto_increment约束，且该字段必须有唯一索引，以避免序号重复(即为主键或主键的一部分)。</p>
</li>
<li>
<p>auto_increment约束的字段必须具备 NOT NULL 属性。</p>
</li>
<li>
<p>auto_increment约束的字段只能是整数类型(TINYINT、SMALLINT、INT、BIGINT )等。</p>
</li>
<li>
<p>auto_increment约束字段的最大值受该字段的数据类型约束，如果达到上限，auto_increment就会失效。</p>
</li>
</ol>
</li>
</ul>
</blockquote>
<h4 id="指定自增字段初始值"><a href="#指定自增字段初始值" class="headerlink" title="指定自增字段初始值"></a>指定自增字段初始值</h4>
<blockquote>
<ol>
<li>如果第一条记录设置了该字段的初始值，那么新增加的记录就从这个初始值开始自增。例如，如果表中插入的第一条记录的id值设置为5，那么再插入记录时，id值就会从5开始往上增加。</li>
</ol>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">-- 方式1，创建表时指定</span><br><span class="line">create table t_user2 (</span><br><span class="line">	id int primary key auto_increment,</span><br><span class="line">    name varchar(20)</span><br><span class="line">)auto_increment = 100;</span><br><span class="line"></span><br><span class="line">-- 方式2，创建表之后指定</span><br><span class="line">create table t_user2 (</span><br><span class="line">	id int primary key auto_increment,</span><br><span class="line">    name varchar(20)</span><br><span class="line">);</span><br><span class="line">alter table t_user2 auto_increment = 200;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<blockquote>
<p>注意：delete 和 truncate 在删除后自增列的变化：</p>
<ul>
<li>delete数据之后自动增长从断点开始</li>
<li>truncate数据之后自动增长从默认起始值开始</li>
</ul>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">-- 格式</span><br><span class="line">delete from &lt;表名&gt;;</span><br><span class="line">truncate &lt;表名&gt;;</span><br><span class="line"></span><br><span class="line">-- 实现</span><br><span class="line">delete from t_user1;</span><br><span class="line">truncate t_user2;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="非空约束-not-null"><a href="#非空约束-not-null" class="headerlink" title="非空约束-not-null"></a>非空约束(not null)</h3>
<h4 id="概念"><a href="#概念" class="headerlink" title="概念"></a>概念</h4>
<blockquote>
<p>MySQL非空约束（not null）指字段的值不能为空。对于使用了非空约束的字段，如果用户在添加数据时没有指定值，数据库系统就会报错。</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">-- 语法：</span><br><span class="line">-- 方式1：</span><br><span class="line">&lt;字段名&gt; &lt;数据类型&gt; not null;</span><br><span class="line">-- 方式2：</span><br><span class="line">alter table 表名 modify 字段 类型 not null;</span><br><span class="line"></span><br><span class="line">-- 添加非空约束——方式1</span><br><span class="line">-- 方式1，创建表时指定</span><br><span class="line">create table t_user6 (</span><br><span class="line">	id int,</span><br><span class="line">    name varchar(20) not null,</span><br><span class="line">    address varchar(20) not null</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">-- 添加非空约束——方式2</span><br><span class="line">-- 方式2，创建表之后指定</span><br><span class="line">create table t_user7 (</span><br><span class="line">	id int,</span><br><span class="line">    name varchar(20),</span><br><span class="line">    address varchar(20)</span><br><span class="line">);</span><br><span class="line">alter table t_user7 modify name varchar(20) not null;</span><br><span class="line">alter table t_user7 modify address varchar(20) not null;</span><br><span class="line">-- 实例（插入数据）：</span><br><span class="line">insert into t_user6(id) values(1001);  -- 不可以（name，address不能为空）</span><br><span class="line">insert into t_user6(id,name,address) values(1001,NULL,NULL);  -- 不可以（同上）</span><br><span class="line">insert into t_user6(id,name,address) values(1001,&#x27;NULL&#x27;,&#x27;NULL&#x27;); -- 可以（字符串NULL）</span><br><span class="line">insert into t_user6(id,name,address) values(1001,&#x27;&#x27;,&#x27;&#x27;); -- 可以（空串）</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">-- 删除非空约束(可以叫修改)</span><br><span class="line">-- alter table 表名 modify 字段 类型;</span><br><span class="line">alter table t_user7 modify name varchar(20);</span><br><span class="line">alter table t_user7 modify address varchar(20);</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="唯一约束-unique"><a href="#唯一约束-unique" class="headerlink" title="唯一约束-unique"></a>唯一约束(unique)</h3>
<h4 id="概念-2"><a href="#概念-2" class="headerlink" title="概念-2"></a>概念</h4>
<blockquote>
<p>唯一约束(Unique)， 是指所有记录中字段的值不能重复出现。例如，为 id 字段加上唯一性约束后，每条记录的 id 值都是唯一的，不能出现重复的情况，但可以为NULL，并且可以有多个NULL。</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">-- 语法：</span><br><span class="line">-- 方式1：</span><br><span class="line">&lt;字段名&gt; &lt;数据类型&gt; unique;</span><br><span class="line">-- 方式2：</span><br><span class="line">alter table 表名 add constraint 约束名 unique(列);</span><br><span class="line"></span><br><span class="line">-- 添加唯一约束——方式1：</span><br><span class="line">-- 创建表时指定</span><br><span class="line">create table t_user8 (</span><br><span class="line">	id int,</span><br><span class="line">    name varchar(20),</span><br><span class="line">    phone_number varchar(20) unique  -- 指定唯一约束</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">-- 添加唯一约束——方式2：</span><br><span class="line">-- 方式2，创建表之后指定</span><br><span class="line">create table t_user9 (</span><br><span class="line">	id int,</span><br><span class="line">    name varchar(20),</span><br><span class="line">    phone_number varchar(20)  -- 指定唯一约束</span><br><span class="line">);</span><br><span class="line">alter table t_user9 add constraint unique_pn unique(phone_number);</span><br><span class="line"></span><br><span class="line">-- 删除唯一约束</span><br><span class="line">alter table &lt;表名&gt; drop index &lt;唯一约束名&gt;;</span><br><span class="line">-- 实例：（如果通过方式1添加的唯一约束，则index后面加上所在列名就行）</span><br><span class="line">alter table t_user9 drop index unique_pn;</span><br></pre></td></tr></table></figure>
<h3 id="默认约束-default"><a href="#默认约束-default" class="headerlink" title="默认约束-default"></a>默认约束(default)</h3>
<h4 id="概念-3"><a href="#概念-3" class="headerlink" title="概念-3"></a>概念</h4>
<blockquote>
<p>MySQL默认值约束用来指定某列的默认值。</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">-- 语法：</span><br><span class="line">-- 方式1：</span><br><span class="line">&lt;字段名&gt; &lt;数据类型&gt; default &lt;默认值&gt;;</span><br><span class="line">-- 方式2：</span><br><span class="line">alter table 表名 modify 列名 类型 default 默认值;</span><br><span class="line"></span><br><span class="line">-- 添加默认约束——方式1：</span><br><span class="line">-- 创建表时指定</span><br><span class="line">create table t_user10 (</span><br><span class="line">	id int,</span><br><span class="line">    name varchar(20),</span><br><span class="line">    address varchar(20) default &#x27;北京&#x27;  -- 指定默认约束</span><br><span class="line">);</span><br><span class="line">-- 插入数据（未给定地址时，它会默认是北京）</span><br><span class="line">insert into t_user10(id,name) values(1001,&#x27;张三&#x27;);</span><br><span class="line">insert into t_user10(id,name) values(1002,&#x27;李四&#x27;,&#x27;上海&#x27;);  -- 地址会成为上海</span><br><span class="line">insert into t_user10 values(1003,&#x27;王五&#x27;,NULL);   -- 地址会为 NULL</span><br><span class="line"></span><br><span class="line">-- 添加默认约束——方式2：</span><br><span class="line">-- 创建表之后指定</span><br><span class="line">create table t_user11 (</span><br><span class="line">	id int,</span><br><span class="line">    name varchar(20),</span><br><span class="line">    address varchar(20)</span><br><span class="line">);</span><br><span class="line">-- 格式：alter table 表名 modify 列名 类型 default 默认值;</span><br><span class="line">alter table t_user11 modify address varchar(20) default &#x27;北京&#x27;;</span><br><span class="line"></span><br><span class="line">-- 删除默认约束(删除默认约束就是把设置的默认值设置为null)</span><br><span class="line">-- alter table &lt;表名&gt; change column &lt;字段名&gt; &lt;类型&gt; default NULL;</span><br><span class="line">alter table t_user11 modify address varchar(20) default NULL;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="零填充约束-zerofill"><a href="#零填充约束-zerofill" class="headerlink" title="零填充约束-zerofill"></a>零填充约束(zerofill)</h3>
<h4 id="概念-4"><a href="#概念-4" class="headerlink" title="概念-4"></a>概念</h4>
<ol>
<li>插入数据时，当该字段的值的长度小于定义的长度时，会在该值的前面补上相应的0；</li>
<li>zerofill 默认为 int(10)；</li>
<li>当使用 zerofill 时，默认会自动加 unsigned（无符号）属性，使用 unsigned 属性后，数值范围时原值的2倍，例如，有符号为 -128~+127，无符号为 0~256.</li>
</ol>
<h4 id="操作-2"><a href="#操作-2" class="headerlink" title="操作-2"></a>操作</h4>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">-- 语法</span><br><span class="line">&lt;字段名&gt; &lt;数据类型&gt; zerofill;</span><br><span class="line"></span><br><span class="line">create table t_user12 (</span><br><span class="line">	id int zerofill,  -- 零填充约束</span><br><span class="line">    name varchar(20)</span><br><span class="line">);</span><br><span class="line">insert into t_user12 values(123,&#x27;张三&#x27;); -- 固定10位，会在前面加7个0</span><br><span class="line">insert into t_user12 values(1,&#x27;李四&#x27;);  -- 固定10位，会在前面加9个0</span><br><span class="line"></span><br><span class="line">-- 删除</span><br><span class="line">-- 格式：alter table &lt;表名&gt; modify &lt;字段名&gt; &lt;数据类型&gt;;</span><br><span class="line">alter table t_user12 modify id int;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h2 id="MySQL数据库基本操作—DQL"><a href="#MySQL数据库基本操作—DQL" class="headerlink" title="MySQL数据库基本操作—DQL"></a>MySQL数据库基本操作—DQL</h2>
<h3 id="基本介绍"><a href="#基本介绍" class="headerlink" title="基本介绍"></a>基本介绍</h3>
<h4 id="概念-5"><a href="#概念-5" class="headerlink" title="概念-5"></a>概念</h4>
<blockquote>
<ul>
<li>数据库管理系统一个重要功能就是数据查询，数据查询不应只是简单返回数据库中存储的数据，还应该根据需要对数据进行筛选以及确定数据以什么样的格式显示。</li>
<li>MySQL提供了功能强大、灵活的语句来实现这些操作。</li>
<li>MySQL数据库使用select语句来查询数据。</li>
</ul>
</blockquote>
<h4 id="语法"><a href="#语法" class="headerlink" title="语法"></a>语法</h4>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">-- 格式</span><br><span class="line">select</span><br><span class="line">  [all|distinct]</span><br><span class="line">  &lt;目标列的表达式1&gt; [别名],</span><br><span class="line">  &lt;目标列的表达式2&gt; [别名]...</span><br><span class="line">from &lt;表名或视图名&gt; [别名], &lt;表名或视图名&gt; [别名]...</span><br><span class="line">[where&lt;条件表达式&gt;]</span><br><span class="line">[group by &lt;列名&gt;</span><br><span class="line">[having &lt;条件表达式&gt;]]</span><br><span class="line">[order by &lt;列名&gt; [asc|desc]]</span><br><span class="line">[limit &lt;数字或者列表&gt;];</span><br><span class="line"></span><br><span class="line">-- 解释以上</span><br><span class="line">SELECT</span><br><span class="line">	字段列表</span><br><span class="line">FROM</span><br><span class="line">	表名列表</span><br><span class="line">WHERE</span><br><span class="line">	条件列表</span><br><span class="line">GROUP BY</span><br><span class="line">	分组字段列表</span><br><span class="line">HAVING</span><br><span class="line">	分组后条件列表</span><br><span class="line">ORDER BY</span><br><span class="line">	排序字段列表</span><br><span class="line">LIMIT</span><br><span class="line">	分页参数</span><br><span class="line"></span><br><span class="line">-- 简化版语法</span><br><span class="line">select *| 列名 from 表 where 条件;</span><br><span class="line">	</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>我们在讲解这部分内容的时候，会将上面的完整语法进行拆分，分为以下几个部分：</p>
<ul>
<li>基本查询（不带任何条件）</li>
<li>条件查询（WHERE）</li>
<li>聚合函数（count、max、min、avg、sum）</li>
<li>分组查询（group by）</li>
<li>排序查询（order by）</li>
<li>分页查询（limit）</li>
</ul>
<h3 id="基本查询—数据准备"><a href="#基本查询—数据准备" class="headerlink" title="基本查询—数据准备"></a>基本查询—数据准备</h3>
<p>以下是一个基础例子：</p>
<ul>
<li>
<p>创建数据库和表（商品表）：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">-- 创建数据库</span><br><span class="line">create database if not exists mydb2;</span><br><span class="line">use mydb2;</span><br><span class="line"></span><br><span class="line">-- 创建商品表：</span><br><span class="line">create table product (</span><br><span class="line">	pid int primary key auto_increment,  -- 商品编号</span><br><span class="line">    pname varchar(20) not null,  -- 商品名称</span><br><span class="line">    price double,  -- 商品价格</span><br><span class="line">    category_id varchar(20)  -- 商品所属分类</span><br><span class="line">);</span><br><span class="line"></span><br></pre></td></tr></table></figure>
</li>
<li>
<p>添加数据：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">-- 电器类（c001）：</span><br><span class="line">insert into product values(null,&#x27;海尔洗衣机&#x27;,5000,&#x27;c001&#x27;);</span><br><span class="line">insert into product values(null,&#x27;美的冰箱&#x27;,3000,&#x27;c001&#x27;);</span><br><span class="line">insert into product values(null,&#x27;格力空调&#x27;,5000,&#x27;c001&#x27;);</span><br><span class="line">insert into product values(null,&#x27;九阳电饭煲&#x27;,5000,&#x27;c001&#x27;);</span><br><span class="line"></span><br><span class="line">-- 服装类（c002）：</span><br><span class="line">insert into product values(null,&#x27;啄木鸟衬衣&#x27;,300,&#x27;c002&#x27;);</span><br><span class="line">insert into product values(null,&#x27;恒源祥西裤&#x27;,800,&#x27;c002&#x27;);</span><br><span class="line">insert into product values(null,&#x27;花花公子夹克&#x27;,440,&#x27;c002&#x27;);</span><br><span class="line">insert into product values(null,&#x27;劲霸休闲裤&#x27;,266,&#x27;c002&#x27;);</span><br><span class="line">insert into product values(null,&#x27;海澜之家卫衣&#x27;,180,&#x27;c002&#x27;);</span><br><span class="line">insert into product values(null,&#x27;杰克琼斯运动裤&#x27;,430,&#x27;c002&#x27;);</span><br><span class="line"></span><br><span class="line">-- 护肤品类（c003）：</span><br><span class="line">insert into product values(null,&#x27;兰蔻面霜&#x27;,300,&#x27;c003&#x27;);</span><br><span class="line">insert into product values(null,&#x27;雅诗兰黛精华水&#x27;,200,&#x27;c003&#x27;);</span><br><span class="line">insert into product values(null,&#x27;香奈儿香水&#x27;,350,&#x27;c003&#x27;);</span><br><span class="line">insert into product values(null,&#x27;SK-II神仙水&#x27;,350,&#x27;c003&#x27;);</span><br><span class="line">insert into product values(null,&#x27;资生堂粉底液&#x27;,180,&#x27;c003&#x27;);</span><br><span class="line"></span><br><span class="line">-- 食品类（c004）：</span><br><span class="line">insert into product values(null,&#x27;老北京方便面&#x27;,56,&#x27;c004&#x27;);</span><br><span class="line">insert into product values(null,&#x27;良品铺子海带丝&#x27;,17,&#x27;c004&#x27;);</span><br><span class="line">insert into product values(null,&#x27;三只松鼠坚果&#x27;,88,&#x27;c004&#x27;);</span><br><span class="line"></span><br></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="基本查询—简单查询"><a href="#基本查询—简单查询" class="headerlink" title="基本查询—简单查询"></a>基本查询—简单查询</h3>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">-- 1.查询所有的商品</span><br><span class="line">select * from product;</span><br><span class="line"></span><br><span class="line">-- 2.查询商品名和商品价格</span><br><span class="line">select pname,price from product;</span><br><span class="line"></span><br><span class="line">-- 3.别名查询.使用的关键字是as（as可以省略的）</span><br><span class="line">-- 3.1表别名：</span><br><span class="line">select * from product as p;</span><br><span class="line">-- 别名在多表查询时可以起到简化作用，例如：</span><br><span class="line">select p.id,u.id from product as p, user1 as u;</span><br><span class="line"></span><br><span class="line">-- 3.2列别名（商品名）：</span><br><span class="line">select pname as pn from product;</span><br><span class="line"></span><br><span class="line">-- 4.去掉重复值（商品价格）</span><br><span class="line">select distinct price from product;</span><br><span class="line"></span><br><span class="line">-- 5.查询结果是表达式（运算查询）：将商品名和所有商品的价格+10元进行显示</span><br><span class="line">select pname,price+10 from product;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="基本查询—运算符"><a href="#基本查询—运算符" class="headerlink" title="基本查询—运算符"></a>基本查询—运算符</h3>
<h4 id="简介-2"><a href="#简介-2" class="headerlink" title="简介-2"></a>简介</h4>
<p>数据库中的表结构确立后，表中的数据代表的意义就已经确定。通过MySQL运算符进行运算，就可以获取到表结构以外的另一种数据。</p>
<p>例如，学生表中存在一个birth字段，这个字段表示学生的出 年份。 运 MySQL的算术运算符用当前的年份减学生出生的年份，那么得到的就是这个学生的实际年龄数据。</p>
<blockquote>
<p>MySQL支持4种运算符</p>
<ul>
<li>算术运算符</li>
<li>比较运算符</li>
<li>逻辑运算符</li>
<li>位运算符</li>
</ul>
</blockquote>
<h4 id="算术运算符"><a href="#算术运算符" class="headerlink" title="算术运算符"></a>算术运算符</h4>
<table>
<thead>
<tr>
<th style="text-align:center">算术运算符</th>
<th style="text-align:center">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">+</td>
<td style="text-align:center">加法运算</td>
</tr>
<tr>
<td style="text-align:center">-</td>
<td style="text-align:center">减法运算</td>
</tr>
<tr>
<td style="text-align:center">*</td>
<td style="text-align:center">乘法运算</td>
</tr>
<tr>
<td style="text-align:center">/ 或 DIV</td>
<td style="text-align:center">除法运算，返回商</td>
</tr>
<tr>
<td style="text-align:center">% 或 MOD</td>
<td style="text-align:center">求余运算，返回余数</td>
</tr>
</tbody>
</table>
<h4 id="比较运算符"><a href="#比较运算符" class="headerlink" title="比较运算符"></a>比较运算符</h4>
<table>
<thead>
<tr>
<th style="text-align:center">比较运算符</th>
<th style="text-align:center">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">=</td>
<td style="text-align:center">等于</td>
</tr>
<tr>
<td style="text-align:center">&lt; 和 &lt;=</td>
<td style="text-align:center">小于和小于等于</td>
</tr>
<tr>
<td style="text-align:center">&gt; 和 &gt;=</td>
<td style="text-align:center">大于和大于等于</td>
</tr>
<tr>
<td style="text-align:center">&lt;=&gt;</td>
<td style="text-align:center">完全的等于，两个操作码均为NULL时，其所得值为1；而当一个操作码为NULL时，其所得值为0</td>
</tr>
<tr>
<td style="text-align:center">&lt;&gt; 或 !=</td>
<td style="text-align:center">不等于</td>
</tr>
<tr>
<td style="text-align:center">IS NULL 或 ISNULL</td>
<td style="text-align:center">判断一个值是否为NULL</td>
</tr>
<tr>
<td style="text-align:center">IS NOT NULL</td>
<td style="text-align:center">判断一个值是否不为NULL</td>
</tr>
<tr>
<td style="text-align:center">LEAST</td>
<td style="text-align:center">当有两个或多个参数时，返回最小值</td>
</tr>
<tr>
<td style="text-align:center">GREATEST</td>
<td style="text-align:center">当有两个或多个参数时，返回最大值</td>
</tr>
<tr>
<td style="text-align:center">BETWEEN AND</td>
<td style="text-align:center">判断一个值是否落在两个值之间</td>
</tr>
<tr>
<td style="text-align:center">IN</td>
<td style="text-align:center">判断一个值是IN列表中的任意一个值</td>
</tr>
<tr>
<td style="text-align:center">NOT IN</td>
<td style="text-align:center">判断一个值不是IN列表中的任意一个值</td>
</tr>
<tr>
<td style="text-align:center">LIKE</td>
<td style="text-align:center">通配符匹配(包括 % 和 _ ，%表示多个匹配，_ 表示单个匹配)</td>
</tr>
<tr>
<td style="text-align:center">REGEXP</td>
<td style="text-align:center">正则表达式匹配</td>
</tr>
</tbody>
</table>
<h4 id="逻辑运算符"><a href="#逻辑运算符" class="headerlink" title="逻辑运算符"></a>逻辑运算符</h4>
<table>
<thead>
<tr>
<th style="text-align:center">逻辑运算符</th>
<th style="text-align:center">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">NOT 或者 !</td>
<td style="text-align:center">逻辑非</td>
</tr>
<tr>
<td style="text-align:center">AND 或者 &amp;&amp;</td>
<td style="text-align:center">逻辑与</td>
</tr>
<tr>
<td style="text-align:center">OR 或者 ||</td>
<td style="text-align:center">逻辑或</td>
</tr>
<tr>
<td style="text-align:center">XOR</td>
<td style="text-align:center">逻辑异或</td>
</tr>
</tbody>
</table>
<h4 id="位运算符"><a href="#位运算符" class="headerlink" title="位运算符"></a>位运算符</h4>
<table>
<thead>
<tr>
<th style="text-align:center">位运算符</th>
<th style="text-align:center">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">!</td>
<td style="text-align:center">按位或</td>
</tr>
<tr>
<td style="text-align:center">&amp;</td>
<td style="text-align:center">按位与</td>
</tr>
<tr>
<td style="text-align:center">^</td>
<td style="text-align:center">按位异或</td>
</tr>
<tr>
<td style="text-align:center">&lt;&lt;</td>
<td style="text-align:center">按位左移</td>
</tr>
<tr>
<td style="text-align:center">&gt;&gt;</td>
<td style="text-align:center">按位右移</td>
</tr>
<tr>
<td style="text-align:center">~</td>
<td style="text-align:center">按位取反，反转所有比特</td>
</tr>
</tbody>
</table>
<blockquote>
<p>位运算符是在二进制数上进行计算的运算符。位运算会先将操作数变成二进制数，进行位运算。然后再将计算结果从二进制数变回十进制数。</p>
</blockquote>
<h4 id="运算符操作"><a href="#运算符操作" class="headerlink" title="运算符操作"></a>运算符操作</h4>
<h5 id="算术运算符-2"><a href="#算术运算符-2" class="headerlink" title="算术运算符-2"></a>算术运算符</h5>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">use mydb2;</span><br><span class="line">select 6 + 2;</span><br><span class="line">select 6 - 2;</span><br><span class="line">select 6 * 2;</span><br><span class="line">select 6 / 2;</span><br><span class="line">select 6 % 2;</span><br><span class="line"></span><br><span class="line">-- 将每件商品的价格加10</span><br><span class="line">select name,price + 10 as new_price from product;</span><br><span class="line">-- 将所有商品的价格上调10%</span><br><span class="line">select pname,price * 1.1 as new_price from product;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h5 id="比较运算符-2"><a href="#比较运算符-2" class="headerlink" title="比较运算符-2"></a>比较运算符</h5>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line">-- 更新pid为18的category_id为null</span><br><span class="line">update product set category_id = null where pid = 18;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">-- 比较运算符——条件查询</span><br><span class="line"></span><br><span class="line">-- 查询商品名称为“海尔洗衣机”的商品所有信息：</span><br><span class="line">select * from product where pname = &#x27;海尔洗衣机&#x27;;</span><br><span class="line"></span><br><span class="line">-- 查询价格为800的商品</span><br><span class="line">select * from product where price = 800;</span><br><span class="line"></span><br><span class="line">-- 查询价格不是800的所有商品(三种方法)</span><br><span class="line">select * from product where price != 800;</span><br><span class="line">select * from product where price &lt;&gt; 800;</span><br><span class="line">select * from product where not(price = 800);</span><br><span class="line"></span><br><span class="line">-- 查询商品价格大于60元的所有商品信息</span><br><span class="line">select * from product where price &gt; 60;</span><br><span class="line"></span><br><span class="line">-- 查询商品价格在200到1000之间所有商品(三种方法)</span><br><span class="line">select * from product where price &gt;= 200 and price &lt;= 1000;</span><br><span class="line">select * from product where price &gt;= 200 &amp;&amp; price &lt;= 1000;</span><br><span class="line">select * from product where price between 200 and 1000;</span><br><span class="line"></span><br><span class="line">-- 查询商品价格是200或800的所有商品(三种方法)</span><br><span class="line">select * from product where price = 200 or price = 800;</span><br><span class="line">select * from product where price = 200 || price = 800;</span><br><span class="line">select * from product where price in(200, 800);</span><br><span class="line"></span><br><span class="line">-- 查询含有‘裤&#x27;字的所有商品</span><br><span class="line">select * from product where pname like &#x27;%裤%&#x27;;</span><br><span class="line"></span><br><span class="line">-- 查询以&#x27;海&#x27;开头的所有商品</span><br><span class="line">select * from product where pname like &#x27;海%&#x27;;</span><br><span class="line"></span><br><span class="line">-- 查询第二个字为&#x27;蔻&#x27;的所有商品</span><br><span class="line">select * from product where pname like &#x27;_蔻%&#x27;;</span><br><span class="line"></span><br><span class="line">-- 查询category_id为null的商品</span><br><span class="line">select * from product where category_id is null;</span><br><span class="line"></span><br><span class="line">-- 查询category_id不为null分类的商品</span><br><span class="line">select * from product where category_id is not null;</span><br><span class="line"></span><br><span class="line">-- 使用least求最小值(可以结合表来查询)</span><br><span class="line">select least(10, 20, 30) as small_number; -- 10</span><br><span class="line">select least(10, null , 30); -- null</span><br><span class="line"> </span><br><span class="line">-- 使用greatest求最大值</span><br><span class="line">select greatest(10, 20, 30) as big_number;  -- 30</span><br><span class="line">select greatest(10, null, 30); -- null</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h5 id="位运算符（了解）"><a href="#位运算符（了解）" class="headerlink" title="位运算符（了解）"></a>位运算符（了解）</h5>
<blockquote>
<p>位运算符是在二进制数上进行计算的运算符。位运算会先将操作数变成二进制数，进行位运算。然后再将计算结果从二进制数变回十进制数。</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">select 3 &amp; 5;  -- 位与</span><br><span class="line">select 3 | 5;  -- 位或</span><br><span class="line">select 3 ^ 5;  -- 位异或</span><br><span class="line">select 3 &gt;&gt; 1;  -- 位右移</span><br><span class="line">select 3 &lt;&lt; 1;  -- 位左移</span><br><span class="line">select ~ 3;   -- 位取反</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="基本查询—排序查询"><a href="#基本查询—排序查询" class="headerlink" title="基本查询—排序查询"></a>基本查询—排序查询</h3>
<h4 id="介绍"><a href="#介绍" class="headerlink" title="介绍"></a>介绍</h4>
<blockquote>
<p>如果我们需要对读取的数据进行排序，我们就可以使用MySQL的 order by 子句来设定你想按哪个字段哪种方式来进行排序，再返回搜索结果。</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">-- 语法格式：</span><br><span class="line">select </span><br><span class="line">	字段名1, 字段名2, ……</span><br><span class="line">from 表名</span><br><span class="line">order by 字段名1 [asc|desc], 字段名2[asc|desc] ……;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h4 id="特点"><a href="#特点" class="headerlink" title="特点"></a>特点</h4>
<blockquote>
<ol>
<li>asc代表升序，desc代表降序，如果不写默认升序；</li>
<li>order by用于子句中可以支持单个字段，多个字段，表达式，函数，别名；</li>
<li>order by子句，放在查询语句的最后面。LIMIT子句除外。</li>
</ol>
</blockquote>
<h4 id="操作-3"><a href="#操作-3" class="headerlink" title="操作-3"></a>操作</h4>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">-- 1.使用价格排序（降序）</span><br><span class="line">select * from product order by price desc;</span><br><span class="line"></span><br><span class="line">-- 2.在价格排序（降序）的基础上，以分类排序（降序）</span><br><span class="line">select * from product order by price desc, category_id desc;</span><br><span class="line"></span><br><span class="line">-- 3.显示商品的价格（去重复），并排序（降序）</span><br><span class="line">select distinct price from product order by price desc;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="基本查询—聚合查询"><a href="#基本查询—聚合查询" class="headerlink" title="基本查询—聚合查询"></a>基本查询—聚合查询</h3>
<h4 id="简介-3"><a href="#简介-3" class="headerlink" title="简介-3"></a>简介</h4>
<p>之前我们做的查询都是横向查询，它们都是根据条件一行一行的进行判断，而使用聚合函数查询是纵向查询，它是对一列的值进行计算，然后返回一个单一的值；另外聚合函数会忽略空值。</p>
<table>
<thead>
<tr>
<th style="text-align:center">聚合函数</th>
<th style="text-align:center">作用</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">count()</td>
<td style="text-align:center">统计指定列不为NULL的记录行数；</td>
</tr>
<tr>
<td style="text-align:center">sum()</td>
<td style="text-align:center">计算指定列的数值和，如果指定列类型不是数值类型，那么计算结果为0；</td>
</tr>
<tr>
<td style="text-align:center">max()</td>
<td style="text-align:center">计算指定列的最大值，如果指定列是字符串类型，那么使用字符串排序运算；</td>
</tr>
<tr>
<td style="text-align:center">min()</td>
<td style="text-align:center">计算指定列的最小值，如果指定列是字符串类型，那么使用字符串排序运算；</td>
</tr>
<tr>
<td style="text-align:center">avg()</td>
<td style="text-align:center">计算指定列的平均值，如果指定列类型不是数值类型，那么计算结果为0</td>
</tr>
</tbody>
</table>
<h4 id="操作-4"><a href="#操作-4" class="headerlink" title="操作-4"></a>操作</h4>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">-- 1 查询商品的总条数</span><br><span class="line">select count(*) from product;</span><br><span class="line"></span><br><span class="line">-- 2 查询价格大于200商品的总条数</span><br><span class="line">select count(*) from product where price &gt; 200;</span><br><span class="line"></span><br><span class="line">-- 3 查询分类为&#x27;c001&#x27;的所有商品的总和</span><br><span class="line">select sum(price) from product where category_id = &#x27;c001&#x27;;</span><br><span class="line"></span><br><span class="line">-- 4 查询商品的最大价格</span><br><span class="line">select max(price) from product;</span><br><span class="line"></span><br><span class="line">-- 5 查询商品的最小价格</span><br><span class="line">select min(price) from product;</span><br><span class="line"></span><br><span class="line">-- 6 查询分类为&#x27;c002&#x27;所有商品的平均价格</span><br><span class="line">select avg(price) from product where category_id = &#x27;c002&#x27;;</span><br><span class="line"></span><br><span class="line">-- 7 查询商品的最大和最小价格,并分别命名为 max_price 和 min_price :</span><br><span class="line">select max(price) max_price, min(price) min_price from product;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h4 id="NULL值的处理"><a href="#NULL值的处理" class="headerlink" title="NULL值的处理"></a>NULL值的处理</h4>
<h5 id="介绍-2"><a href="#介绍-2" class="headerlink" title="介绍-2"></a>介绍</h5>
<blockquote>
<ol>
<li>
<p>count函数对null值的处理：<br>
如果count函数的参数为星号（*），则统计所有记录的个数。而如果参数为某字段，不统计含null值的记录个数。</p>
</li>
<li>
<p>sum和avg函数对null值的处理：</p>
<p>这两个函数忽略null值的存在，就好像该条记录不存在一样。</p>
</li>
<li>
<p>max和min函数对null值的处理：</p>
<p>max和min两个函数同样忽略null值的存在。</p>
</li>
</ol>
</blockquote>
<h5 id="操作-5"><a href="#操作-5" class="headerlink" title="操作-5"></a>操作</h5>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">-- 创建表</span><br><span class="line">create table test_null (</span><br><span class="line">	c1 varchar(20),</span><br><span class="line">    c2 int</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">-- 插入数据</span><br><span class="line">insert into test_null values(&#x27;aaa&#x27;,3);</span><br><span class="line">insert into test_null values(&#x27;bbb&#x27;,3);</span><br><span class="line">insert into test_null values(&#x27;ccc&#x27;,null);</span><br><span class="line">insert into test_null values(&#x27;ddd&#x27;,6);</span><br><span class="line"></span><br><span class="line">-- 测试</span><br><span class="line">-- SELECT COUNT(*)和 SELECT COUNT(1)  是一个意思</span><br><span class="line">select count(*), count(1), count(c2) from test_null;</span><br><span class="line">select sum(c2),max(c2),min(c2),avg(c2) from test_null;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="基本查询—分组查询—group-by"><a href="#基本查询—分组查询—group-by" class="headerlink" title="基本查询—分组查询—group-by"></a>基本查询—分组查询—group by</h3>
<h4 id="简介-4"><a href="#简介-4" class="headerlink" title="简介-4"></a>简介</h4>
<blockquote>
<p>分组查询是指使用group by字句对查询信息进行分组。</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">-- 格式：</span><br><span class="line">select 字段1，字段2…… from 表名 group by 分组字段 having 分组条件;</span><br><span class="line"></span><br><span class="line">-- 操作</span><br><span class="line">-- 1、统计各个分类商品的个数(注意：分组之后select的后边只能写分组字段和聚合函数)</span><br><span class="line">select category_id,count(*) from product group by category_id;</span><br><span class="line">-- group by可以指定多个分组字段；假如有三个分组字段，则筛选时必须三个分组字段一致才会分到一起（不分先后）。</span><br><span class="line">-- 例如：学生表，有： 学号  名字  年龄  省  市  县；（分组字段可不分先后）</span><br><span class="line">select from product group by 市, 省, 县;  -- 筛查结果为同一个省市县的分到一起并统计个数</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<blockquote>
<p>如果要进行分组的话，则select子句之后，只能出现分组的字段和统计函数，其他的字段不能出现；</p>
</blockquote>
<h4 id="分组之后的条件筛选—having"><a href="#分组之后的条件筛选—having" class="headerlink" title="分组之后的条件筛选—having"></a>分组之后的条件筛选—having</h4>
<blockquote>
<ul>
<li>分组之后对统计结果进行筛选的话必须使用having，不能使用where；</li>
<li>where子句用来筛选FROM子句中指定的操作所产生的行；</li>
<li>group by 子句用来分组where子句的输出；</li>
<li>having 子句用来从分组的结果中筛选行。</li>
</ul>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">-- 格式</span><br><span class="line">select 字段1, 字段2… from 表名 group by 分组字段 having 分组条件;</span><br><span class="line"></span><br><span class="line">-- 操作</span><br><span class="line">-- 2.统计各个分类商品的个数，且只显示个数大于4的信息</span><br><span class="line">select category_id, count(*) from product group by category_id having count(*) &gt; 4;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="基本查询—分页查询—limit"><a href="#基本查询—分页查询—limit" class="headerlink" title="基本查询—分页查询—limit"></a>基本查询—分页查询—limit</h3>
<h4 id="简介-5"><a href="#简介-5" class="headerlink" title="简介-5"></a>简介</h4>
<p>分页查询在项目开发中常见，由于数据量很大，显示屏长度有限，因此对数据需要采取分页显示方式。例如数据共有30条，每页显示5条，第一页显示1-5条，第二页显示6-10条。</p>
<h4 id="格式"><a href="#格式" class="headerlink" title="格式"></a>格式</h4>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">-- 方式1——显示前n条</span><br><span class="line">select 字段1, 字段2… from 表名 limit n;</span><br><span class="line"></span><br><span class="line">-- 方式2——分页显示</span><br><span class="line">select 字段1, 字段2… from 表名 limit m,n;</span><br><span class="line"></span><br><span class="line">m：整数，表示从第几条索引开始，计算方式（当前页-1）*每页显示条数</span><br><span class="line">n：整数，表示查询多少条数据</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h4 id="操作-6"><a href="#操作-6" class="headerlink" title="操作-6"></a>操作</h4>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">-- 查询product表的前5条记录</span><br><span class="line">select * from product limit 5;</span><br><span class="line"></span><br><span class="line">-- 从第4条开始显示，显示5条</span><br><span class="line">select * from product limit 3,5;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="基本查询—INSERT-INTO-SELECT语句"><a href="#基本查询—INSERT-INTO-SELECT语句" class="headerlink" title="基本查询—INSERT-INTO-SELECT语句"></a>基本查询—INSERT INTO SELECT语句</h3>
<h4 id="简介-6"><a href="#简介-6" class="headerlink" title="简介-6"></a>简介</h4>
<blockquote>
<p>将一张表的数据导入到另一张表中，可以使用INSERT INTO SELECT语句 。</p>
</blockquote>
<h4 id="格式-2"><a href="#格式-2" class="headerlink" title="格式-2"></a>格式</h4>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">insert into Table2(field1, field2) select value1, value2,… from Table1;</span><br><span class="line">或者：</span><br><span class="line">insert into Table2 select * from Table1;</span><br><span class="line"></span><br><span class="line">注意：要求目标表Table2必须存在</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h4 id="操作-7"><a href="#操作-7" class="headerlink" title="操作-7"></a>操作</h4>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">-- 实例</span><br><span class="line">-- 创建表名为product2的表(要与表1中的字段名一致)</span><br><span class="line">create table product2 (</span><br><span class="line">	pname varchar(20),</span><br><span class="line">    price double</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">-- 从表1将数据插入到表2（pname，price）</span><br><span class="line">insert into product2(pname,price) select pname,price from product;</span><br><span class="line"></span><br><span class="line">-- 检查是否成功插入</span><br><span class="line">select * from product2;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="SELECT-INTO-FROM语句"><a href="#SELECT-INTO-FROM语句" class="headerlink" title="SELECT-INTO-FROM语句"></a>SELECT INTO FROM语句</h3>
<h4 id="简介-7"><a href="#简介-7" class="headerlink" title="简介-7"></a>简介</h4>
<blockquote>
<p>将一张表的数据导入到另一张表中，有两种选择 SELECT INTO 和 INSERT INTO SELECT 。</p>
</blockquote>
<h4 id="格式-3"><a href="#格式-3" class="headerlink" title="格式-3"></a>格式</h4>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select value1, value2 into Table2 from Table1;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>注意： 要求目标表Table2不存在，因为在插入时会自动创建表Table2，并将Table1中指定字段数据复制到Table2中。</p>
</blockquote>
<h4 id="操作-8"><a href="#操作-8" class="headerlink" title="操作-8"></a>操作</h4>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select pname,price into product3 from product;</span><br></pre></td></tr></table></figure>
<h3 id="练习1"><a href="#练习1" class="headerlink" title="练习1"></a>练习1</h3>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line">-- 选择数据库</span><br><span class="line">use mydb2;</span><br><span class="line"></span><br><span class="line">-- 创建学生表</span><br><span class="line">create table student (</span><br><span class="line">	id int,</span><br><span class="line">    name varchar(20),</span><br><span class="line">    gender varchar(20),</span><br><span class="line">    chinese int,</span><br><span class="line">    english int,</span><br><span class="line">    math int</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">-- 插入数据</span><br><span class="line">insert into student(id,name,gender,chinese,english,math) values(1,&#x27;张明&#x27;,&#x27;男&#x27;,89,78,90);</span><br><span class="line">insert into student(id,name,gender,chinese,english,math) values(2,&#x27;李进&#x27;,&#x27;男&#x27;,67,53,95);</span><br><span class="line">insert into student(id,name,gender,chinese,english,math) values(3,&#x27;王五&#x27;,&#x27;女&#x27;,87,78,77);</span><br><span class="line">insert into student(id,name,gender,chinese,english,math) values(4,&#x27;李一&#x27;,&#x27;女&#x27;,88,98,92);</span><br><span class="line">insert into student(id,name,gender,chinese,english,math) values(5,&#x27;李财&#x27;,&#x27;男&#x27;,82,84,67);</span><br><span class="line">insert into student(id,name,gender,chinese,english,math) values(6,&#x27;张宝&#x27;,&#x27;男&#x27;,55,85,45);</span><br><span class="line">insert into student(id,name,gender,chinese,english,math) values(7,&#x27;黄蓉&#x27;,&#x27;女&#x27;,75,65,30);</span><br><span class="line">insert into student(id,name,gender,chinese,english,math) values(7,&#x27;黄蓉&#x27;,&#x27;女&#x27;,75,65,30);</span><br><span class="line"></span><br><span class="line">-- 查询数据</span><br><span class="line">-- 1.查询表中所有学生的信息。</span><br><span class="line">select * from student;</span><br><span class="line">-- 2.查询表中所有学生的姓名和对应的英语成绩。</span><br><span class="line">select name,english from student;</span><br><span class="line">-- 3.过滤表中重复数据。</span><br><span class="line">select distinct * from student;</span><br><span class="line">-- 4.统计每个学生的总分。</span><br><span class="line">select name,(chinese + english + math) as total_score from student;</span><br><span class="line">-- 5.在所有学生总分数上加10分特长分。</span><br><span class="line">select name,(chinese + english + math)+10 as total_score from student;</span><br><span class="line">-- 6.使用别名表示学生分数。</span><br><span class="line">select name,chinese &#x27;语文成绩&#x27;, english &#x27;英语成绩&#x27;, math &#x27;数学成绩&#x27; from student;</span><br><span class="line">-- 7.查询英语成绩大于90分的同学。</span><br><span class="line">select * from student where english &gt; 90;</span><br><span class="line">-- 8.查询总分大于200分的所有同学。</span><br><span class="line">select *,(chinese + english + math) as total_score from student where (chinese + english + math) &gt; 200;</span><br><span class="line">-- 9.查询英语分数在80-90之间的同学。(两种方法)</span><br><span class="line">select * from student where english between 80 and 90;</span><br><span class="line">select * from student where english &gt;= 80 and english &lt;= 90;</span><br><span class="line">-- 10.查询英语成绩不在80-90之间的同学。(四种方法)</span><br><span class="line">select * from student where not (english between 80 and 90);</span><br><span class="line">select * from student where english not between 80 and 90;</span><br><span class="line">select * from student where not (english &gt;= 80 and english &lt;= 90);</span><br><span class="line">select * from student where english &lt; 80 || english &gt; 90;</span><br><span class="line">-- 11.查询数学分数为89,90,91的同学。</span><br><span class="line">select * from student where math in(89,90,91);</span><br><span class="line">-- 12.查询数学分数不为89,90,91的同学。</span><br><span class="line">select * from student where math not in(89,90,91);</span><br><span class="line">select * from student where not math in(89,90,91);</span><br><span class="line">-- 13.查询所有姓李的学生英语成绩。</span><br><span class="line">select name,english from student where name like &#x27;李%&#x27;;</span><br><span class="line">-- 14.查询数学分80并且语文分80的同学。</span><br><span class="line">select * from student where math = 80 and chinese = 80;</span><br><span class="line">-- 15.查询英语80或者总分200的同学。</span><br><span class="line">select * from student where english = 80 or (chinese + english + math) = 200;</span><br><span class="line">-- 16.对数学成绩降序排序后输出。</span><br><span class="line">select * from student order by math desc;</span><br><span class="line">-- 17.对总分排序后输出，然后再按从高到低的顺序输出。</span><br><span class="line">select *,(chinese + english + math) as total_score from student order by (chinese + english + math) desc;</span><br><span class="line">-- 18.对姓李的学生总分成绩降序排序输出。</span><br><span class="line">select *,(chinese + english + math) as total_score from student where name like &#x27;李%&#x27; order by (chinese + english + math) desc;</span><br><span class="line">-- 19.查询男生和女生分别有多少人，并将人数降序排序输出。</span><br><span class="line">select gender,count(*) as total_count from student group by gender order by total_count desc;</span><br><span class="line">-- 20.查询男生和女生分别有多少人，并将人数降序排序输出,查询出人数大于等于4的性别人数信息。</span><br><span class="line">select gender,count(*) as total_count from student group by gender having total_count &gt;= 4 order by total_count desc;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="练习2"><a href="#练习2" class="headerlink" title="练习2"></a>练习2</h3>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line">-- 选择mydb2数据库</span><br><span class="line">use mydb2;</span><br><span class="line"></span><br><span class="line">-- 创建工资表</span><br><span class="line">create table emp (</span><br><span class="line">	empno int,     -- 员工编号</span><br><span class="line">    ename varchar(50),  -- 员工名字</span><br><span class="line">    job varchar(50),  -- 工作名字</span><br><span class="line">    mgr int,     -- 上级领导编号</span><br><span class="line">    hiredate date,  -- 入职日期</span><br><span class="line">    sal int,       -- 薪资</span><br><span class="line">    comm int,      -- 奖金</span><br><span class="line">    deptno int     -- 部门编号</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">-- 插入数据</span><br><span class="line">insert into emp values(7369,&#x27;SMITH&#x27;,&#x27;CLERK&#x27;,7902,&#x27;1980-12-17&#x27;,800,NULL,20);</span><br><span class="line">insert into emp values(7499,&#x27;ALLEN&#x27;,&#x27;SALESMAN&#x27;,7698,&#x27;1981-02-20&#x27;,1600,300,30);</span><br><span class="line">insert into emp values(7521,&#x27;WARD&#x27;,&#x27;SALESMAN&#x27;,7698,&#x27;1981-02-22&#x27;,1250,500,30);</span><br><span class="line">insert into emp values(7566,&#x27;JONES&#x27;,&#x27;MANAGER&#x27;,7839,&#x27;1981-04-02&#x27;,2975,NULL,20);</span><br><span class="line">insert into emp values(7654,&#x27;MARTIN&#x27;,&#x27;SALESMAN&#x27;,7698,&#x27;1981-09-28&#x27;,1250,1400,30);</span><br><span class="line">insert into emp values(7698,&#x27;BLAKE&#x27;,&#x27;MANAGER&#x27;,7839,&#x27;1981-05-01&#x27;,2850,NULL,30);</span><br><span class="line">insert into emp values(7782,&#x27;CLARK&#x27;,&#x27;MANAGER&#x27;,7839,&#x27;1981-06-09&#x27;,2450,NULL,10);</span><br><span class="line">insert into emp values(7788,&#x27;SCOTT&#x27;,&#x27;ANALYST&#x27;,7566,&#x27;1987-04-19&#x27;,3000,NULL,20);</span><br><span class="line">insert into emp values(7839,&#x27;KING&#x27;,&#x27;PRESIDENT&#x27;,NULL,&#x27;1981-11-17&#x27;,5000,NULL,10);</span><br><span class="line">insert into emp values(7844,&#x27;TURNER&#x27;,&#x27;SALESMAN&#x27;,7698,&#x27;1981-09-08&#x27;,1500,0,30);</span><br><span class="line">insert into emp values(7876,&#x27;ADAMS&#x27;,&#x27;CLERK&#x27;,7788,&#x27;1987-05-23&#x27;,1100,NULL,20);</span><br><span class="line">insert into emp values(7900,&#x27;JAMES&#x27;,&#x27;CLERK&#x27;,7698,&#x27;1981-12-03&#x27;,950,NULL,30);</span><br><span class="line">insert into emp values(7902,&#x27;FORD&#x27;,&#x27;ANALYST&#x27;,7566,&#x27;1981-12-03&#x27;,3000,NULL,20);</span><br><span class="line">insert into emp values(7934,&#x27;MTLLER&#x27;,&#x27;CLERK&#x27;,7782,&#x27;1982-1-23&#x27;,1300,NULL,10);</span><br><span class="line"></span><br><span class="line">-- 查询数据</span><br><span class="line">-- 1、按员工编号升序排列不在10号部门工作的员工信息。（两种方法）</span><br><span class="line">select * from emp where deptno not in(10) order by empno;</span><br><span class="line">select * from emp where deptno != 10 order by empno;</span><br><span class="line">-- 2、查询姓名第二个字母不是“A”且薪水大于1000元的员工信息，按年薪降序排列。</span><br><span class="line">select *,(sal * 12 + ifnull(comm,0)) yearly from emp where ename not  like &#x27;_A%&#x27; and sal &gt; 1000 order by (sal * 12 + ifnull(comm,0)) desc;</span><br><span class="line">-- 3、求每个部门的平均薪水,并按平均薪水降序排序。</span><br><span class="line">select deptno,avg(sal) as avg_sal from emp group by deptno order by avg_sal desc;</span><br><span class="line">-- 4、求各个部门的最高薪水。</span><br><span class="line">select deptno,max(sal) as max_sal from emp group by deptno;</span><br><span class="line">-- 5、求每个部门每个岗位的最高薪水并按部门排序。</span><br><span class="line">select deptno,job,max(sal) from emp group by deptno,job order by deptno;</span><br><span class="line">-- 6、求平均薪水大于2000的部门编号。</span><br><span class="line">select deptno,avg(sal) from emp group by deptno having avg(sal) &gt; 2000;</span><br><span class="line">-- 7、将部门平均薪水大于1500的部门编号列出来，按部门平均薪水降序排列。</span><br><span class="line">select deptno,avg(sal) avg_sal from emp group by deptno having avg(sal) &gt; 1500 order by avg_sal desc;</span><br><span class="line">-- 8、选择公司中有奖金的员工姓名，工资。</span><br><span class="line">select ename,sal,comm from emp where comm is not null;</span><br><span class="line">-- 9、查询员工最高工资和最低工资的差距。</span><br><span class="line">select max(sal) - min(sal) &#x27;薪资差距&#x27; from emp;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="正则表达式"><a href="#正则表达式" class="headerlink" title="正则表达式"></a>正则表达式</h3>
<h4 id="介绍-3"><a href="#介绍-3" class="headerlink" title="介绍-3"></a>介绍</h4>
<blockquote>
<p>​	正则表达式(regular expression)描述了一种字符串匹配的规则，正则表达式本身就是一个字符串，使用这个字符串来描述、用来定义匹配规则，匹配一系列符合某个句法规则的字符串。在开发中，正则表达式通常被用来检索、替换那些符合某个规则的文本。</p>
<p>​	MySQL通过<strong>REGEXP关键字</strong>支持正则表达式进行字符串匹配。</p>
</blockquote>
<h4 id="格式-4"><a href="#格式-4" class="headerlink" title="格式-4"></a>格式</h4>
<table>
<thead>
<tr>
<th style="text-align:center">模式</th>
<th style="text-align:center">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">^</td>
<td style="text-align:center">匹配输入字符串的开始位置。</td>
</tr>
<tr>
<td style="text-align:center">$</td>
<td style="text-align:center">匹配输入字符串的结束位置。</td>
</tr>
<tr>
<td style="text-align:center">.</td>
<td style="text-align:center">匹配除&quot;\n&quot;之外的任何某个字符。</td>
</tr>
<tr>
<td style="text-align:center">[…]</td>
<td style="text-align:center">字符集合。匹配所包含的任意一个字符。例如，'[abc]‘可以匹配&quot;plain&quot;中的’a’。</td>
</tr>
<tr>
<td style="text-align:center">[^…]</td>
<td style="text-align:center">负值字符集合。匹配未包含的任意字符。例如，'[^abc]‘可以匹配&quot;plain&quot;中的’p’。</td>
</tr>
<tr>
<td style="text-align:center">p1|p2|p3</td>
<td style="text-align:center">匹配p1或p2或p3。例如，‘z|food’能匹配&quot;z&quot;或&quot;food&quot;。’(z|f)ood’则匹配&quot;zood&quot;或&quot;food&quot;。</td>
</tr>
<tr>
<td style="text-align:center">*</td>
<td style="text-align:center">匹配前面的子表达式零次或多次。例如，&quot;zo*“能匹配&quot;z&quot;以及&quot;zoo”。 * 等价于{0,}。</td>
</tr>
<tr>
<td style="text-align:center">+</td>
<td style="text-align:center">匹配前面的子表达式一次或多次。例如，“zo+“能匹配&quot;zo&quot;以及&quot;zoo”，但不能匹配&quot;z”。+ 等价于 {1,}。</td>
</tr>
<tr>
<td style="text-align:center">{n}</td>
<td style="text-align:center">n 是一个非负整数。匹配确定的 n 次。例如，‘o{2}’ 不能匹配 “Bob” 中的 ‘o’，但是能匹配 “food” 中的两个 o。</td>
</tr>
<tr>
<td style="text-align:center">{n,m}</td>
<td style="text-align:center">m 和 n 均为非负整数，其中n &lt;= m。最少匹配 n 次且最多匹配 m 次。</td>
</tr>
</tbody>
</table>
<h3 id="正则表达式匹配查询"><a href="#正则表达式匹配查询" class="headerlink" title="正则表达式匹配查询"></a>正则表达式匹配查询</h3>
<h4 id="操作上"><a href="#操作上" class="headerlink" title="操作上"></a>操作上</h4>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">-- ^ 在字符串开始处进行匹配</span><br><span class="line">SELECT  &#x27;abc&#x27; REGEXP &#x27;^a&#x27;;</span><br><span class="line"> </span><br><span class="line">-- $ 在字符串末尾开始匹配</span><br><span class="line">SELECT  &#x27;abc&#x27; REGEXP &#x27;a$&#x27;;</span><br><span class="line">SELECT  &#x27;abc&#x27; REGEXP &#x27;c$&#x27;;</span><br><span class="line"></span><br><span class="line">-- . 匹配任意字符</span><br><span class="line">SELECT  &#x27;abc&#x27; REGEXP &#x27;.b&#x27;;</span><br><span class="line">SELECT  &#x27;abc&#x27; REGEXP &#x27;.c&#x27;;</span><br><span class="line">SELECT  &#x27;abc&#x27; REGEXP &#x27;a.&#x27;;</span><br><span class="line"> </span><br><span class="line">-- [...] 匹配括号内的任意单个字符</span><br><span class="line">SELECT  &#x27;abc&#x27; REGEXP &#x27;[xyz]&#x27;;</span><br><span class="line">SELECT  &#x27;abc&#x27; REGEXP &#x27;[xaz]&#x27;;</span><br><span class="line"></span><br><span class="line">-- [^...] 注意^符合只有在[]内才是取反的意思，在别的地方都是表示开始处匹配</span><br><span class="line">SELECT  &#x27;a&#x27; REGEXP &#x27;[^abc]&#x27;;</span><br><span class="line">SELECT  &#x27;x&#x27; REGEXP &#x27;[^abc]&#x27;;</span><br><span class="line">SELECT  &#x27;abc&#x27; REGEXP &#x27;[^a]&#x27;;</span><br><span class="line"> </span><br><span class="line">-- a* 匹配0个或多个a,包括空字符串。 可以作为占位符使用.有没有指定字符都可以匹配到数据</span><br><span class="line"> </span><br><span class="line">SELECT &#x27;stab&#x27; REGEXP &#x27;.ta*b&#x27;;</span><br><span class="line">SELECT &#x27;stb&#x27; REGEXP &#x27;.ta*b&#x27;;</span><br><span class="line">SELECT &#x27;&#x27; REGEXP &#x27;a*&#x27;;</span><br><span class="line"> </span><br><span class="line">-- a+  匹配1个或者多个a,但是不包括空字符</span><br><span class="line">SELECT &#x27;stab&#x27; REGEXP &#x27;.ta+b&#x27;;</span><br><span class="line">SELECT &#x27;stb&#x27; REGEXP &#x27;.ta+b&#x27;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h4 id="操作下"><a href="#操作下" class="headerlink" title="操作下"></a>操作下</h4>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">-- a?  匹配0个或者1个a</span><br><span class="line">SELECT &#x27;stb&#x27; REGEXP &#x27;.ta?b&#x27;;</span><br><span class="line">SELECT &#x27;stab&#x27; REGEXP &#x27;.ta?b&#x27;;</span><br><span class="line">SELECT &#x27;staab&#x27; REGEXP &#x27;.ta?b&#x27;;</span><br><span class="line"> </span><br><span class="line">-- a1|a2  匹配a1或者a2，</span><br><span class="line">SELECT &#x27;a&#x27; REGEXP &#x27;a|b&#x27;;</span><br><span class="line">SELECT &#x27;b&#x27; REGEXP &#x27;a|b&#x27;;</span><br><span class="line">SELECT &#x27;b&#x27; REGEXP &#x27;^(a|b)&#x27;;</span><br><span class="line">SELECT &#x27;a&#x27; REGEXP &#x27;^(a|b)&#x27;;</span><br><span class="line">SELECT &#x27;c&#x27; REGEXP &#x27;^(a|b)&#x27;;</span><br><span class="line"> </span><br><span class="line">-- a&#123;m&#125; 匹配m个a</span><br><span class="line">SELECT &#x27;auuuuc&#x27; REGEXP &#x27;au&#123;4&#125;c&#x27;;</span><br><span class="line">SELECT &#x27;auuuuc&#x27; REGEXP &#x27;au&#123;3&#125;c&#x27;;</span><br><span class="line"></span><br><span class="line"> -- a&#123;m,n&#125; 匹配m到n个a,包含m和n</span><br><span class="line">SELECT &#x27;auuuuc&#x27; REGEXP &#x27;au&#123;3,5&#125;c&#x27;;</span><br><span class="line">SELECT &#x27;auuuuc&#x27; REGEXP &#x27;au&#123;4,5&#125;c&#x27;;</span><br><span class="line">SELECT &#x27;auuuuc&#x27; REGEXP &#x27;au&#123;5,10&#125;c&#x27;;</span><br><span class="line"> </span><br><span class="line">-- (abc) abc作为一个序列匹配，不用括号括起来都是用单个字符去匹配，如果要把多个字符作为一个整体去匹配就需要用到括号，所以括号适合上面的所有情况。</span><br><span class="line">SELECT &#x27;xababy&#x27; REGEXP &#x27;x(abab)y&#x27;;</span><br><span class="line">SELECT &#x27;xababy&#x27; REGEXP &#x27;x(ab)*y&#x27;;</span><br><span class="line">SELECT &#x27;xababy&#x27; REGEXP &#x27;x(ab)&#123;1,2&#125;y&#x27;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h2 id="多表操作"><a href="#多表操作" class="headerlink" title="多表操作"></a>多表操作</h2>
<h3 id="介绍-4"><a href="#介绍-4" class="headerlink" title="介绍-4"></a>介绍</h3>
<blockquote>
<p>​	实际开发中，一个项目通常需要很多张表才能完成。例如：一个商城项目就需要分类表(category)、商品表(products)、订单表(orders)等多张表。且这些表的数据之间存在一定的关系，接下来我们将在单表的基础上，一起学习多表方面的知识。</p>
</blockquote>
<h3 id="多表关系"><a href="#多表关系" class="headerlink" title="多表关系"></a>多表关系</h3>
<blockquote>
<p>MySQL多表之间的关系可以概括为：一对一、一对多/多对一关系，多对多</p>
</blockquote>
<h4 id="一对一关系"><a href="#一对一关系" class="headerlink" title="一对一关系"></a>一对一关系</h4>
<blockquote>
<blockquote>
<p>一个学生只有一张身份证；一张身份证只能对应一学生。</p>
<p>在任一表中添加唯一外键，指向另一方主键，确保一对一关系。</p>
<p>一般一对一关系很少见，遇到一对一关系的表最好是合并表。</p>
</blockquote>
</blockquote>
<p class='item-img' data-src='assets/1723458272353.png'><img src="assets/1723458272353.png" alt="72345827235"></p>
<h4 id="一对多-多对一关系"><a href="#一对多-多对一关系" class="headerlink" title="一对多-多对一关系"></a>一对多/多对一关系</h4>
<blockquote>
<blockquote>
<p>部门和员工：</p>
<p>分析：一个部门有多个员工，一个员工只能对应一个部门；</p>
<p>实现原则：在多的一方建立外键，指向一的一方的主键。</p>
</blockquote>
</blockquote>
<p class='item-img' data-src='assets/1723458422997.png'><img src="assets/1723458422997.png" alt="72345842299"></p>
<h4 id="多对多关系"><a href="#多对多关系" class="headerlink" title="多对多关系"></a>多对多关系</h4>
<blockquote>
<blockquote>
<p>学生和课程：</p>
<p>分析：一个学生可以选择很多门课程，一个课程也可以被很多学生选择；</p>
<p>原则：多对多关系实现需要借助第三张中间表。中间表至少包含两个字段，将多对多的关系，拆成一对多的关系，中间表至少要有两个外键，这两个外键分别指向原来的那两张表的主键。</p>
<p>​	注：多对多的关系需要一个中间表作为桥梁</p>
</blockquote>
</blockquote>
<p class='item-img' data-src='assets/1723458752429.png'><img src="assets/1723458752429.png" alt="72345875242"></p>
<h3 id="外键约束—概念"><a href="#外键约束—概念" class="headerlink" title="外键约束—概念"></a>外键约束—概念</h3>
<h4 id="介绍-5"><a href="#介绍-5" class="headerlink" title="介绍-5"></a>介绍</h4>
<blockquote>
<p>MySQL 外键约束（FOREIGN KEY）是表的一个特殊字段，经常与主键约束一起使用。对于两个具有关联关系的表而言，相关联字段中主键所在的表就是主表（父表），外键所在的表就是从表（子表）。</p>
<p>外键用来建立主表与从表的关联关系，为两个表的数据建立连接，约束两个表中数据的一致性和完整性。比如，一个水果摊，只有苹果、桃子、李子、西瓜等 4 种水果，那么，你来到水果摊要买水果就只能选择苹果、桃子、李子和西瓜，其它的水果都是不能购买的。</p>
</blockquote>
<p class='item-img' data-src='assets/1723513337738.png'><img src="assets/1723513337738.png" alt="72351333773"></p>
<h4 id="特点-2"><a href="#特点-2" class="headerlink" title="特点-2"></a>特点</h4>
<blockquote>
<p>定义一个外键时，需要遵守下列规则：</p>
<ul>
<li>
<p>主表必须已经存在于数据库中，或者是当前正在创建的表。</p>
</li>
<li>
<p>必须为主表定义主键。</p>
</li>
<li>
<p>​    主键不能包含空值，但允许在外键中出现空值。也就是说，只要外键的每个非空值出现在指定的主键中，这 个外键的内容就是正确的。</p>
</li>
<li>
<p>在主表的表名后面指定列名或列名的组合。这个列或列的组合必须是主表的主键或候选键。</p>
</li>
<li>
<p>外键中列的数目必须和主表的主键中列的数目相同。</p>
</li>
<li>
<p>外键中列的数据类型必须和主表主键中对应列的数据类型相同。</p>
</li>
</ul>
</blockquote>
<h3 id="外键约束—一对多关系"><a href="#外键约束—一对多关系" class="headerlink" title="外键约束—一对多关系"></a>外键约束—一对多关系</h3>
<h4 id="操作-创建外键约束"><a href="#操作-创建外键约束" class="headerlink" title="操作-创建外键约束"></a>操作-创建外键约束</h4>
<p>方式1-在创建表时设置外键约束</p>
<p>在 create table 语句中，通过 <strong><code>foreign key</code></strong> 关键字来指定外键，具体的语法格式如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[constraint &lt;外键名&gt;] foreign key 字段名 [，字段名2，…] references &lt;主表名&gt; 主键列1 [，主键列2，…];</span><br></pre></td></tr></table></figure>
<p>实现：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">create database mydb3; </span><br><span class="line">use mydb3;</span><br><span class="line">-- 创建部门表</span><br><span class="line">create table if not exists dept(</span><br><span class="line">  deptno varchar(20) primary key,  -- 部门号</span><br><span class="line">  name varchar(20) -- 部门名字</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">-- 创建员工表</span><br><span class="line">create table if not exists emp(</span><br><span class="line">  eid varchar(20) primary key , -- 员工编号</span><br><span class="line">  ename varchar(20), -- 员工名字</span><br><span class="line">  age int,  -- 员工年龄</span><br><span class="line">  dept_id varchar(20),  -- 员工所属部门</span><br><span class="line">  constraint emp_fk foreign key (dept_id) references dept (deptno)         -- 外键约束</span><br><span class="line">);</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p class='item-img' data-src='assets/1723628931930.png'><img src="assets/1723628931930.png" alt="72362893193"></p>
<p>方式2-在创建表时设置外键约束</p>
<blockquote>
<p>外键约束也可以在修改表时添加，但是添加外键约束的前提是：从表中外键列中的数据必须与主表中主键列中的数据一致或者是没有数据。</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">alter table &lt;数据表名&gt; add constraint &lt;外键名&gt; foreign key(&lt;列名&gt;) references &lt;主表名&gt; (&lt;列名&gt;);</span><br></pre></td></tr></table></figure>
<p>实现：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">-- 创建部门表</span><br><span class="line">create table if not exists dept2(</span><br><span class="line">  deptno varchar(20) primary key ,  -- 部门号</span><br><span class="line">  name varchar(20) -- 部门名字</span><br><span class="line">);</span><br><span class="line">-- 创建员工表</span><br><span class="line">create table if not exists emp2(</span><br><span class="line">  eid varchar(20) primary key , -- 员工编号</span><br><span class="line">  ename varchar(20), -- 员工名字</span><br><span class="line">  age int,  -- 员工年龄</span><br><span class="line">  dept_id varchar(20)  -- 员工所属部门</span><br><span class="line">);</span><br><span class="line">-- 创建外键约束</span><br><span class="line">alter table emp2 add constraint dept_id_fk foreign key(dept_id) references dept2 (deptno);</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p class='item-img' data-src='assets/1723638273956.png'><img src="assets/1723638273956.png" alt="72363827395"></p>
<h4 id="操作-在外键约束下的数据操作"><a href="#操作-在外键约束下的数据操作" class="headerlink" title="操作-在外键约束下的数据操作"></a>操作-在外键约束下的数据操作</h4>
<p>验证外键约束的作用</p>
<p>1、数据插入</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">-- 1、添加主表数据</span><br><span class="line"> -- 注意必须先给主表添加数据</span><br><span class="line">insert into dept values(&#x27;1001&#x27;,&#x27;研发部&#x27;);</span><br><span class="line">insert into dept values(&#x27;1002&#x27;,&#x27;销售部&#x27;);</span><br><span class="line">insert into dept values(&#x27;1003&#x27;,&#x27;财务部&#x27;);</span><br><span class="line">insert into dept values(&#x27;1004&#x27;,&#x27;人事部&#x27;);</span><br><span class="line"></span><br><span class="line">-- 2、添加从表数据</span><br><span class="line">  -- 注意给从表添加数据时，外键列的值不能随便写，必须依赖主表的主键列</span><br><span class="line">insert into emp values(&#x27;1&#x27;,&#x27;乔峰&#x27;,20, &#x27;1001&#x27;);</span><br><span class="line">insert into emp values(&#x27;2&#x27;,&#x27;段誉&#x27;,21, &#x27;1001&#x27;);</span><br><span class="line">insert into emp values(&#x27;3&#x27;,&#x27;虚竹&#x27;,23, &#x27;1001&#x27;);</span><br><span class="line">insert into emp values(&#x27;4&#x27;,&#x27;阿紫&#x27;,18, &#x27;1002&#x27;);</span><br><span class="line">insert into emp values(&#x27;5&#x27;,&#x27;扫地僧&#x27;,35, &#x27;1002&#x27;);</span><br><span class="line">insert into emp values(&#x27;6&#x27;,&#x27;李秋水&#x27;,33, &#x27;1003&#x27;);</span><br><span class="line">insert into emp values(&#x27;7&#x27;,&#x27;鸠摩智&#x27;,50, &#x27;1003&#x27;); </span><br><span class="line">insert into emp values(&#x27;8&#x27;,&#x27;天山童姥&#x27;,60, &#x27;1005&#x27;);  -- 不可以</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>2、删除数据</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">-- 3、删除数据</span><br><span class="line"> /*</span><br><span class="line">   注意：</span><br><span class="line">       1：主表的数据被从表依赖时，不能删除，否则可以删除</span><br><span class="line">       2: 从表的数据可以随便删除</span><br><span class="line"> */</span><br><span class="line">delete from dept where deptno = &#x27;1001&#x27;; -- 不可以删除</span><br><span class="line">delete from dept where deptno = &#x27;1004&#x27;; -- 可以删除</span><br><span class="line">delete from emp where eid = &#x27;7&#x27;; -- 可以删除</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h4 id="操作-删除外键约束"><a href="#操作-删除外键约束" class="headerlink" title="操作-删除外键约束"></a>操作-删除外键约束</h4>
<blockquote>
<p>当一个表中不需要外键约束时，就需要从表中将其删除。外键一旦删除，就会解除主表和从表间的关联关系</p>
</blockquote>
<p>格式：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">alter table &lt;表名&gt; drop foreign key &lt;外键约束名&gt;;</span><br></pre></td></tr></table></figure>
<p>实现：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">alter table emp2 drop foreign key dept_id_fk;</span><br></pre></td></tr></table></figure>
<h3 id="外键约束-多对多关系"><a href="#外键约束-多对多关系" class="headerlink" title="外键约束-多对多关系"></a>外键约束-多对多关系</h3>
<h4 id="介绍-6"><a href="#介绍-6" class="headerlink" title="介绍-6"></a>介绍</h4>
<blockquote>
<p>在多对多关系中，A表的一行对应B的多行，B表的一行对应A表的多行，我们要新增加一个中间表，来建立多对多关系。</p>
</blockquote>
<p class='item-img' data-src='assets/1723949414488.png'><img src="assets/1723949414488.png" alt="72394941448"></p>
<h4 id="操作-9"><a href="#操作-9" class="headerlink" title="操作-9"></a>操作</h4>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">-- 选择mydb3数据库</span><br><span class="line">use mydb3;</span><br><span class="line"></span><br><span class="line">-- 学生表和课程表(多对多)</span><br><span class="line">  -- 1 创建学生表student(左侧主表)</span><br><span class="line">   create table if not exists student(</span><br><span class="line">    sid int primary key auto_increment,</span><br><span class="line">    name varchar(20),</span><br><span class="line">    age int,</span><br><span class="line">    gender varchar(20)</span><br><span class="line">   );</span><br><span class="line">  -- 2 创建课程表course(右侧主表)</span><br><span class="line">  create table course(</span><br><span class="line">   cid  int primary key auto_increment,</span><br><span class="line">   cidname varchar(20)</span><br><span class="line">  );</span><br><span class="line"></span><br><span class="line">-- 3创建中间表student_course/score(从表)</span><br><span class="line">  create table score(</span><br><span class="line">    sid int,</span><br><span class="line">    cid int,</span><br><span class="line">    score double</span><br><span class="line">  );</span><br><span class="line">    </span><br><span class="line">-- 4建立外键约束(2次)</span><br><span class="line"> </span><br><span class="line">alter table score add foreign key(sid) references student(sid);</span><br><span class="line">alter table score add foreign key(cid) references course(cid);</span><br><span class="line"> </span><br><span class="line">-- 5给学生表添加数据</span><br><span class="line">insert into student values(1,&#x27;小龙女&#x27;,18,&#x27;女&#x27;),(2,&#x27;阿紫&#x27;,19,&#x27;女&#x27;),(3,&#x27;周芷若&#x27;,20,&#x27;男&#x27;);</span><br><span class="line">-- 6给课程表添加数据</span><br><span class="line">insert into course values(1,&#x27;语文&#x27;),(2,&#x27;数学&#x27;),(3,&#x27;英语&#x27;);</span><br><span class="line">-- 7给中间表添加数据</span><br><span class="line">insert into score values(1,1,78),(1,2,75),(2,1,88),(2,3,90),(3,2,80),(3,3,65);</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<blockquote>
<p>注意：修改和删除时，中间从表可以随便删除和修改，但是两边的主表受从表依赖的数据不能删除或者修改。</p>
</blockquote>
<h3 id="多表联合查询"><a href="#多表联合查询" class="headerlink" title="多表联合查询"></a>多表联合查询</h3>
<h4 id="介绍-7"><a href="#介绍-7" class="headerlink" title="介绍-7"></a>介绍</h4>
<blockquote>
<p>多表查询就是同时查询两个或两个以上的表，因为有的时候用户在查看数据的时候,需要显示的数据来自多张表。</p>
</blockquote>
<p>多表查询有以下分类：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">交叉连接查询 [产生笛卡尔积，了解]</span><br><span class="line">      语法：select * from A,B;  </span><br><span class="line"></span><br><span class="line">内连接查询(使用的关键字 inner join  -- inner可以省略)</span><br><span class="line">    隐式内连接（SQL92标准）：select * from A,B where 条件;</span><br><span class="line">    显示内连接（SQL99标准）：select * from A inner join B on 条件;</span><br><span class="line"></span><br><span class="line">外连接查询(使用的关键字 outer join -- outer可以省略)</span><br><span class="line">        左外连接：left outer join</span><br><span class="line">            select * from A left outer join B on 条件;</span><br><span class="line">        右外连接：right outer join</span><br><span class="line">            select * from A right outer join B on 条件;</span><br><span class="line">        满外连接: full outer join</span><br><span class="line">             select * from A full outer join B on 条件;</span><br><span class="line">子查询</span><br><span class="line">       select的嵌套</span><br><span class="line">表自关联：</span><br><span class="line">       将一张表当成多张表来用</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p class='item-img' data-src='assets/1723972088858.png'><img src="assets/1723972088858.png" alt="72397208885"></p>
<h4 id="准备查询数据"><a href="#准备查询数据" class="headerlink" title="准备查询数据"></a>准备查询数据</h4>
<blockquote>
<p>接下来准备多表查询需要数据，注意，<strong>外键约束对多表查询并无影响</strong>。</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">use mydb3;</span><br><span class="line"></span><br><span class="line">-- 创建部门表</span><br><span class="line">create table if not exists dept3(</span><br><span class="line">  deptno varchar(20) primary key ,  -- 部门号</span><br><span class="line">  name varchar(20) -- 部门名字</span><br><span class="line">);</span><br><span class="line"> </span><br><span class="line">-- 创建员工表</span><br><span class="line">create table if not exists emp3(</span><br><span class="line">  eid varchar(20) primary key , -- 员工编号</span><br><span class="line">  ename varchar(20), -- 员工名字</span><br><span class="line">  age int,  -- 员工年龄</span><br><span class="line">  dept_id varchar(20)  -- 员工所属部门</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">-- 给dept3表添加数据</span><br><span class="line">insert into dept3 values(&#x27;1001&#x27;,&#x27;研发部&#x27;);</span><br><span class="line">insert into dept3 values(&#x27;1002&#x27;,&#x27;销售部&#x27;);</span><br><span class="line">insert into dept3 values(&#x27;1003&#x27;,&#x27;财务部&#x27;);</span><br><span class="line">insert into dept3 values(&#x27;1004&#x27;,&#x27;人事部&#x27;);</span><br><span class="line"></span><br><span class="line">-- 给emp表添加数据</span><br><span class="line">insert into emp3 values(&#x27;1&#x27;,&#x27;乔峰&#x27;,20, &#x27;1001&#x27;);</span><br><span class="line">insert into emp3 values(&#x27;2&#x27;,&#x27;段誉&#x27;,21, &#x27;1001&#x27;);</span><br><span class="line">insert into emp3 values(&#x27;3&#x27;,&#x27;虚竹&#x27;,23, &#x27;1001&#x27;);</span><br><span class="line">insert into emp3 values(&#x27;4&#x27;,&#x27;阿紫&#x27;,18, &#x27;1001&#x27;);</span><br><span class="line">insert into emp3 values(&#x27;5&#x27;,&#x27;扫地僧&#x27;,85, &#x27;1002&#x27;);</span><br><span class="line">insert into emp3 values(&#x27;6&#x27;,&#x27;李秋水&#x27;,33, &#x27;1002&#x27;);</span><br><span class="line">insert into emp3 values(&#x27;7&#x27;,&#x27;鸠摩智&#x27;,50, &#x27;1002&#x27;); </span><br><span class="line">insert into emp3 values(&#x27;8&#x27;,&#x27;天山童姥&#x27;,60, &#x27;1003&#x27;);</span><br><span class="line">insert into emp3 values(&#x27;9&#x27;,&#x27;慕容博&#x27;,58, &#x27;1003&#x27;);</span><br><span class="line">insert into emp3 values(&#x27;10&#x27;,&#x27;丁春秋&#x27;,71, &#x27;1005&#x27;);</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="多表联合查询—交叉连接查询"><a href="#多表联合查询—交叉连接查询" class="headerlink" title="多表联合查询—交叉连接查询"></a>多表联合查询—交叉连接查询</h3>
<blockquote>
<ul>
<li>交叉连接查询返回被连接的两个表所有数据行的笛卡尔积</li>
<li>笛卡尔积可以理解为一张表的每一行去和另外一张表的任意一行进行匹配</li>
<li>假如A表有m行数据，B表有n行数据，则返回m*n行数据</li>
<li>笛卡尔积会产生很多冗余的数据，后期的其他查询可以在该集合的基础上进行条件筛选</li>
</ul>
</blockquote>
<h4 id="格式："><a href="#格式：" class="headerlink" title="格式："></a>格式：</h4>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select * from 表1,表2,表3….;</span><br></pre></td></tr></table></figure>
<h4 id="实现："><a href="#实现：" class="headerlink" title="实现："></a>实现：</h4>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">-- 交叉连接查询</span><br><span class="line">select * from dept3,emp3;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h4 id="结果："><a href="#结果：" class="headerlink" title="结果："></a>结果：</h4>
<p class='item-img' data-src='assets/1724030412027.png'><img src="assets/1724030412027.png" alt="72403041202"></p>
<h3 id="多表联合查询—内连接查询"><a href="#多表联合查询—内连接查询" class="headerlink" title="多表联合查询—内连接查询"></a>多表联合查询—内连接查询</h3>
<p>内连接查询求多张表的交集</p>
<h4 id="格式-5"><a href="#格式-5" class="headerlink" title="格式-5"></a>格式</h4>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">隐式内连接（SQL92标准）：select * from A,B where 条件; </span><br><span class="line">显示内连接（SQL99标准）：select * from A inner join B on 条件;</span><br></pre></td></tr></table></figure>
<h4 id="操作-10"><a href="#操作-10" class="headerlink" title="操作-10"></a>操作</h4>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">-- 查询每个部门的所属员工</span><br><span class="line">select * from dept3,emp3 where dept3.deptno = emp3.dept_id;</span><br><span class="line">select * from dept3 inner join emp3 on dept3.deptno = emp3.dept_id;</span><br><span class="line"></span><br><span class="line">-- 查询研发部和销售部的所属员工</span><br><span class="line">select * from dept3,emp3 where dept3.deptno = emp3.dept_id and name in( &#x27;研发部&#x27;,&#x27;销售部&#x27;);</span><br><span class="line">select * from dept3 join emp3 on dept3.deptno = emp3.dept_id and name in( &#x27;研发部&#x27;,&#x27;销售部&#x27;);</span><br><span class="line"> </span><br><span class="line">-- 查询每个部门的员工数,并升序排序</span><br><span class="line">select deptno,count(1) as total_cnt from dept3,emp3 where dept3.deptno = emp3.dept_id group by deptno order by total_cnt;</span><br><span class="line"> </span><br><span class="line">select deptno,count(1) as total_cnt from dept3 join emp3 on dept3.deptno = emp3.dept_id group by deptno order by total_cnt;</span><br><span class="line"></span><br><span class="line">-- 查询人数大于等于3的部门，并按照人数降序排序</span><br><span class="line">select deptno,count(1) as total_cnt from dept3,emp3 where dept3.deptno = emp3.dept_id group by deptno having total_cnt &gt;= 3 order by total_cnt desc;</span><br><span class="line"> </span><br><span class="line">select deptno,count(1) as total_cnt from dept3 join emp3 on dept3.deptno = emp3.dept_id group by deptno having total_cnt &gt;= 3 order by total_cnt desc;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="外连接查询"><a href="#外连接查询" class="headerlink" title="外连接查询"></a>外连接查询</h3>
<blockquote>
<ol>
<li>外连接分为左外连接（left outer join）、右外连接(right outer join)，满外连接(full outer join)。</li>
<li>注意：oracle里面有full join,可是在mysql对full join支持的不好。我们可以使用union来达到目的。</li>
</ol>
</blockquote>
<h4 id="格式-6"><a href="#格式-6" class="headerlink" title="格式-6"></a>格式</h4>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">左外连接：left outer join</span><br><span class="line">            select * from A left outer join B on 条件;</span><br><span class="line">  右外连接：right outer join</span><br><span class="line">            select * from A right outer join B on 条件;</span><br><span class="line">  满外连接: full outer join</span><br><span class="line">             select * from A full outer join B on 条件;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h4 id="操作-11"><a href="#操作-11" class="headerlink" title="操作-11"></a>操作</h4>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">-- 外连接查询</span><br><span class="line">-- 查询哪些部门有员工，哪些部门没有员工</span><br><span class="line">use mydb3;</span><br><span class="line">select * from dept3 left outer join emp3 on dept3.deptno = emp3.dept_id;</span><br><span class="line"> </span><br><span class="line">-- 查询哪些员工有对应的部门，哪些没有</span><br><span class="line">select * from dept3 right outer join emp3 on dept3.deptno = emp3.dept_id;</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">-- 使用union关键字实现左外连接和右外连接的并集（union后使用all代表不去重，不用代表去重）</span><br><span class="line">select * from dept3 left outer join emp3 on dept3.deptno = emp3.dept_id</span><br><span class="line">union </span><br><span class="line">select * from dept3 right outer join emp3 on dept3.deptno = emp3.dept_id;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="子查询"><a href="#子查询" class="headerlink" title="子查询"></a>子查询</h3>
<h4 id="介绍-8"><a href="#介绍-8" class="headerlink" title="介绍-8"></a>介绍</h4>
<blockquote>
<p>子查询就是指的在一个完整的查询语句之中，嵌套若干个不同功能的小查询，从而一起完成复杂查询的一种编写形式，通俗一点就是包含select嵌套的查询。</p>
</blockquote>
<h4 id="特点-3"><a href="#特点-3" class="headerlink" title="特点-3"></a>特点</h4>
<blockquote>
<p>子查询可以返回的数据类型一共分为四种：</p>
<ol>
<li>单行单列：返回的是一个具体列的内容，可以理解为一个单值数据；</li>
<li>单行多列：返回一行数据中多个列的内容；</li>
<li>多行单列：返回多行记录之中同一列的内容，相当于给出了一个操作范围；</li>
<li>多行多列：查询返回的结果是一张临时表</li>
</ol>
</blockquote>
<h4 id="操作-12"><a href="#操作-12" class="headerlink" title="操作-12"></a>操作</h4>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">-- 查询年龄最大的员工信息，显示信息包含员工号、员工名字，员工年龄</span><br><span class="line">-- 1：查询最大年龄：</span><br><span class="line">select max(age) from emp3;</span><br><span class="line">-- 2：让每一个员工的年龄和最大年龄进行比较，相等则满足条件(嵌套查询也称子查询)</span><br><span class="line">select eid,ename,age from emp3 where age = (select max(age) from emp3);  -- 单行单列，可以作为一个值来用</span><br><span class="line"> </span><br><span class="line">-- 查询年研发部和销售部的员工信息，包含员工号、员工名字</span><br><span class="line">-- 方式1-关联查询</span><br><span class="line">select * from dept3 a join emp3 b on a.deptno = b.dept_id and (name = &#x27;研发部&#x27; or name = &#x27;销售部&#x27;);</span><br><span class="line">-- 方式2-子查询</span><br><span class="line">-- 2.1 先查询研发部和销售部的部门号：deptno 1001 和 1002</span><br><span class="line">select deptno from dept3 where name = &#x27;研发部&#x27; or name = &#x27;销售部&#x27;;</span><br><span class="line">-- 2.2 查询哪个员工的部门号是1001 或者 1002</span><br><span class="line">select * from emp3 where dept_id in (select deptno from dept3 where name = &#x27;研发部&#x27; or name = &#x27;销售部&#x27;);  -- 多行单列，多个值</span><br><span class="line"> </span><br><span class="line">-- 查询研发部20岁以下的员工信息,包括员工号、员工名字，部门名字</span><br><span class="line">-- 方式1-关联查询</span><br><span class="line">select * from dept3 a join emp3 b on a.deptno = b.dept_id and (name = &#x27;研发部&#x27; and age &lt; 20);</span><br><span class="line">-- 方式2-子查询</span><br><span class="line">-- 2.1 在部门表中查询研发部信息</span><br><span class="line">select * from dept3 where name = &#x27;研发部&#x27;;  -- 单行多列</span><br><span class="line">-- 2.2 在员工表中查询年龄小于20岁的员工信息</span><br><span class="line">select * from emp3 where age &lt; 20;</span><br><span class="line">-- 2.3 将以上两个查询的结果进行关联查询</span><br><span class="line">select * from (select * from dept3 where name = &#x27;研发部&#x27;) t1 join (select * from emp3 where age &lt;20) t2 on t1.deptno = t2.dept_id;  -- 多行多列</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="子查询关键字"><a href="#子查询关键字" class="headerlink" title="子查询关键字"></a>子查询关键字</h3>
<h4 id="介绍-9"><a href="#介绍-9" class="headerlink" title="介绍-9"></a>介绍</h4>
<blockquote>
<p>在子查询中，有一些常用的逻辑关键字，这些关键字可以给我们提供更丰富的查询功能，主要关键字如下：</p>
<ol>
<li>ALL关键字</li>
<li>ANY关键字</li>
<li>SOME关键字</li>
<li>IN关键字</li>
<li>EXISTS关键字</li>
</ol>
</blockquote>
<h4 id="子查询关键字—ALL"><a href="#子查询关键字—ALL" class="headerlink" title="子查询关键字—ALL"></a>子查询关键字—ALL</h4>
<h5 id="格式-7"><a href="#格式-7" class="headerlink" title="格式-7"></a>格式</h5>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">select …from …where c &gt; all(查询语句)</span><br><span class="line">-- 等价于：</span><br><span class="line">select ...from ... where c &gt; result1 and c &gt; result2 and c &gt; result3</span><br></pre></td></tr></table></figure>
<h5 id="特点-4"><a href="#特点-4" class="headerlink" title="特点-4"></a>特点</h5>
<blockquote>
<ul>
<li>ALL: 与子查询返回的所有值比较为true则返回true</li>
<li>ALL可以与=、&gt;、&gt;=、&lt;、&lt;=、&lt;&gt;结合是来使用，分别表示等于、大于、大于等于、小于、小于等于、不等于其中的其中的所有数据。</li>
<li>ALL表示指定列中的值必须要大于子查询集的每一个值，即必须要大于子查询集的最大值；如果是小于号即小于子查询集的最小值。同理可以推出其它的比较运算符的情况。</li>
</ul>
</blockquote>
<h5 id="操作-13"><a href="#操作-13" class="headerlink" title="操作-13"></a>操作</h5>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">-- 1.查询年龄大于‘1003’部门所有年龄的员工信息</span><br><span class="line">select * from emp3 where age &gt; all(select age from emp3 where dept_id = &#x27;1003&#x27;);</span><br><span class="line">-- 2.查询不属于任何一个部门的员工信息</span><br><span class="line">select * from emp3 where dept_id != all(select deptno from dept3);</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h4 id="子查询关键字-ANY和SOME"><a href="#子查询关键字-ANY和SOME" class="headerlink" title="子查询关键字-ANY和SOME"></a>子查询关键字-ANY和SOME</h4>
<h5 id="格式-8"><a href="#格式-8" class="headerlink" title="格式-8"></a>格式</h5>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">select …from …where c &gt; any(查询语句)</span><br><span class="line">--等价于：</span><br><span class="line">select ...from ... where c &gt; result1 or c &gt; result2 or c &gt; result3</span><br></pre></td></tr></table></figure>
<h5 id="特点-5"><a href="#特点-5" class="headerlink" title="特点-5"></a>特点</h5>
<blockquote>
<ul>
<li>ANY:与子查询返回的任何值比较为true 则返回true</li>
<li>ANY可以与=、&gt;、&gt;=、&lt;、&lt;=、&lt;&gt;结合是来使用，分别表示等于、大于、大于等于、小于、小于等于、不等于其中的其中的任何一个数据。</li>
<li>表示制定列中的值要大于子查询中的任意一个值，即必须要大于子查询集中的最小值。同理可以推出其它的比较运算符的情况。</li>
<li>SOME和ANY的作用一样，SOME可以理解为ANY的别名</li>
</ul>
</blockquote>
<h5 id="操作-14"><a href="#操作-14" class="headerlink" title="操作-14"></a>操作</h5>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">-- 查询年龄大于‘1003’部门任意一个员工年龄的员工信息</span><br><span class="line">select * from emp3 where age &gt; any(select age from emp3 where dept_id = &#x27;1003&#x27;);  -- 去掉自己后面加：and dept_id != &#x27;1003&#x27;  即可。</span><br><span class="line">-- 使用some(和any用处一样)</span><br><span class="line">select * from emp3 where age &gt; some(select age from emp3 where dept_id = &#x27;1003&#x27;) and dept_id != &#x27;1003&#x27;;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h4 id="子查询关键字-IN"><a href="#子查询关键字-IN" class="headerlink" title="子查询关键字-IN"></a>子查询关键字-IN</h4>
<h5 id="格式-9"><a href="#格式-9" class="headerlink" title="格式-9"></a>格式</h5>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">select …from …where c in(查询语句)</span><br><span class="line">--等价于：</span><br><span class="line">select ...from ... where c = result1 or c = result2 or c = result3</span><br></pre></td></tr></table></figure>
<h5 id="特点-6"><a href="#特点-6" class="headerlink" title="特点-6"></a>特点</h5>
<blockquote>
<ul>
<li>IN关键字，用于判断某个记录的值，是否在指定的集合中</li>
<li>在IN关键字前边加上not可以将条件反过来</li>
</ul>
</blockquote>
<h5 id="操作-15"><a href="#操作-15" class="headerlink" title="操作-15"></a>操作</h5>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">-- 查询研发部和销售部的员工信息，包含员工号、员工名字</span><br><span class="line">select eid,ename from emp3 where dept_id in (select deptno from dept3 where name = &#x27;研发部&#x27; or name = &#x27;销售部&#x27;) ;</span><br></pre></td></tr></table></figure>
<h4 id="子查询关键字-EXISTS"><a href="#子查询关键字-EXISTS" class="headerlink" title="子查询关键字-EXISTS"></a>子查询关键字-EXISTS</h4>
<h5 id="格式-10"><a href="#格式-10" class="headerlink" title="格式-10"></a>格式</h5>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select …from …where exists(查询语句)</span><br></pre></td></tr></table></figure>
<h5 id="特点-7"><a href="#特点-7" class="headerlink" title="特点-7"></a>特点</h5>
<blockquote>
<ul>
<li>该子查询如果“有数据结果”(至少返回一行数据)， 则该EXISTS() 的结果为“true”，外层查询执行</li>
<li>该子查询如果“没有数据结果”（没有任何数据返回），则该EXISTS()的结果为“false”，外层查询不执行</li>
<li>EXISTS后面的子查询不返回任何实际数据，只返回真或假，当返回真时 where条件成立</li>
<li>注意，EXISTS关键字，比IN关键字的运算效率高，因此，在实际开发中，特别是大数据量时，推荐使用EXISTS关键字</li>
<li>有exists的时候是从外向内查询（在exists中判断），而其他的都是从内向外查询</li>
</ul>
</blockquote>
<h5 id="操作-16"><a href="#操作-16" class="headerlink" title="操作-16"></a>操作</h5>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">-- 查询公司是否有大于60岁的员工，有则输出</span><br><span class="line">select * from emp3 a where exists(select * from emp3 b where a.age &gt; 60);</span><br><span class="line">-- 也可以使用 in 替换 </span><br><span class="line">select * from emp3 a where eid in(select eid from emp3 b where a.age &gt; 60);</span><br><span class="line"></span><br><span class="line">-- 查询有所属部门的员工信息</span><br><span class="line">select * from emp3 a where exists(select * from dept3 b where a.dept_id = b.deptno);</span><br><span class="line">-- 也可以使用 in 替换 </span><br><span class="line">select * from emp3 a where dept_id in(select deptno from dept3 b where a.dept_id = b.deptno);</span><br></pre></td></tr></table></figure>
<h3 id="自关联查询"><a href="#自关联查询" class="headerlink" title="自关联查询"></a>自关联查询</h3>
<h4 id="概念-6"><a href="#概念-6" class="headerlink" title="概念-6"></a>概念</h4>
<blockquote>
<p>MySQL有时在信息查询时需要进行对表自身进行关联查询，即一张表自己和自己关联，一张表当成多张表来用。注意自关联时表必须给表起别名。</p>
</blockquote>
<h4 id="格式-11"><a href="#格式-11" class="headerlink" title="格式-11"></a>格式</h4>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">select 字段列表 from 表1 a , 表1 b where 条件;</span><br><span class="line">或者 </span><br><span class="line">select 字段列表 from 表1 a [left] join 表1 b on 条件;</span><br></pre></td></tr></table></figure>
<h4 id="操作-17"><a href="#操作-17" class="headerlink" title="操作-17"></a>操作</h4>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">-- 创建表,并建立自关联约束</span><br><span class="line">create table t_sanguo(</span><br><span class="line">    eid int primary key ,</span><br><span class="line">    ename varchar(20),</span><br><span class="line">    manager_id int,</span><br><span class="line"> foreign key (manager_id) references t_sanguo (eid)  -- 添加自关联约束</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">-- 添加数据 </span><br><span class="line">insert into t_sanguo values(1,&#x27;刘协&#x27;,NULL);</span><br><span class="line">insert into t_sanguo values(2,&#x27;刘备&#x27;,1);</span><br><span class="line">insert into t_sanguo values(3,&#x27;关羽&#x27;,2);</span><br><span class="line">insert into t_sanguo values(4,&#x27;张飞&#x27;,2);</span><br><span class="line">insert into t_sanguo values(5,&#x27;曹操&#x27;,1);</span><br><span class="line">insert into t_sanguo values(6,&#x27;许褚&#x27;,5);</span><br><span class="line">insert into t_sanguo values(7,&#x27;典韦&#x27;,5);</span><br><span class="line">insert into t_sanguo values(8,&#x27;孙权&#x27;,1);</span><br><span class="line">insert into t_sanguo values(9,&#x27;周瑜&#x27;,8);</span><br><span class="line">insert into t_sanguo values(10,&#x27;鲁肃&#x27;,8);</span><br><span class="line"> </span><br><span class="line">-- 进行关联查询</span><br><span class="line">-- 1.查询每个三国人物及他的上级信息，如:  关羽  刘备 </span><br><span class="line">select * from t_sanguo a, t_sanguo b where a.manager_id = b.eid;</span><br><span class="line">-- 也可以是（显示内连接查询）：</span><br><span class="line">select * from t_sanguo a join t_sanguo b on a.manager_id = b.eid;</span><br><span class="line"></span><br><span class="line">-- 2.查询所有人物及上级(左外连接➕自关联)</span><br><span class="line">select * from t_sanguo a left join t_sanguo b on a.manager_id = b.eid;</span><br><span class="line">-- 仅显示名字</span><br><span class="line">select a.ename,b.ename from t_sanguo a left join t_sanguo b on a.manager_id = b.eid;</span><br><span class="line"></span><br><span class="line">-- 3.查询所以人物、上级，上上级 比如：张飞  刘备  刘协</span><br><span class="line">select * from t_sanguo a left join t_sanguo b on a.manager_id = b.eid left join t_sanguo c on b.manager_id = c.eid;</span><br><span class="line">-- 仅显示名字</span><br><span class="line">select a.ename,b.ename,c.ename from t_sanguo a left join t_sanguo b on a.manager_id = b.eid left join t_sanguo c on b.manager_id = c.eid;</span><br></pre></td></tr></table></figure>
<h3 id="练习"><a href="#练习" class="headerlink" title="练习"></a>练习</h3>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br></pre></td><td class="code"><pre><span class="line">-- 创建test1数据库</span><br><span class="line">create database test1;</span><br><span class="line"></span><br><span class="line">-- 选择使用test1数据库</span><br><span class="line">use test1;</span><br><span class="line"></span><br><span class="line">-- 创建部门表</span><br><span class="line">create table dept (</span><br><span class="line">	deptno int primary key,   -- 部门编号</span><br><span class="line">	dname varchar(14),    -- 部门名称</span><br><span class="line">	loc varchar(13)   -- 部门地址</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">-- 插入数据（部门表）</span><br><span class="line">insert into dept values (10,&#x27;accounting&#x27;,&#x27;new york&#x27;);</span><br><span class="line">insert into dept values (20,&#x27;research&#x27;,&#x27;dallas&#x27;);</span><br><span class="line">insert into dept values (30,&#x27;sales&#x27;,&#x27;chicago&#x27;);</span><br><span class="line">insert into dept values (40,&#x27;operations&#x27;,&#x27;boston&#x27;);</span><br><span class="line"></span><br><span class="line">-- 创建员工表</span><br><span class="line">create table emp (</span><br><span class="line">	empno int primary key,  -- 员工编号</span><br><span class="line">	ename varchar(10),  -- 员工姓名</span><br><span class="line">	job varchar(9),  -- 员工工作</span><br><span class="line">	mgr int,  -- 员工直属领导编号</span><br><span class="line">	hiredate date,  -- 入职时间</span><br><span class="line">	sal double,  -- 工资</span><br><span class="line">	comm double,  -- 奖金</span><br><span class="line">	deptno int  -- 对应dept表的外键</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">-- 添加 部门 和 员工 之间的主外键关系</span><br><span class="line">alter table emp add constraint foreign key emp(deptno) references dept(deptno);</span><br><span class="line"></span><br><span class="line">-- 插入数据（员工表）</span><br><span class="line">insert into emp values(7369,&#x27;smith&#x27;,&#x27;clerk&#x27;,7902,&#x27;1980-12-17&#x27;,800,null,20);</span><br><span class="line">insert into emp values(7499,&#x27;allen&#x27;,&#x27;salesman&#x27;,7698,&#x27;1981-02-20&#x27;,1600,300,30);</span><br><span class="line">insert into emp values(7521,&#x27;ward&#x27;,&#x27;salesman&#x27;,7698,&#x27;1981-02-22&#x27;,1250,500,30);</span><br><span class="line">insert into emp values(7566,&#x27;jones&#x27;,&#x27;manager&#x27;,7839,&#x27;1981-04-02&#x27;,2975,null,20);</span><br><span class="line">insert into emp values(7654,&#x27;martin&#x27;,&#x27;salesman&#x27;,7698,&#x27;1981-09-28&#x27;,1250,1400,30);</span><br><span class="line">insert into emp values(7698,&#x27;blake&#x27;,&#x27;manager&#x27;,7839,&#x27;1981-05-01&#x27;,2850,null,30);</span><br><span class="line">insert into emp values(7782,&#x27;clark&#x27;,&#x27;manager&#x27;,7839,&#x27;1981-06-09&#x27;,2450,null,10);</span><br><span class="line">insert into emp values(7788,&#x27;scott&#x27;,&#x27;analyst&#x27;,7566,&#x27;1987-07-03&#x27;,3000,null,20);</span><br><span class="line">insert into emp values(7839,&#x27;king&#x27;,&#x27;president&#x27;,null,&#x27;1981-11-17&#x27;,5000,null,10);</span><br><span class="line">insert into emp values(7844,&#x27;turner&#x27;,&#x27;salesman&#x27;,7698,&#x27;1981-09-08&#x27;,1500,0,30);</span><br><span class="line">insert into emp values(7876,&#x27;adams&#x27;,&#x27;clerk&#x27;,7788,&#x27;1987-07-13&#x27;,1100,null,20);</span><br><span class="line">insert into emp values(7900,&#x27;james&#x27;,&#x27;clerk&#x27;,7698,&#x27;1981-12-03&#x27;,950,null,30);</span><br><span class="line">insert into emp values(7902,&#x27;ford&#x27;,&#x27;analyst&#x27;,7566,&#x27;1981-12-03&#x27;,3000,null,20);</span><br><span class="line">insert into emp values(7934,&#x27;miller&#x27;,&#x27;clerk&#x27;,7782,&#x27;1981-01-23&#x27;,1300,null,10);</span><br><span class="line"></span><br><span class="line">-- 创建工资等级表</span><br><span class="line">create table salgrade (</span><br><span class="line">	grade int,  -- 等级</span><br><span class="line">	losal double,  -- 最低工资</span><br><span class="line">	hisal double  -- 最高工资</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">-- 插入数据（工资等级表）</span><br><span class="line">insert into salgrade values (1,700,1200);</span><br><span class="line">insert into salgrade values (2,1201,1400);</span><br><span class="line">insert into salgrade values (3,1401,2000);</span><br><span class="line">insert into salgrade values (4,2001,3000);</span><br><span class="line">insert into salgrade values (5,3001,9999);</span><br><span class="line"></span><br><span class="line">-- 练习：</span><br><span class="line">-- 1、返回拥有员工的部门名、部门号。</span><br><span class="line">select distinct d.dname,d.deptno from dept d join emp e on d.deptno = e.deptno;</span><br><span class="line"></span><br><span class="line">-- 2、工资水平多于smith的员工信息。</span><br><span class="line">select * from emp where sal &gt; all(select sal from emp where ename = &#x27;smith&#x27;);</span><br><span class="line"></span><br><span class="line">-- 3、返回员工和所属经理的姓名。</span><br><span class="line">select a.ename,b.ename from emp a join emp b on a.mgr = b.empno;</span><br><span class="line"></span><br><span class="line">-- 4、返回雇员的雇佣日期早于其经理雇佣日期的员工及其经理姓名。</span><br><span class="line">select a.ename,a.hiredate,b.ename,b.hiredate from emp a join emp b on a.mgr = b.empno and a.hiredate &lt; b.hiredate;</span><br><span class="line"></span><br><span class="line">-- 5、返回员工姓名及其所在的部门名称。</span><br><span class="line">select a.ename,b.dname from emp a join dept b on a.deptno = b.deptno;</span><br><span class="line"></span><br><span class="line">-- 6、返回从事clerk工作的员工姓名和所在部门名称。</span><br><span class="line">select a.ename,b.dname,a.job from emp a join dept b on a.deptno = b.deptno and job = &#x27;clerk&#x27;;</span><br><span class="line"></span><br><span class="line">-- 7、返回部门号及其本部门的最低工资。</span><br><span class="line">select deptno,min(sal) from emp group by deptno;</span><br><span class="line"></span><br><span class="line">-- 8、返回销售部(sales)所有员工的姓名。</span><br><span class="line">select a.ename from emp a join dept b on a.deptno = b.deptno and b.dname = &#x27;sales&#x27;;</span><br><span class="line"></span><br><span class="line">-- 9、返回工资水平多于平均工资的员工。</span><br><span class="line">select * from emp where sal &gt; (select avg(sal) from emp);</span><br><span class="line"></span><br><span class="line">-- 10、返回与scott从事相同工作的员工。</span><br><span class="line">select * from emp where job = (select job from emp where ename = &#x27;scott&#x27;) and ename != &#x27;scott&#x27;;  -- and 以后是为了去掉自己</span><br><span class="line"></span><br><span class="line">-- 11、返回与30部门员工工资水平相同的员工姓名与工资。</span><br><span class="line">select * from emp where sal &gt; all(select sal from emp where deptno = 30);</span><br><span class="line"></span><br><span class="line">-- 12、返回员工工作及其从事此工作的最低工资。</span><br><span class="line">select job,min(sal) from emp group by job;</span><br><span class="line"></span><br><span class="line">-- 13、计算出员工的年薪，并且以年薪排序。</span><br><span class="line">select *,(sal * 12 + ifnull(comm,0)) year_sal from emp order by year_sal desc;</span><br><span class="line"></span><br><span class="line">-- 14、返回工资处于第四级别的员工的姓名。</span><br><span class="line">select * from emp where sal between (select losal from salgrade where grade = 4) and (select hisal from salgrade where grade = 4);</span><br><span class="line"></span><br><span class="line">-- 15、返回工资为二等级的职员名字、部门所在地。（select 后面可以按照题目写： c.grade,b.ename,a.loc）</span><br><span class="line">-- 显示内连接</span><br><span class="line">select * from dept a join emp b on a.deptno = b.deptno join salgrade c on c.grade = 2 and b.sal between c.losal and c.hisal;</span><br><span class="line">-- 隐式内连接</span><br><span class="line">select * from dept a,emp b,salgrade c where a.deptno = b.deptno and c.grade = 2 and b.sal between c.losal and c.hisal;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h2 id="MySQL函数"><a href="#MySQL函数" class="headerlink" title="MySQL函数"></a>MySQL函数</h2>
<h3 id="基本介绍-2"><a href="#基本介绍-2" class="headerlink" title="基本介绍-2"></a>基本介绍</h3>
<h4 id="概述"><a href="#概述" class="headerlink" title="概述"></a>概述</h4>
<blockquote>
<p>在MySQL中，为了提高代码重用性和隐藏实现细节，MySQL提供了很多函数。函数可以理解为别人封装好的模板代码。</p>
</blockquote>
<h4 id="分类-2"><a href="#分类-2" class="headerlink" title="分类-2"></a>分类</h4>
<blockquote>
<p>在MySQL中，函数非常多，主要可以分为以下几类:</p>
<ul>
<li>聚合函数</li>
<li>数学函数</li>
<li>字符串函数</li>
<li>日期函数</li>
<li>控制流函数</li>
<li>窗口函数</li>
</ul>
</blockquote>
<h3 id="聚合函数"><a href="#聚合函数" class="headerlink" title="聚合函数"></a>聚合函数</h3>
<h4 id="概述-2"><a href="#概述-2" class="headerlink" title="概述-2"></a>概述</h4>
<ul>
<li>在MySQL中，聚合函数主要由：count, sum, min, max, avg, 这些聚合函数我们之前都学过，不再重复。这里我们学习另外一个函数: <code>group_concat(）</code>，该函数用户实现行的合并。</li>
<li><code>group_concat()</code>函数首先根据group by指定的列进行分组，并且用分隔符分隔，将同一个分组中的值连接起来，返回一个字符串结果。</li>
</ul>
<h4 id="格式-12"><a href="#格式-12" class="headerlink" title="格式-12"></a>格式</h4>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">group_concat([distinct] 字段名 [order by 排序字段 asc/desc] [separator &#x27;分隔符&#x27;])</span><br></pre></td></tr></table></figure>
<blockquote>
<p>说明：</p>
<p>（1）使用distinct可以排除重复值；</p>
<p>（2）如果需要对结果中的值进行排序，可以使用order by子句；</p>
<p>（3）separator是一个字符串值，默认为逗号。</p>
</blockquote>
<h4 id="操作-18"><a href="#操作-18" class="headerlink" title="操作-18"></a>操作</h4>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">-- 创建并选择mydb4</span><br><span class="line">create database mydb4;</span><br><span class="line">use mydb4;</span><br><span class="line"> </span><br><span class="line"> -- 建表emp</span><br><span class="line">create table emp(</span><br><span class="line">    emp_id int primary key auto_increment comment &#x27;编号&#x27;,</span><br><span class="line">    emp_name char(20) not null default &#x27;&#x27; comment &#x27;姓名&#x27;,</span><br><span class="line">    salary decimal(10,2) not null default 0 comment &#x27;工资&#x27;,</span><br><span class="line">    department char(20) not null default &#x27;&#x27; comment &#x27;部门&#x27;</span><br><span class="line">);</span><br><span class="line"> </span><br><span class="line"> -- 插入数据</span><br><span class="line">insert into emp(emp_name,salary,department) </span><br><span class="line">values(&#x27;张晶晶&#x27;,5000,&#x27;财务部&#x27;),(&#x27;王飞飞&#x27;,5800,&#x27;财务部&#x27;),(&#x27;赵刚&#x27;,6200,&#x27;财务部&#x27;),(&#x27;刘小贝&#x27;,5700,&#x27;人事部&#x27;),</span><br><span class="line">(&#x27;王大鹏&#x27;,6700,&#x27;人事部&#x27;),(&#x27;张小斐&#x27;,5200,&#x27;人事部&#x27;),(&#x27;刘云云&#x27;,7500,&#x27;销售部&#x27;),(&#x27;刘云鹏&#x27;,7200,&#x27;销售部&#x27;),</span><br><span class="line">(&#x27;刘云鹏&#x27;,7800,&#x27;销售部&#x27;);</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">-- 将所有员工的名字合并成一行 </span><br><span class="line">select group_concat(emp_name) from emp;</span><br></pre></td></tr></table></figure>
<p class='item-img' data-src='assets/1727935527927.png'><img src="assets/1727935527927.png" alt="72793552792"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">-- 指定分隔符合并 </span><br><span class="line">select department,group_concat(emp_name separator &#x27;;&#x27; ) from emp group by department; </span><br></pre></td></tr></table></figure>
<p class='item-img' data-src='assets/1727935546016.png'><img src="assets/1727935546016.png" alt="72793554601"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">-- 指定排序方式和分隔符 </span><br><span class="line">select department,group_concat(emp_name order by salary desc separator &#x27;;&#x27; ) from emp group by department;</span><br></pre></td></tr></table></figure>
<p class='item-img' data-src='assets/1727935597678.png'><img src="assets/1727935597678.png" alt="72793559767"></p>
<h3 id="数学函数"><a href="#数学函数" class="headerlink" title="数学函数"></a>数学函数</h3>
<h4 id="函数名"><a href="#函数名" class="headerlink" title="函数名"></a>函数名</h4>
<p>由于表格行数有限，也为了方便查看，以下分为三张表来展示(加粗代表常用)：</p>
<table>
<thead>
<tr>
<th>函数名</th>
<th>描述</th>
<th>实例</th>
</tr>
</thead>
<tbody>
<tr>
<td>ABS(x)</td>
<td>返回 x 的绝对值</td>
<td>返回 -1 的绝对值：SELECT ABS(-1) – 返回1</td>
</tr>
<tr>
<td><strong>CEIL(x)</strong></td>
<td>返回大于或等于 x 的最小整数(向上取整)</td>
<td>SELECT CEIL(1.5) – 返回2</td>
</tr>
<tr>
<td><strong>FLOOR(x)</strong></td>
<td>返回小于或等于 x 的最大整数(向下取整)</td>
<td>小于或等于 1.5 的整数：SELECT FLOOR(1.5) – 返回1</td>
</tr>
<tr>
<td>GREATEST(expr1, expr2, expr3, …)</td>
<td>返回列表中的最大值</td>
<td>返回以下数字列表中的最大值：SELECT GREATEST(3, 12, 34, 8, 25); – 34返回以下字符串列表中的最大值：SELECT GREATEST(“Google”, “Runoob”, “Apple”);   – Runoob</td>
</tr>
<tr>
<td>LEAST(expr1, expr2, expr3, …)</td>
<td>返回列表中的最小值</td>
<td>返回以下数字列表中的最小值：SELECT LEAST(3, 12, 34, 8, 25); – 3返回以下字符串列表中的最小值：SELECT LEAST(“Google”, “Runoob”, “Apple”);   – Apple</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th>函数名</th>
<th>描述</th>
<th>实例</th>
</tr>
</thead>
<tbody>
<tr>
<td>MAX(expression)</td>
<td>返回字段 expression 中的最大值</td>
<td>返回数据表 Products 中字段 Price 的最大值：SELECT MAX(Price) AS LargestPrice FROM Products;</td>
</tr>
<tr>
<td>MIN(expression)</td>
<td>返回字段 expression 中的最小值</td>
<td>返回数据表 Products 中字段 Price 的最小值：SELECT MIN(Price) AS MinPrice FROM Products;</td>
</tr>
<tr>
<td><strong>MOD(x,y)</strong></td>
<td>返回 x 除以 y 以后的余数</td>
<td>5 除于 2 的余数：SELECT MOD(5,2) – 1</td>
</tr>
<tr>
<td>PI()</td>
<td>返回圆周率(3.141593）</td>
<td>SELECT PI() --3.141593</td>
</tr>
<tr>
<td>POW(x,y)</td>
<td>返回 x 的 y 次方</td>
<td>2 的 3 次方：SELECT POW(2,3) – 8</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th>函数名</th>
<th>描述</th>
<th>实例</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>RAND()</strong></td>
<td>返回 0 到 1 的随机数</td>
<td>SELECT RAND() --0.93099315644334</td>
</tr>
<tr>
<td>ROUND(x)</td>
<td>返回离 x 最近的整数（遵循四舍五入）</td>
<td>SELECT ROUND(1.23456) --1</td>
</tr>
<tr>
<td><strong>ROUND(x,y)</strong></td>
<td>返回指定位数的小数（遵循四舍五入）</td>
<td>SELECT ROUND(1.23456,3) –1.235</td>
</tr>
<tr>
<td>TRUNCATE(x,y)</td>
<td>返回数值 x 保留到小数点后 y 位的值（与 ROUND 最大的区别是不会进行四舍五入）</td>
<td>SELECT TRUNCATE(1.23456,3) – 1.234</td>
</tr>
</tbody>
</table>
<h4 id="操作-19"><a href="#操作-19" class="headerlink" title="操作-19"></a>操作</h4>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">-- 案例：通过数据库的函数，生成一个六位数的随机验证码。</span><br><span class="line">select lpad(round(rand()*1000000,0),6,&#x27;0&#x27;);</span><br><span class="line"></span><br><span class="line">-- 四舍五入平均价格，保留两位小数。</span><br><span class="line">use mydb2;</span><br><span class="line">select category_id,round(avg(price),2) from product group by category_id;</span><br></pre></td></tr></table></figure>
<h3 id="字符串函数"><a href="#字符串函数" class="headerlink" title="字符串函数"></a>字符串函数</h3>
<p>字符串等的位置：从1开始；索引：从0开始。两者都是描述位置的，但是计数起点不同。</p>
<h4 id="函数名-2"><a href="#函数名-2" class="headerlink" title="函数名-2"></a>函数名</h4>
<table>
<thead>
<tr>
<th>函数</th>
<th>描述</th>
<th>实例</th>
</tr>
</thead>
<tbody>
<tr>
<td>CHAR_LENGTH(s)</td>
<td>返回字符串 s 的字符数</td>
<td>返回字符串 RUNOOB 的字符数SELECT CHAR_LENGTH(“RUNOOB”) AS LengthOfString;</td>
</tr>
<tr>
<td>LENGTH(s)</td>
<td>返回字符串 s 的字节数</td>
<td>SELECT LENGTH(“明天”) AS LengthOfString;   – 6（utf-8 一个汉字为3个字节）</td>
</tr>
<tr>
<td>CHARACTER_LENGTH(s)</td>
<td>返回字符串 s 的字符数</td>
<td>返回字符串 RUNOOB 的字符数SELECT CHARACTER_LENGTH(“RUNOOB”) AS LengthOfString;</td>
</tr>
<tr>
<td>CONCAT(s1,s2…sn)</td>
<td>字符串 s1,s2 等多个字符串合并为一个字符串</td>
<td>合并多个字符串SELECT CONCAT(&quot;SQL &quot;, &quot;Runoob &quot;, &quot;Gooogle &quot;, “Facebook”) AS ConcatenatedString;</td>
</tr>
<tr>
<td><strong>CONCAT_WS(x, s1,s2…sn)</strong></td>
<td>同 CONCAT(s1,s2,…) 函数，但是每个字符串之间要加上 x，x 可以是分隔符</td>
<td>合并多个字符串，并添加分隔符：SELECT CONCAT_WS(“-”, “SQL”, “Tutorial”, “is”, “fun!”)AS ConcatenatedString;</td>
</tr>
<tr>
<td>FIELD(s,s1,s2…)</td>
<td>返回第一个字符串 s 在字符串列表(s1,s2…)中的位置</td>
<td>返回字符串 c 在列表值中的位置：SELECT FIELD(“c”, “a”, “b”, “c”, “d”, “e”,“c”);  后面重复的’c’就不会输出位置，只能输出第一个查到的‘c’</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th>函数</th>
<th>描述</th>
<th>实例</th>
</tr>
</thead>
<tbody>
<tr>
<td>LTRIM(s)</td>
<td>去掉字符串 s 开始处的空格</td>
<td>去掉字符串 RUNOOB开始处的空格：SELECT LTRIM(&quot;    RUNOOB&quot;) AS LeftTrimmedString;-- RUNOOB</td>
</tr>
<tr>
<td>RTRIM(s)</td>
<td>去掉字符串 s 结尾处的空格</td>
<td>去掉字符串 RUNOOB结尾处的空格：SELECT RTRIM(&quot;      RUNOOB    &quot;) AS LeftTrimmedString;-- RUNOOB</td>
</tr>
<tr>
<td><strong>MID(s,n,len)</strong></td>
<td>从字符串 s 的 n 位置截取长度为 len 的子字符串，同 SUBSTRING(s,n,len)</td>
<td>从字符串 RUNOOB 中的第 2 个位置截取 3个 字符：SELECT MID(“RUNOOB”, 2, 3) AS ExtractString; – UNO</td>
</tr>
<tr>
<td>POSITION(s1 IN s)</td>
<td>从字符串 s 中获取 s1 的开始位置</td>
<td>返回字符串 abc 中 b 的位置：SELECT POSITION(‘b’ in ‘abc’) – 2</td>
</tr>
<tr>
<td>REPLACE(s,s1,s2)</td>
<td>将字符串 s2 替代字符串 s 中的字符串 s1</td>
<td>将字符串 abc 中的字符 a 替换为字符 x：SELECT REPLACE(‘abca’,‘a’,‘x’) --xbcx</td>
</tr>
<tr>
<td>REVERSE(s)</td>
<td>将字符串s的顺序反过来</td>
<td>将字符串 abc 的顺序反过来：SELECT REVERSE(‘abc’) – cba</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th>函数</th>
<th>描述</th>
<th>实例</th>
</tr>
</thead>
<tbody>
<tr>
<td>LEFT(s,n)</td>
<td>返回字符串 s 的前 n 个字符</td>
<td>返回字符串 runoob 的前两个字符：SELECT left(‘runoob’,2) – ru</td>
</tr>
<tr>
<td>RIGHT(s,n)</td>
<td>返回字符串 s 的后 n 个字符</td>
<td>返回字符串 runoob 的后两个字符：SELECT RIGHT(‘runoob’,2) – ob</td>
</tr>
<tr>
<td>STRCMP(s1,s2)</td>
<td>比较字符串 s1 和 s2，如果 s1 与 s2 相等返回 0 ，如果 s1&gt;s2 返回 1，如果 s1&lt;s2 返回 -1</td>
<td>比较字符串：SELECT STRCMP(“runoob”, “runoob”);  – 0</td>
</tr>
<tr>
<td>SUBSTR(s, start, length)</td>
<td>从字符串 s 的 start 位置截取长度为 length 的子字符串</td>
<td>从字符串 RUNOOB 中的第 2 个位置截取 3个 字符：SELECT SUBSTR(“RUNOOB”, 2, 3) AS ExtractString; – UNO</td>
</tr>
<tr>
<td><strong>SUBSTRING(s, start, length)</strong></td>
<td>从字符串 s 的 start 位置截取长度为 length 的子字符串</td>
<td>从字符串 RUNOOB 中的第 2 个位置截取 3个 字符：SELECT SUBSTRING(“RUNOOB”, 2, 3) AS ExtractString; – UNO</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th>函数</th>
<th>描述</th>
<th>实例</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>TRIM(s)</strong></td>
<td>去掉字符串 s 开始和结尾处的空格</td>
<td>去掉字符串 RUNOOB 的首尾空格：SELECT TRIM(’    RUNOOB    ') AS TrimmedString;</td>
</tr>
<tr>
<td>UCASE(s)</td>
<td>将字符串转换为大写</td>
<td>将字符串 runoob 转换为大写：SELECT UCASE(“runoob”); – RUNOOB</td>
</tr>
<tr>
<td><strong>UPPER(s)</strong></td>
<td>将字符串转换为大写</td>
<td>将字符串 runoob 转换为大写：SELECT UPPER(“runoob”); – RUNOOB</td>
</tr>
<tr>
<td>LCASE(s)</td>
<td>将字符串 s 的所有字母变成小写字母</td>
<td>字符串 RUNOOB 转换为小写：SELECT LCASE(‘RUNOOB’) – runoob</td>
</tr>
<tr>
<td><strong>LOWER(s)</strong></td>
<td>将字符串 s 的所有字母变成小写字母</td>
<td>字符串 RUNOOB 转换为小写：SELECT LOWER(‘RUNOOB’) – runoob</td>
</tr>
<tr>
<td><strong>LPAD(str,n,pad)</strong></td>
<td>左填充，用字符串pad对str的左边进行填充，达到n个字符串长度</td>
<td>左填充：select lpad(‘01’,5,‘-’);</td>
</tr>
<tr>
<td><strong>RPAD(str,n,pad)</strong></td>
<td>右填充，用字符串pad对str的右边进行填充，达到n个字符串长度</td>
<td>右填充：select rpad(‘01’,5,‘-’);</td>
</tr>
</tbody>
</table>
<h4 id="操作-20"><a href="#操作-20" class="headerlink" title="操作-20"></a>操作</h4>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">-- 案例：由于业务需求变更，企业员工的工号，统一为5位数，目前不足5位数的全部在前面补0，比如：1号员工的工号应该为00001</span><br><span class="line">update emp set workno = lpad(&#x27;1&#x27;,5,&#x27;0&#x27;);</span><br></pre></td></tr></table></figure>
<h3 id="日期函数"><a href="#日期函数" class="headerlink" title="日期函数"></a>日期函数</h3>
<h4 id="函数名-3"><a href="#函数名-3" class="headerlink" title="函数名-3"></a>函数名</h4>
<table>
<thead>
<tr>
<th>函数名</th>
<th>描述</th>
<th>实例</th>
</tr>
</thead>
<tbody>
<tr>
<td>UNIX_TIMESTAMP()</td>
<td>返回从1970-01-01 00:00:00到当前毫秒值(时间戳)</td>
<td>select UNIX_TIMESTAMP() -&gt; 1632729059</td>
</tr>
<tr>
<td>UNIX_TIMESTAMP(DATE_STRING)</td>
<td>将制定日期转为毫秒值时间戳</td>
<td>SELECT UNIX_TIMESTAMP(‘2011-12-07 13:01:03’);</td>
</tr>
<tr>
<td>FROM_UNIXTIME(BIGINT UNIXTIME[, STRING FORMAT])</td>
<td>将毫秒值时间戳转为指定格式日期</td>
<td>SELECT FROM_UNIXTIME(1598079966,‘%Y-%m-%d %H:%i:%s’); (1598079966,‘%Y-%m-%d %H:%i:%s’); -&gt; 2020-08-22 15-06-06</td>
</tr>
<tr>
<td><strong>CURDATE()</strong></td>
<td>返回当前日期</td>
<td>SELECT CURDATE();-&gt; 2018-09-19</td>
</tr>
<tr>
<td>CURRENT_DATE()</td>
<td>返回当前日期</td>
<td>SELECT CURRENT_DATE();-&gt; 2018-09-19</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th>函数名</th>
<th>描述</th>
<th>实例</th>
</tr>
</thead>
<tbody>
<tr>
<td>CURRENT_TIME</td>
<td>返回当前时间</td>
<td>SELECT CURRENT_TIME();-&gt; 19:59:02</td>
</tr>
<tr>
<td><strong>CURTIME()</strong></td>
<td>返回当前时间</td>
<td>SELECT CURTIME();-&gt; 19:59:02</td>
</tr>
<tr>
<td>CURRENT_TIMESTAMP()</td>
<td>返回当前日期和时间</td>
<td>SELECT CURRENT_TIMESTAMP()-&gt; 2018-09-19 20:57:43</td>
</tr>
<tr>
<td>DATE()</td>
<td>从日期或日期时间表达式中提取日期值</td>
<td>SELECT DATE(“2017-06-15”);    -&gt; 2017-06-15</td>
</tr>
<tr>
<td><strong>DATEDIFF(d1,d2)</strong></td>
<td>计算日期 d1-&gt;d2 之间相隔的天数</td>
<td>SELECT DATEDIFF(‘2001-01-01’,‘2001-02-02’)-&gt; -32</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th>函数名</th>
<th>描述</th>
<th>实例</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>TIMEDIFF(time1, time2)</strong></td>
<td>计算时间差值</td>
<td>SELECT TIMEDIFF(“13:10:11”, “13:10:10”);-&gt; 00:00:01</td>
</tr>
<tr>
<td>DATE_FORMAT(d,f)</td>
<td>按表达式 f的要求显示日期 d</td>
<td>SELECT DATE_FORMAT(‘2011-11-11 11:11:11’,‘%Y-%m-%d %r’)-&gt; 2011-11-11 11:11:11 AM</td>
</tr>
<tr>
<td>STR_TO_DATE(string, format_mask)</td>
<td>将字符串转变为日期</td>
<td>SELECT STR_TO_DATE(“August 10 2017”, “%M %d %Y”);-&gt; 2017-08-10</td>
</tr>
<tr>
<td>DATE_SUB(date,INTERVAL expr type)</td>
<td>函数从日期减去指定的时间间隔。</td>
<td>Orders 表中 OrderDate 字段减去 2 天：SELECT OrderId,DATE_SUB(OrderDate,INTERVAL 2 DAY) AS OrderPayDate FROM Orders;</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th>函数名</th>
<th>描述</th>
<th>实例</th>
</tr>
</thead>
<tbody>
<tr>
<td>ADDDATE/DATE_ADD(d，INTERVAL expr type)</td>
<td>计算起始日期 d 加上一个时间段后的日期，type 值可以是：<br />MICROSECOND<br />SECOND<br />MINUTE<br />HOUR<br />DAY<br />WEEK<br />MONTH<br />QUARTER<br />YEAR<br />DAY_MINUTE<br />DAY_HOUR<br />YEAR_MONTH</td>
<td>SELECT DATE_ADD(“2017-06-15”, INTERVAL 10 DAY); -&gt; 2017-06-25<br /><br />SELECT DATE_ADD(“2017-06-15 09:34:21”, INTERVAL 15 MINUTE); -&gt; 2017-06-15 09:49:21<br /><br />SELECT DATE_ADD(“2017-06-15 09:34:21”, INTERVAL -3 HOUR); -&gt;2017-06-15 06:34:21<br /><br />SELECT DATE_ADD(“2017-06-15 09:34:21”, INTERVAL -3 HOUR); -&gt;2017-04-15</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th>函数名</th>
<th>描述</th>
<th>实例</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>DATE_ADD(d，INTERVAL expr type)</strong></td>
<td>计算起始日期 d 加上一个时间段后的日期，type 值可以是：<br />SECOND_MICROSECOND<br />MINUTE_MICROSECOND<br />MINUTE_SECOND<br />HOUR_MICROSECOND<br />HOUR_SECOND<br />HOUR_MINUTE<br />DAY_MICROSECOND<br />DAY_SECOND<br />DAY_MINUTE<br />DAY_HOUR<br />YEAR_MONTH</td>
<td>SELECT DATE_ADD(“2017-06-15”, INTERVAL 10 DAY);  -&gt; 2017-06-25<br /><br />SELECT DATE_ADD(“2017-06-15 09:34:21”, INTERVAL 15 MINUTE);  -&gt; 2017-06-15 09:49:21<br /><br />SELECT DATE_ADD(“2017-06-15 09:34:21”, INTERVAL -3 HOUR);  -&gt;2017-06-15 06:34:21<br /><br />SELECT DATE_ADD(“2017-06-15 09:34:21”, INTERVAL -3 HOUR);  -&gt;2017-04-15</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th></th>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>EXTRACT(type FROM d)</td>
<td>从日期 d 中获取指定的值，type 指定返回的值。type可取值为：MICROSECOND<br />SECOND<br />MINUTE<br />HOUR    ……</td>
<td>SELECT EXTRACT(MINUTE FROM ‘2011-11-11 11:11:11’) -&gt; 11</td>
</tr>
<tr>
<td>LAST_DAY(d)</td>
<td>返回给给定日期的那一月份的最后一天</td>
<td>SELECT LAST_DAY(“2017-06-20”);-&gt; 2017-06-30</td>
</tr>
<tr>
<td>MAKEDATE(year, day-of-year)</td>
<td>基于给定参数年份 year 和所在年中的天数序号 day-of-year 返回一个日期</td>
<td>SELECT MAKEDATE(2017, 3);-&gt; 2017-01-03</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th>函数名</th>
<th>描述</th>
<th>实例</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>YEAR(d)</strong></td>
<td>返回年份</td>
<td>SELECT YEAR(“2017-06-15”);-&gt; 2017</td>
</tr>
<tr>
<td><strong>MONTH(d)</strong></td>
<td>返回日期d中的月份值，1 到 12</td>
<td>SELECT MONTH(‘2011-11-11 11:11:11’)-&gt;11</td>
</tr>
<tr>
<td><strong>DAY(d)</strong></td>
<td>返回日期值 d 的日期部分</td>
<td>SELECT DAY(“2017-06-15”);  -&gt; 15</td>
</tr>
<tr>
<td>HOUR(t)</td>
<td>返回 t 中的小时值</td>
<td>SELECT HOUR(‘1:2:3’)-&gt; 1</td>
</tr>
<tr>
<td>MINUTE(t)</td>
<td>返回 t 中的分钟值</td>
<td>SELECT MINUTE(‘1:2:3’)-&gt; 2</td>
</tr>
<tr>
<td>SECOND(t)</td>
<td>返回 t 中的秒钟值</td>
<td>SELECT SECOND(‘1:2:3’)-&gt; 3</td>
</tr>
<tr>
<td>QUARTER(d)</td>
<td>返回日期d是第几季节，返回 1 到 4</td>
<td>SELECT QUARTER(‘2011-11-11 11:11:11’)-&gt; 4</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th>函数名</th>
<th>描述</th>
<th>实例</th>
</tr>
</thead>
<tbody>
<tr>
<td>MONTHNAME(d)</td>
<td>返回日期当中的月份名称，如 November</td>
<td>SELECT MONTHNAME(‘2011-11-11 11:11:11’)-&gt; November</td>
</tr>
<tr>
<td><strong>DAYNAME(d)</strong></td>
<td>返回日期 d 是星期几，如 Monday,Tuesday</td>
<td>SELECT DAYNAME(‘2011-11-11 11:11:11’)-&gt;Friday</td>
</tr>
<tr>
<td>DAYOFMONTH(d)</td>
<td>计算日期 d 是本月的第几天</td>
<td>SELECT DAYOFMONTH(‘2011-11-11 11:11:11’)-&gt;11</td>
</tr>
<tr>
<td>DAYOFWEEK(d)</td>
<td>日期 d 今天是星期几，1 星期日，2 星期一，以此类推</td>
<td>SELECT DAYOFWEEK(‘2011-11-11 11:11:11’)-&gt;6</td>
</tr>
<tr>
<td>DAYOFYEAR(d)</td>
<td>计算日期 d 是本年的第几天</td>
<td>SELECT DAYOFYEAR(‘2011-11-11 11:11:11’)-&gt;315</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th>函数名</th>
<th>描述</th>
<th>实例</th>
</tr>
</thead>
<tbody>
<tr>
<td>WEEK(d)</td>
<td>计算日期 d 是本年的第几个星期，范围是 0 到 53</td>
<td>SELECT WEEK(‘2011-11-11 11:11:11’)-&gt; 45</td>
</tr>
<tr>
<td>WEEKDAY(d)</td>
<td>日期 d 是星期几，0 表示星期一，1 表示星期二</td>
<td>SELECT WEEKDAY(“2017-06-15”);-&gt; 3</td>
</tr>
<tr>
<td>WEEKOFYEAR(d)</td>
<td>计算日期 d 是本年的第几个星期，范围是 0 到 53</td>
<td>SELECT WEEKOFYEAR(‘2011-11-11 11:11:11’)-&gt; 45</td>
</tr>
<tr>
<td>YEARWEEK(date, mode)</td>
<td>返回年份及第几周（0到53），mode 中 0 表示周天，1表示周一，以此类推</td>
<td>SELECT YEARWEEK(“2017-06-15”);-&gt; 201724</td>
</tr>
<tr>
<td><strong>NOW()</strong></td>
<td>返回当前日期和时间</td>
<td>SELECT NOW()-&gt; 2018-09-19 20:57:43</td>
</tr>
</tbody>
</table>
<h4 id="操作-21"><a href="#操作-21" class="headerlink" title="操作-21"></a>操作</h4>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">-- 案例：查询所有员工的入职天数，并根据入职天数倒序排序。</span><br><span class="line">select ename, datediff(curdate(), hiredate) hiredays from emp order by hiredays desc;</span><br></pre></td></tr></table></figure>
<h3 id="控制流函数"><a href="#控制流函数" class="headerlink" title="控制流函数"></a>控制流函数</h3>
<h4 id="if逻辑判断语句"><a href="#if逻辑判断语句" class="headerlink" title="if逻辑判断语句"></a>if逻辑判断语句</h4>
<table>
<thead>
<tr>
<th>格式</th>
<th>解释</th>
<th>案例</th>
</tr>
</thead>
<tbody>
<tr>
<td>IF(expr,v1,v2)</td>
<td>如果表达式 expr 成立，返回结果 v1；否则，返回结果 v2。</td>
<td>SELECT IF(1 &gt; 0,‘正确’,‘错误’)    -&gt;正确</td>
</tr>
<tr>
<td>IFNULL(v1,v2)</td>
<td>如果 v1 的值不为 NULL，则返回 v1，否则返回 v2。</td>
<td>SELECT IFNULL(null,‘Hello Word’)  -&gt;Hello Word</td>
</tr>
<tr>
<td>ISNULL(expression)</td>
<td>判断表达式是否为 NULL</td>
<td>SELECT ISNULL(NULL);  -&gt;1</td>
</tr>
<tr>
<td>NULLIF(expr1, expr2)</td>
<td>比较两个字符串，如果字符串 expr1 与 expr2 相等 返回 NULL，否则返回 expr1</td>
<td>SELECT NULLIF(25, 25);  -&gt;null</td>
</tr>
</tbody>
</table>
<h4 id="case-when语句"><a href="#case-when语句" class="headerlink" title="case-when语句"></a>case when语句</h4>
<table>
<thead>
<tr>
<th>格式</th>
<th>解释</th>
<th>操作</th>
</tr>
</thead>
<tbody>
<tr>
<td>CASE expression    <br />WHEN condition1 THEN result1    WHEN condition2 THEN result2   …    WHEN conditionN THEN resultN    <br />ELSE result<br />END</td>
<td>CASE 表示函数开始，END 表示函数结束。如果 condition1 成立，则返回 result1, 如果 condition2 成立，则返回 result2，当全部不成立则返回 result，而当有一个成立之后，后面的就不执行了。</td>
<td>select case 100 when 50 then ‘tom’ when 100 then ‘mary’else ‘tim’ end ;<br />select case when 1=2 then ‘tom’ when 2=2 then ‘mary’ else’tim’ end ;</td>
</tr>
</tbody>
</table>
<h5 id="案例"><a href="#案例" class="headerlink" title="案例"></a>案例</h5>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line">-- 案例1：</span><br><span class="line"></span><br><span class="line">use mydb4;</span><br><span class="line">-- 创建订单表</span><br><span class="line">create table orders(</span><br><span class="line">	oid int primary key,  -- 订单id</span><br><span class="line">	price double,  -- 订单价格</span><br><span class="line">	payType int  -- 支付类型(1:微信支付 2:支付宝支付 3:银行卡支付 4:其他)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">-- 插入数据</span><br><span class="line">insert into orders values(1,1200,1);</span><br><span class="line">insert into orders values(2,1000,2);</span><br><span class="line">insert into orders values(3,200,3);</span><br><span class="line">insert into orders values(4,3000,1);</span><br><span class="line">insert into orders values(5,1500,2);</span><br><span class="line"></span><br><span class="line">-- 操作</span><br><span class="line">-- 方式1</span><br><span class="line">select </span><br><span class="line">	*,</span><br><span class="line">	case payType </span><br><span class="line">		when 1 then &#x27;微信支付&#x27; </span><br><span class="line">		when 2 then &#x27;支付宝支付&#x27;</span><br><span class="line">		when 3 then &#x27;银行卡支付&#x27;</span><br><span class="line">		else </span><br><span class="line">			&#x27;其他支付方式&#x27; </span><br><span class="line">	end as payTypeStr</span><br><span class="line">from orders;</span><br><span class="line"></span><br><span class="line">-- 方式2</span><br><span class="line">select </span><br><span class="line">	*,</span><br><span class="line">	case  </span><br><span class="line">		when payType=1 then &#x27;微信支付&#x27; </span><br><span class="line">		when payType=2 then &#x27;支付宝支付&#x27;</span><br><span class="line">		when payType=3 then &#x27;银行卡支付&#x27;</span><br><span class="line">		else </span><br><span class="line">			&#x27;其他支付方式&#x27; </span><br><span class="line">	end as payTypeStr</span><br><span class="line">from orders;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">-- 案例2：统计班级各个学员的成绩，展示的规则如下：</span><br><span class="line">-- &gt;= 85，展示优秀</span><br><span class="line">-- &gt;= 60，展示及格</span><br><span class="line">-- 否则，展示不及格</span><br><span class="line"></span><br><span class="line">use mydb4;</span><br><span class="line"></span><br><span class="line">-- 创建表并插入数据</span><br><span class="line">create table score(</span><br><span class="line">	id int comment &#x27;ID&#x27;,</span><br><span class="line">	name varchar(20) comment &#x27;姓名&#x27;,</span><br><span class="line">	math int comment &#x27;数学&#x27;,</span><br><span class="line">	english int comment &#x27;英语&#x27;,</span><br><span class="line">	chinese int comment &#x27;语文&#x27;</span><br><span class="line">) comment &#x27;学员成绩表&#x27;;</span><br><span class="line"></span><br><span class="line">insert into score(id,name,math,english,chinese) values(1,&#x27;Tom&#x27;,67,88,95),(2,&#x27;Rose&#x27;,23,66,90),(3,&#x27;Jack&#x27;,56,98,76);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">-- 操作</span><br><span class="line">select </span><br><span class="line">	id,</span><br><span class="line">	name,</span><br><span class="line">	case when math &gt;= 85 then &#x27;优秀&#x27; when math &gt;=60 then &#x27;及格&#x27; else &#x27;不及格&#x27; end &#x27;数学&#x27;,</span><br><span class="line">	case when english &gt;= 85 then &#x27;优秀&#x27; when english &gt;=60 then &#x27;及格&#x27; else &#x27;不及格&#x27; end &#x27;英语&#x27;,</span><br><span class="line">	case when chinese &gt;= 85 then &#x27;优秀&#x27; when chinese &gt;=60 then &#x27;及格&#x27; else &#x27;不及格&#x27; end &#x27;语文&#x27;</span><br><span class="line">from score;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="窗口函数"><a href="#窗口函数" class="headerlink" title="窗口函数"></a>窗口函数</h3>
<h4 id="介绍-10"><a href="#介绍-10" class="headerlink" title="介绍-10"></a>介绍</h4>
<blockquote>
<ul>
<li><strong>MySQL 8.0 新增窗口函数</strong> ,窗口函数又被称为开窗函数，与Oracle 窗口函数类似，属于MySQL的一大特点。</li>
<li>非聚合窗口函数是相对于聚函数来说的。聚合函数是对一组数据计算后返回单个值（即分组），非聚合函数一次只会处理一行数据。窗口聚合函数在行记录上计算某个字段的结果时，可将窗口范围内的数据输入到聚合函数中，并不改变行数。</li>
</ul>
</blockquote>
<p class='item-img' data-src='assets/1728290697257.png'><img src="assets/1728290697257.png" alt="72829069725"></p>
<h4 id="分类-3"><a href="#分类-3" class="headerlink" title="分类-3"></a>分类</h4>
<p class='item-img' data-src='assets/1728290736332.png'><img src="assets/1728290736332.png" alt="72829073633"></p>
<p><strong>另外还有开窗聚合函数:</strong> <code>SUM</code>,<code>AVG</code>,<code>MIN</code>,<code>MAX</code></p>
<h4 id="语法结构"><a href="#语法结构" class="headerlink" title="语法结构"></a>语法结构</h4>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">window_function ( expr ) OVER ( </span><br><span class="line">  PARTITION BY ... </span><br><span class="line">  ORDER BY ... </span><br><span class="line">  frame_clause </span><br><span class="line">)</span><br></pre></td></tr></table></figure>
<blockquote>
<p>其中，window_function 是窗口函数的名称；expr 是参数，有些函数不需要参数；OVER子句包含三个选项：</p>
<blockquote>
<ul>
<li><strong>分区（PARTITION BY）:</strong></li>
</ul>
<p>PARTITION BY选项用于将数据行拆分成多个分区（组），它的作用类似于GROUP BY分组。如果省略了 PARTITION BY，所有的数据作为一个组进行计算</p>
<ul>
<li><strong>排序（ORDER BY）:</strong></li>
</ul>
<p>OVER 子句中的ORDER BY选项用于指定分区内的排序方式，与 ORDER BY 子句的作用类似</p>
<ul>
<li><strong>以及窗口大小（frame_clause）:</strong></li>
</ul>
<p>frame_clause选项用于在当前分区内指定一个计算窗口，也就是一个与当前行相关的数据子集。</p>
</blockquote>
</blockquote>
<h4 id="序号函数"><a href="#序号函数" class="headerlink" title="序号函数"></a>序号函数</h4>
<p>序号函数有三个：ROW_NUMBER()、RANK()、DENSE_RANK()，可以用来实现分组排序，并添加序号。</p>
<h5 id="格式-13"><a href="#格式-13" class="headerlink" title="格式-13"></a>格式</h5>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">row_number()|rank()|dense_rank() over ( </span><br><span class="line">  partition by ... </span><br><span class="line">  order by ... </span><br><span class="line">) </span><br></pre></td></tr></table></figure>
<h5 id="操作-22"><a href="#操作-22" class="headerlink" title="操作-22"></a>操作</h5>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">use mydb4; </span><br><span class="line">create table employee( </span><br><span class="line">   dname varchar(20), -- 部门名 </span><br><span class="line">   eid varchar(20), </span><br><span class="line">   ename varchar(20), </span><br><span class="line">   hiredate date, -- 入职日期 </span><br><span class="line">   salary double -- 薪资</span><br><span class="line">); </span><br><span class="line"></span><br><span class="line">-- 插入数据</span><br><span class="line">insert into employee values(&#x27;研发部&#x27;,&#x27;1001&#x27;,&#x27;刘备&#x27;,&#x27;2021-11-01&#x27;,3000);</span><br><span class="line">insert into employee values(&#x27;研发部&#x27;,&#x27;1002&#x27;,&#x27;关羽&#x27;,&#x27;2021-11-02&#x27;,5000);</span><br><span class="line">insert into employee values(&#x27;研发部&#x27;,&#x27;1003&#x27;,&#x27;张飞&#x27;,&#x27;2021-11-03&#x27;,7000);</span><br><span class="line">insert into employee values(&#x27;研发部&#x27;,&#x27;1004&#x27;,&#x27;赵云&#x27;,&#x27;2021-11-04&#x27;,7000);</span><br><span class="line">insert into employee values(&#x27;研发部&#x27;,&#x27;1005&#x27;,&#x27;马超&#x27;,&#x27;2021-11-05&#x27;,4000);</span><br><span class="line">insert into employee values(&#x27;研发部&#x27;,&#x27;1006&#x27;,&#x27;黄忠&#x27;,&#x27;2021-11-06&#x27;,4000);</span><br><span class="line"> </span><br><span class="line">insert into employee values(&#x27;销售部&#x27;,&#x27;1007&#x27;,&#x27;曹操&#x27;,&#x27;2021-11-01&#x27;,2000);</span><br><span class="line">insert into employee values(&#x27;销售部&#x27;,&#x27;1008&#x27;,&#x27;许褚&#x27;,&#x27;2021-11-02&#x27;,3000);</span><br><span class="line">insert into employee values(&#x27;销售部&#x27;,&#x27;1009&#x27;,&#x27;典韦&#x27;,&#x27;2021-11-03&#x27;,5000);</span><br><span class="line">insert into employee values(&#x27;销售部&#x27;,&#x27;1010&#x27;,&#x27;张辽&#x27;,&#x27;2021-11-04&#x27;,6000);</span><br><span class="line">insert into employee values(&#x27;销售部&#x27;,&#x27;1011&#x27;,&#x27;徐晃&#x27;,&#x27;2021-11-05&#x27;,9000);</span><br><span class="line">insert into employee values(&#x27;销售部&#x27;,&#x27;1012&#x27;,&#x27;曹洪&#x27;,&#x27;2021-11-06&#x27;,6000);</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p><code>row_number()</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">-- 对每个部门的员工按照薪资降序排序，并给出排名</span><br><span class="line">select </span><br><span class="line">dname,</span><br><span class="line">ename,</span><br><span class="line">salary,</span><br><span class="line">row_number() over(partition by dname order by salary desc) as rn </span><br><span class="line">from employee;</span><br></pre></td></tr></table></figure>
<p class='item-img' data-src='assets/1728294250007.png'><img src="assets/1728294250007.png" alt="72829425000"></p>
<p><code>rank()</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">-- 对每个部门的员工按照薪资排序，并给出排名 rank</span><br><span class="line">select </span><br><span class="line">dname,</span><br><span class="line">ename,</span><br><span class="line">salary,</span><br><span class="line">rank() over(partition by dname order by salary desc) as rn </span><br><span class="line">from employee;</span><br></pre></td></tr></table></figure>
<p class='item-img' data-src='assets/1728294484066.png'><img src="assets/1728294484066.png" alt="72829448406"></p>
<p><code>dense_rank()</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">-- 对每个部门的员工按照薪资排序，并给出排名 dense-rank</span><br><span class="line">select </span><br><span class="line">dname,</span><br><span class="line">ename,</span><br><span class="line">salary,</span><br><span class="line">dense_rank() over(partition by dname order by salary desc) as rn </span><br><span class="line">from employee;</span><br></pre></td></tr></table></figure>
<p class='item-img' data-src='assets/1728294563192.png'><img src="assets/1728294563192.png" alt="72829456319"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">--求出每个部门薪资排在前三名的员工- 分组求TOPN</span><br><span class="line">select </span><br><span class="line">* </span><br><span class="line">from </span><br><span class="line">(</span><br><span class="line">    select </span><br><span class="line">     dname,</span><br><span class="line">     ename,</span><br><span class="line">     salary,</span><br><span class="line">     dense_rank() over(partition by dname order by salary desc)  as rn</span><br><span class="line">    from employee</span><br><span class="line">)t</span><br><span class="line">where t.rn &lt;= 3</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p class='item-img' data-src='assets/1728297383059.png'><img src="assets/1728297383059.png" alt="72829738305"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">-- 对所有员工进行全局排序（不分组）</span><br><span class="line">-- 不加partition by表示全局排序</span><br><span class="line">select </span><br><span class="line">     dname,</span><br><span class="line">     ename,</span><br><span class="line">     salary,</span><br><span class="line">     dense_rank() over( order by salary desc)  as rn</span><br><span class="line">from employee;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p class='item-img' data-src='assets/1728297539439.png'><img src="assets/1728297539439.png" alt="72829753943"></p>
<h4 id="开窗聚合函数-SUM-AVG-MIN-MAX"><a href="#开窗聚合函数-SUM-AVG-MIN-MAX" class="headerlink" title="开窗聚合函数-SUM-AVG-MIN-MAX"></a>开窗聚合函数- SUM,AVG,MIN,MAX</h4>
<h5 id="概念-7"><a href="#概念-7" class="headerlink" title="概念-7"></a>概念</h5>
<p>在窗口中每条记录动态地应用聚合函数（SUM()、AVG()、MAX()、MIN()、COUNT()），可以动态计算在指定的窗口内的各种聚合函数值。</p>
<h5 id="操作-23"><a href="#操作-23" class="headerlink" title="操作-23"></a>操作</h5>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">-- 开窗聚合函数</span><br><span class="line"></span><br><span class="line">select  </span><br><span class="line"> dname,</span><br><span class="line"> ename,</span><br><span class="line"> salary,</span><br><span class="line"> sum(salary) over(partition by dname order by hiredate) as pv1 </span><br><span class="line">from employee;</span><br><span class="line"> </span><br><span class="line">select </span><br><span class="line"> dname,</span><br><span class="line"> ename,</span><br><span class="line"> salary,</span><br><span class="line"> sum(salary) over(partition by dname) as pv3</span><br><span class="line">from employee;  -- 如果没有order  by排序语句  默认把分组内的所有数据进行sum操作</span><br><span class="line"></span><br><span class="line">select  </span><br><span class="line"> dname,</span><br><span class="line"> ename,</span><br><span class="line"> salary,</span><br><span class="line"> sum(salary) over(partition by dname order by hiredate  rows between unbounded preceding and current row) as c1 </span><br><span class="line">from employee;    -- rows代表行，between从哪里到哪里，unbounded preceding代表 从开头 开始 到当前行current row 结束</span><br><span class="line"> </span><br><span class="line">select  </span><br><span class="line"> dname,</span><br><span class="line"> ename,</span><br><span class="line"> salary,</span><br><span class="line"> sum(salary) over(partition by dname order by hiredate   rows between 3 preceding and current row) as c1 </span><br><span class="line">from employee;   -- rows代表行，between从哪里到哪里，3 preceding代表 从当前行向上三行 开始 到当前行current row 结束</span><br><span class="line"></span><br><span class="line">select  </span><br><span class="line"> dname,</span><br><span class="line"> ename,</span><br><span class="line"> salary,</span><br><span class="line"> sum(salary) over(partition by dname order by hiredate   rows between 3 preceding and 1 following) as c1 </span><br><span class="line">from employee; -- rows代表行，between从哪里到哪里，3 preceding代表 从当前行向上三行 开始 到当前行下一行 1 following 结束</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">select  </span><br><span class="line"> dname,</span><br><span class="line"> ename,</span><br><span class="line"> salary,</span><br><span class="line"> sum(salary) over(partition by dname order by hiredate   rows between current row and unbounded following) as c1 </span><br><span class="line">from employee;    -- rows代表行，between从哪里到哪里，current row代表 从当前行 开始 到最后 unbounded following 结束</span><br><span class="line"> </span><br></pre></td></tr></table></figure>
<h4 id="分布函数-CUME-DIST"><a href="#分布函数-CUME-DIST" class="headerlink" title="分布函数-CUME-DIST"></a>分布函数-(CUME_DIST)</h4>
<h5 id="介绍-11"><a href="#介绍-11" class="headerlink" title="介绍-11"></a>介绍</h5>
<blockquote>
<ul>
<li>用途：分组内小于、等于当前rank值的行数 / 分组内总行数</li>
<li>应用场景：查询小于等于当前薪资（salary）的比例</li>
</ul>
</blockquote>
<h5 id="操作-24"><a href="#操作-24" class="headerlink" title="操作-24"></a>操作</h5>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">select  </span><br><span class="line"> dname,</span><br><span class="line"> ename,</span><br><span class="line"> salary,</span><br><span class="line"> cume_dist() over(order by salary) as rn1, -- 没有partition语句 所有的数据位于一组</span><br><span class="line"> cume_dist() over(partition by dname order by salary) as rn2 </span><br><span class="line">from employee;</span><br><span class="line"></span><br><span class="line">/*</span><br><span class="line">rn1: 没有partition,所有数据均为1组，总行数为12，</span><br><span class="line">     第一行：小于等于3000的行数为3，因此，3/12=0.25</span><br><span class="line">     第二行：小于等于4000的行数为5，因此，5/12=0.4166666666666667</span><br><span class="line">rn2: 按照部门分组，dname=&#x27;研发部&#x27;的行数为6,</span><br><span class="line">     第一行：研发部小于等于3000的行数为1，因此，1/6=0.16666666666666666</span><br><span class="line">*/</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p class='item-img' data-src='assets/1728547134931.png'><img src="assets/1728547134931.png" alt="72854713493"></p>
<h4 id="分布函数-PERCENT-RANK"><a href="#分布函数-PERCENT-RANK" class="headerlink" title="分布函数-PERCENT-RANK"></a>分布函数-(PERCENT_RANK)</h4>
<h5 id="介绍-12"><a href="#介绍-12" class="headerlink" title="介绍-12"></a>介绍</h5>
<blockquote>
<ul>
<li>用途：每行按照公式(rank-1) / (rows-1)进行计算。其中，rank为RANK()函数产生的序号，rows为当前窗口的记录总行数；</li>
<li>应用场景：不常用。</li>
</ul>
</blockquote>
<h5 id="操作-25"><a href="#操作-25" class="headerlink" title="操作-25"></a>操作</h5>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">select </span><br><span class="line"> dname,</span><br><span class="line"> ename,</span><br><span class="line"> salary,</span><br><span class="line"> rank() over(partition by dname order by salary desc ) as rn,</span><br><span class="line"> percent_rank() over(partition by dname order by salary desc ) as rn2</span><br><span class="line">from employee;</span><br><span class="line"></span><br><span class="line">/*</span><br><span class="line"> rn2:</span><br><span class="line">  第一行: (1 - 1) / (6 - 1) = 0</span><br><span class="line">  第二行: (1 - 1) / (6 - 1) = 0</span><br><span class="line">  第三行: (3 - 1) / (6 - 1) = 0.4</span><br><span class="line">*/</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p class='item-img' data-src='assets/1728547548943.png'><img src="assets/1728547548943.png" alt="72854754894"></p>
<h4 id="前后函数-LAG和LEAD"><a href="#前后函数-LAG和LEAD" class="headerlink" title="前后函数-LAG和LEAD"></a>前后函数-LAG和LEAD</h4>
<h5 id="介绍-13"><a href="#介绍-13" class="headerlink" title="介绍-13"></a>介绍</h5>
<blockquote>
<ul>
<li>用途：返回位于当前行的前n行（LAG(expr,n)）或后n行（LEAD(expr,n)）的expr的值</li>
<li>应用场景：查询前1名同学的成绩和当前同学成绩的差值</li>
</ul>
</blockquote>
<h5 id="操作-26"><a href="#操作-26" class="headerlink" title="操作-26"></a>操作</h5>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">-- lag的用法</span><br><span class="line">select </span><br><span class="line"> dname,</span><br><span class="line"> ename,</span><br><span class="line"> salary,</span><br><span class="line"> hiredate,</span><br><span class="line"> lag(hiredate,1,&#x27;2000-01-01&#x27;) over(partition by dname order by hiredate) as last_1_time,</span><br><span class="line"> lag(hiredate,2) over(partition by dname order by hiredate) as last_2_time </span><br><span class="line">from employee;</span><br><span class="line"></span><br><span class="line">/*</span><br><span class="line">last_1_time: 指定了往上第1行的值，default为&#x27;2000-01-01&#x27;  </span><br><span class="line">                         第一行，往上1行为null,因此取默认值 &#x27;2000-01-01&#x27;</span><br><span class="line">                         第二行，往上1行值为第一行值，2021-11-01 </span><br><span class="line">                         第三行，往上1行值为第二行值，2021-11-02 </span><br><span class="line">last_2_time: 指定了往上第2行的值，为指定默认值</span><br><span class="line">                         第一行，往上2行为null</span><br><span class="line">                         第二行，往上2行为null</span><br><span class="line">                         第四行，往上2行为第二行值，2021-11-01 </span><br><span class="line">                         第七行，往上2行为第五行值，2021-11-02 </span><br><span class="line">*/</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">-- lead的用法</span><br><span class="line">select </span><br><span class="line"> dname,</span><br><span class="line"> ename,</span><br><span class="line"> salary,</span><br><span class="line"> hiredate,</span><br><span class="line"> lead(hiredate,1,&#x27;2000-01-01&#x27;) over(partition by dname order by hiredate) as last_1_time,</span><br><span class="line"> lead(hiredate,2) over(partition by dname order by hiredate) as last_2_time </span><br><span class="line">from employee;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>LAG(expr,n)：</p>
<p class='item-img' data-src='assets/1728548447438.png'><img src="assets/1728548447438.png" alt="72854844743"></p>
<p>LEAD(expr,n)：</p>
<p class='item-img' data-src='assets/1728548647234.png'><img src="assets/1728548647234.png" alt="72854864723"></p>
<h4 id="头尾函数-FIRST-VALUE和LAST-VALUE"><a href="#头尾函数-FIRST-VALUE和LAST-VALUE" class="headerlink" title="头尾函数-FIRST-VALUE和LAST-VALUE"></a>头尾函数-FIRST_VALUE和LAST_VALUE</h4>
<h5 id="介绍-14"><a href="#介绍-14" class="headerlink" title="介绍-14"></a>介绍</h5>
<p>用途：返回第一个（FIRST_VALUE(expr)）或最后一个（LAST_VALUE(expr)）expr的值</p>
<p>应用场景：截止到当前，按照日期排序查询第1个入职和最后1个入职员工的薪资</p>
<h5 id="操作-27"><a href="#操作-27" class="headerlink" title="操作-27"></a>操作</h5>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">-- 注意,  如果不指定ORDER BY，则进行排序混乱，会出现错误的结果</span><br><span class="line">select</span><br><span class="line">  dname,</span><br><span class="line">  ename,</span><br><span class="line">  hiredate,</span><br><span class="line">  salary,</span><br><span class="line">  first_value(salary) over(partition by dname order by hiredate) as first,</span><br><span class="line">  last_value(salary) over(partition by dname order by  hiredate) as last </span><br><span class="line">from  employee;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p class='item-img' data-src='assets/1728549344799.png'><img src="assets/1728549344799.png" alt="72854934479"></p>
<h4 id="其他函数-NTH-VALUE-expr-n-、NTILE-n"><a href="#其他函数-NTH-VALUE-expr-n-、NTILE-n" class="headerlink" title="其他函数-NTH-VALUE-expr-n-、NTILE-n"></a>其他函数-NTH_VALUE(expr, n)、NTILE(n)</h4>
<h5 id="介绍-NTH-VALUE-expr-n"><a href="#介绍-NTH-VALUE-expr-n" class="headerlink" title="介绍-NTH-VALUE-expr-n"></a>介绍-NTH_VALUE(expr,n)</h5>
<blockquote>
<ul>
<li>用途：返回窗口中第n个expr的值。expr可以是表达式，也可以是列名</li>
<li>应用场景：截止到当前薪资，显示每个员工的薪资中排名第2或者第3的薪资</li>
</ul>
</blockquote>
<h5 id="操作-28"><a href="#操作-28" class="headerlink" title="操作-28"></a>操作</h5>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">-- 查询每个部门截止目前薪资排在第二和第三的员工信息</span><br><span class="line">select </span><br><span class="line">  dname,</span><br><span class="line">  ename,</span><br><span class="line">  hiredate,</span><br><span class="line">  salary,</span><br><span class="line">  nth_value(salary,2) over(partition by dname order by hiredate) as second_score,</span><br><span class="line">  nth_value(salary,3) over(partition by dname order by hiredate) as third_score</span><br><span class="line">from employee;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p class='item-img' data-src='assets/1728551173493.png'><img src="assets/1728551173493.png" alt="72855117349"></p>
<h5 id="介绍-NTILE"><a href="#介绍-NTILE" class="headerlink" title="介绍-NTILE"></a>介绍-NTILE</h5>
<blockquote>
<ul>
<li>用途：将分区中的有序数据分为n个等级，记录等级数</li>
<li>应用场景：将每个部门员工按照入职日期分成3组</li>
</ul>
</blockquote>
<h5 id="操作-29"><a href="#操作-29" class="headerlink" title="操作-29"></a>操作</h5>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">-- 根据入职日期将每个部门的员工分成3组</span><br><span class="line">select </span><br><span class="line">  dname,</span><br><span class="line">  ename,</span><br><span class="line">  hiredate,</span><br><span class="line">  salary,</span><br><span class="line">ntile(3) over(partition by dname order by  hiredate  ) as rn </span><br><span class="line">from employee;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p class='item-img' data-src='assets/1728552007010.png'><img src="assets/1728552007010.png" alt="72855200701"></p>
<h5 id="练习-2"><a href="#练习-2" class="headerlink" title="练习-2"></a>练习</h5>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">-- 取出每个部门的第一组员工</span><br><span class="line">select</span><br><span class="line">*</span><br><span class="line">from</span><br><span class="line">(</span><br><span class="line">    SELECT </span><br><span class="line">        dname,</span><br><span class="line">        ename,</span><br><span class="line">        hiredate,</span><br><span class="line">        salary,</span><br><span class="line">    NTILE(3) OVER(PARTITION BY dname ORDER BY  hiredate  ) AS rn </span><br><span class="line">    FROM employee</span><br><span class="line">)t</span><br><span class="line">where t.rn = 1;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p class='item-img' data-src='assets/1728552403002.png'><img src="assets/1728552403002.png" alt="72855240300"></p>
<h2 id="MySQL的视图"><a href="#MySQL的视图" class="headerlink" title="MySQL的视图"></a>MySQL的视图</h2>
<h3 id="介绍-15"><a href="#介绍-15" class="headerlink" title="介绍-15"></a>介绍</h3>
<blockquote>
<ul>
<li>视图（view）是一个虚拟表，非真实存在，其本质是根据SQL语句获取动态的数据集，并为其命名，用户使用时只需使用视图名称即可获取结果集，并可以将其当作表来使用。(就是原表的一个映射)</li>
<li>数据库中只存放了视图的定义，而并没有存放视图中的数据。这些数据存放在原来的表中。</li>
<li>使用视图查询数据时，数据库系统会从原来的表中取出对应的数据。因此，视图中的数据是依赖于原来的表中的数据的。一旦表中的数据发生改变，显示在视图中的数据也会发生改变。</li>
</ul>
</blockquote>
<h3 id="作用-2"><a href="#作用-2" class="headerlink" title="作用-2"></a>作用</h3>
<blockquote>
<ul>
<li>简化代码，可以把重复使用的查询封装成视图重复使用，同时可以使复杂的查询易于理解和使用。</li>
<li>安全原因，如果一张表中有很多数据，很多信息不希望让所有人看到，此时可以使用视图视，如：社会保险基金表，可以用视图只显示姓名，地址，而不显示社会保险号和工资数等，可以对不同的用户，设定不同的视图。</li>
</ul>
</blockquote>
<h3 id="视图的创建"><a href="#视图的创建" class="headerlink" title="视图的创建"></a>视图的创建</h3>
<h4 id="格式-14"><a href="#格式-14" class="headerlink" title="格式-14"></a>格式</h4>
<p>创建视图的语法为：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">create [or replace] [algorithm = &#123;undefined | merge | temptable&#125;]</span><br><span class="line"> </span><br><span class="line">view view_name [(column_list)]</span><br><span class="line"> </span><br><span class="line">as select_statement</span><br><span class="line"> </span><br><span class="line">[with [cascaded | local] check option]</span><br><span class="line"></span><br><span class="line">参数说明：</span><br><span class="line">（1）algorithm：可选项，表示视图选择的算法。</span><br><span class="line">（2）view_name ：表示要创建的视图名称。</span><br><span class="line">（3）column_list：可选项，指定视图中各个属性的名词，默认情况下与SELECT语句中的查询的属性相同。</span><br><span class="line">（4）select_statement  ：表示一个完整的查询语句，将查询记录导入视图中。</span><br><span class="line">（5）[with [cascaded | local] check option] ：可选项，表示更新视图时要保证在该视图的权限范围之内。</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h4 id="数据准备"><a href="#数据准备" class="headerlink" title="数据准备"></a>数据准备</h4>
<p>创建 数据库mydb6_view,然后在该数据库下执行sql脚本view_data.sql 导入数据</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line">create database mydb6_view;</span><br><span class="line"></span><br><span class="line">-- 创建部门表并插入数据</span><br><span class="line">create table dept(</span><br><span class="line">	deptno int primary key,</span><br><span class="line">  dname varchar(20),</span><br><span class="line">	loc varchar(20)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">insert into dept values(10, &#x27;教研部&#x27;,&#x27;北京&#x27;),</span><br><span class="line">(20, &#x27;学工部&#x27;,&#x27;上海&#x27;),</span><br><span class="line">(30, &#x27;销售部&#x27;,&#x27;广州&#x27;),</span><br><span class="line">(40, &#x27;财务部&#x27;,&#x27;武汉&#x27;);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">-- 创建员工表并插入数据</span><br><span class="line">create table emp(</span><br><span class="line">	empno int primary key,</span><br><span class="line">	ename varchar(20),</span><br><span class="line">	job varchar(20),</span><br><span class="line">	mgr int,</span><br><span class="line">	hiredate date,</span><br><span class="line">	sal numeric(8,2),</span><br><span class="line">	comm numeric(8, 2),</span><br><span class="line">	deptno int,</span><br><span class="line">-- 	FOREIGN KEY (mgr) REFERENCES emp(empno),</span><br><span class="line">	FOREIGN KEY (deptno) REFERENCES dept(deptno) ON DELETE SET NULL ON UPDATE CASCADE</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">INSERT INTO emp VALUES</span><br><span class="line">(1001, &#x27;甘宁&#x27;, &#x27;文员&#x27;, 1013, &#x27;2000-12-17&#x27;, 8000.00, NULL, 20),</span><br><span class="line">(1002, &#x27;黛绮丝&#x27;, &#x27;销售员&#x27;, 1006, &#x27;2001-02-20&#x27;, 16000.00, 3000.00, 30),</span><br><span class="line">(1003, &#x27;殷天正&#x27;, &#x27;销售员&#x27;, 1006, &#x27;2001-02-22&#x27;, 12500.00, 5000.00, 30),</span><br><span class="line">(1004, &#x27;刘备&#x27;, &#x27;经理&#x27;, 1009, &#x27;2001-4-02&#x27;, 29750.00, NULL, 20),</span><br><span class="line">(1005, &#x27;谢逊&#x27;, &#x27;销售员&#x27;, 1006, &#x27;2001-9-28&#x27;, 12500.00, 14000.00, 30),</span><br><span class="line">(1006, &#x27;关羽&#x27;, &#x27;经理&#x27;, 1009, &#x27;2001-05-01&#x27;, 28500.00, NULL, 30),</span><br><span class="line">(1007, &#x27;张飞&#x27;, &#x27;经理&#x27;, 1009, &#x27;2001-09-01&#x27;, 24500.00, NULL, 10),</span><br><span class="line">(1008, &#x27;诸葛亮&#x27;, &#x27;分析师&#x27;, 1004, &#x27;2007-04-19&#x27;, 30000.00, NULL, 20),</span><br><span class="line">(1009, &#x27;曾阿牛&#x27;, &#x27;董事长&#x27;, NULL, &#x27;2001-11-17&#x27;, 50000.00, NULL, 10),</span><br><span class="line">(1010, &#x27;韦一笑&#x27;, &#x27;销售员&#x27;, 1006, &#x27;2001-09-08&#x27;, 15000.00, 0.00, 30),</span><br><span class="line">(1011, &#x27;周泰&#x27;, &#x27;文员&#x27;, 1008, &#x27;2007-05-23&#x27;, 11000.00, NULL, 20),</span><br><span class="line">(1012, &#x27;程普&#x27;, &#x27;文员&#x27;, 1006, &#x27;2001-12-03&#x27;, 9500.00, NULL, 30),</span><br><span class="line">(1013, &#x27;庞统&#x27;, &#x27;分析师&#x27;, 1004, &#x27;2001-12-03&#x27;, 30000.00, NULL, 20),</span><br><span class="line">(1014, &#x27;黄盖&#x27;, &#x27;文员&#x27;, 1007, &#x27;2002-01-23&#x27;, 13000.00, NULL, 10);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">-- 创建工资等级表并插入数据</span><br><span class="line">create table salgrade (</span><br><span class="line">	grade int,  -- 等级</span><br><span class="line">	losal double,  -- 最低工资</span><br><span class="line">	hisal double  -- 最高工资</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">-- 插入数据</span><br><span class="line">insert into salgrade values (1,7000,12000);</span><br><span class="line">insert into salgrade values (2,12010,14000);</span><br><span class="line">insert into salgrade values (3,14010,20000);</span><br><span class="line">insert into salgrade values (4,20010,30000);</span><br><span class="line">insert into salgrade values (5,30010,99990);</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h4 id="操作-30"><a href="#操作-30" class="headerlink" title="操作-30"></a>操作</h4>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">-- 创建视图</span><br><span class="line">create or replace view view1_emp</span><br><span class="line">as </span><br><span class="line">select ename,job from emp; </span><br><span class="line"></span><br><span class="line">-- 查看表和视图 </span><br><span class="line">show full tables;</span><br></pre></td></tr></table></figure>
<h3 id="修改视图"><a href="#修改视图" class="headerlink" title="修改视图"></a>修改视图</h3>
<p>修改视图是指修改数据库中已存在的表的定义。当基本表的某些字段发生改变时，可以通过修改视图来保持视图和基本表之间一致。MySQL中通过<code>CREATE OR REPLACE VIEW</code>语句来创建视图和<code>ALTER VIEW</code>语句来修改视图。</p>
<h4 id="格式-15"><a href="#格式-15" class="headerlink" title="格式-15"></a>格式</h4>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">alter view 视图名 as select语句</span><br></pre></td></tr></table></figure>
<h4 id="操作-31"><a href="#操作-31" class="headerlink" title="操作-31"></a>操作</h4>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">alter view view1_emp</span><br><span class="line">as </span><br><span class="line">select a.deptno,a.dname,a.loc,b.ename,b.sal from dept a, emp b where a.deptno = b.deptno;</span><br></pre></td></tr></table></figure>
<h3 id="更新视图"><a href="#更新视图" class="headerlink" title="更新视图"></a>更新视图</h3>
<h4 id="介绍-16"><a href="#介绍-16" class="headerlink" title="介绍-16"></a>介绍</h4>
<blockquote>
<p>某些视图是可更新的。也就是说，可以在UPDATE、DELETE或INSERT等语句中使用它们，以更新基表的内容。对于可更新的视图，在视图中的行和基表中的行之间必须具有一对一的关系。如果视图包含下述结构中的任何一种，那么它就是不可更新的：</p>
<blockquote>
<ul>
<li>聚合函数（SUM(), MIN(), MAX(), COUNT()等）</li>
<li>DISTINCT</li>
<li>GROUP BY</li>
<li>HAVING</li>
<li>UNION或UNION ALL</li>
<li>位于选择列表中的子查询</li>
<li>JOIN</li>
<li>FROM子句中的不可更新视图</li>
<li>WHERE子句中的子查询，引用FROM子句中的表。</li>
<li>仅引用文字值（在该情况下，没有要更新的基本表）</li>
</ul>
</blockquote>
</blockquote>
<p><strong>视图中虽然可以更新数据，但是有很多的限制。一般情况下，最好将视图作为查询数据的虚拟表，而不要通过视图更新数据。因为，使用视图更新数据时，如果没有全面考虑在视图中更新数据的限制，就可能会造成数据更新失败。</strong></p>
<h4 id="操作-32"><a href="#操作-32" class="headerlink" title="操作-32"></a>操作</h4>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line">--  ---------更新视图-------</span><br><span class="line">create or replace view view1_emp</span><br><span class="line">as </span><br><span class="line">select ename,job from emp;</span><br><span class="line"> </span><br><span class="line">update view1_emp set ename = &#x27;周瑜&#x27; where ename = &#x27;鲁肃&#x27;;  -- 可以修改</span><br><span class="line">insert into view1_emp values(&#x27;孙权&#x27;,&#x27;文员&#x27;);  -- 不可以插入</span><br><span class="line"></span><br><span class="line">-- ----------视图包含聚合函数不可更新--------------</span><br><span class="line">create or replace view view2_emp</span><br><span class="line">as </span><br><span class="line">select count(*) cnt from emp;</span><br><span class="line"> </span><br><span class="line">insert into view2_emp values(100);</span><br><span class="line">update view2_emp set cnt = 100; </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">-- ----------视图包含distinct不可更新---------</span><br><span class="line">create or replace view view3_emp</span><br><span class="line">as </span><br><span class="line">select distinct job from emp;</span><br><span class="line"> </span><br><span class="line">insert into view3_emp values(&#x27;财务&#x27;);</span><br><span class="line"> </span><br><span class="line">-- ----------视图包含goup by 、having不可更新------------------</span><br><span class="line"> </span><br><span class="line">create or replace view view4_emp</span><br><span class="line">as </span><br><span class="line">select deptno ,count(*) cnt from emp group by deptno having  cnt &gt; 2;</span><br><span class="line"> </span><br><span class="line">insert into view4_emp values(30,100);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">-- ----------------视图包含union或者union all不可更新----------------</span><br><span class="line">create or replace view view5_emp</span><br><span class="line">as </span><br><span class="line">select empno,ename from emp where empno &lt;= 1005</span><br><span class="line">union </span><br><span class="line">select empno,ename from emp where empno &gt; 1005;</span><br><span class="line"> </span><br><span class="line">insert into view5_emp values(1015,&#x27;韦小宝&#x27;);</span><br><span class="line"></span><br><span class="line">-- -------------------视图包含子查询不可更新--------------------</span><br><span class="line">create or replace view view6_emp</span><br><span class="line">as </span><br><span class="line">select empno,ename,sal from emp where sal = (select max(sal) from emp);</span><br><span class="line"> </span><br><span class="line">insert into view6_emp values(1015,&#x27;韦小宝&#x27;,30000);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">-- ----------------------视图包含join不可更新-----------------</span><br><span class="line">create or replace view view7_emp</span><br><span class="line">as </span><br><span class="line">select dname,ename,sal from emp a join  dept b  on a.deptno = b.deptno;</span><br><span class="line"> </span><br><span class="line">insert into view7_emp(dname,ename,sal) values(&#x27;行政部&#x27;,&#x27;韦小宝&#x27;,30000);</span><br><span class="line"> </span><br><span class="line">-- --------------------视图包含常量文字值不可更新-------------------</span><br><span class="line">create or replace view view8_emp</span><br><span class="line">as </span><br><span class="line">select &#x27;行政部&#x27; dname,&#x27;杨过&#x27;  ename;</span><br><span class="line"> </span><br><span class="line">insert into view8_emp values(&#x27;行政部&#x27;,&#x27;韦小宝&#x27;);</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="其他操作"><a href="#其他操作" class="headerlink" title="其他操作"></a>其他操作</h3>
<h4 id="重命名视图"><a href="#重命名视图" class="headerlink" title="重命名视图"></a>重命名视图</h4>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">-- rename table 视图名 to 新视图名; </span><br><span class="line">rename table view1_emp to my_view1</span><br></pre></td></tr></table></figure>
<h4 id="删除视图"><a href="#删除视图" class="headerlink" title="删除视图"></a>删除视图</h4>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">-- drop view 视图名[,视图名…];</span><br><span class="line">drop view if exists view_student;</span><br></pre></td></tr></table></figure>
<p><strong>删除视图时，只能删除视图的定义，不会删除数据。</strong></p>
<h3 id="练习-3"><a href="#练习-3" class="headerlink" title="练习-3"></a>练习</h3>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">-- 1：查询部门平均薪水最高的部门名称</span><br><span class="line">-- 方式一：视图</span><br><span class="line">create view avg_sal as select deptno,avg(sal) from emp group by deptno order by avg(sal) desc limit 1;</span><br><span class="line"></span><br><span class="line">select dname from dept  a ,avg_sal b where a.deptno = b.deptno;  </span><br><span class="line"> </span><br><span class="line">-- 方式二：子查询</span><br><span class="line">select dname from dept  a ,(select deptno,avg(sal) from emp group by deptno order by avg(sal) desc limit 1) b </span><br><span class="line">where a.deptno = b.deptno;   </span><br><span class="line"> </span><br><span class="line">-- 2：查询员工比所属领导薪资高的部门名、员工名、员工领导编号</span><br><span class="line">select * from dept x,</span><br><span class="line">(select a.ename aname ,a.sal asal,b.ename bname,b.sal bsal,a.deptno</span><br><span class="line">from emp a, emp b </span><br><span class="line">where a.mgr = b.empno and a.sal &gt; b.sal) y</span><br><span class="line">where x.deptno = y.deptno;</span><br><span class="line"></span><br><span class="line">-- 3：查询工资等级为4级，2000年以后入职的工作地点为北京的员工编号、姓名和工资，并查询出薪资在前三名的员工信息</span><br><span class="line">create view xxx</span><br><span class="line">as       </span><br><span class="line">SELECT e.empno,e.ename,e.sal,e.hiredate</span><br><span class="line">FROM emp e,dept d,salgrade s</span><br><span class="line">WHERE (e.sal BETWEEN  losal AND hisal) AND s.GRADE = 4</span><br><span class="line">AND year(e.hiredate) &gt; &#x27;2000&#x27;</span><br><span class="line">AND d.loc = &#x27;北京&#x27;;</span><br><span class="line"> </span><br><span class="line">select * from </span><br><span class="line">(</span><br><span class="line">select </span><br><span class="line"> *,</span><br><span class="line"> dense_rank() over(order by sal desc ) rn</span><br><span class="line">from xxx</span><br><span class="line">) t</span><br><span class="line">where t.rn &lt;=3;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<div id="paginator"></div></div><div id="post-footer"><div id="pages"><div class="footer-link" style="width: 50%;text-align:right;border-right:1px #fe2 solid"><a href="/2024/10/08/hello-world/">← Next Hello World</a></div><div class="footer-link" style="width: 50%;right:1px;border-left:1px #fe2 solid"><a href="/2024/10/04/MySQL%E7%AC%94%E8%AE%B0%E6%95%B4%E7%90%86/">MySQL上课笔记整理 Prev →</a></div></div></div></div><div class="bottom-btn"><div><a class="i-top" id="to-top" onClick="scrolls.scrolltop();" title="To Top" style="opacity: 0; display: none;">∧ </a><a class="i-index" id="to-index" href="#toc-div" title="To Catalog">≡</a><a class="i-color" id="color-mode" onClick="colorMode.change()" title="Change Theme"></a></div></div></article><aside><div id="about"><a href="/" id="logo"><img src="https://ak.hypergryph.com/assets/index/images/ak/pc/faction/1.png" alt="Logo"></a><h1 id="Dr"><a href="/">Blue Eagle</a></h1><div id="description"><p></p></div></div><div id="aside-block"><div id="toc-div"><h1>Catalog</h1><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-number">1.</span> <span class="toc-text">MySQL学习代码</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#SQL"><span class="toc-number">1.1.</span> <span class="toc-text">SQL</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#SQL%E9%80%9A%E7%94%A8%E8%AF%AD%E6%B3%95"><span class="toc-number">1.1.1.</span> <span class="toc-text">SQL通用语法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SQL%E5%88%86%E7%B1%BB"><span class="toc-number">1.1.2.</span> <span class="toc-text">SQL分类</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#MySQL%E6%95%B0%E6%8D%AE%E5%BA%93%E5%9F%BA%E6%9C%AC%E6%93%8D%E4%BD%9C%E2%80%94DDL"><span class="toc-number">1.2.</span> <span class="toc-text">MySQL数据库基本操作—DDL</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E5%BA%93%E6%93%8D%E4%BD%9C"><span class="toc-number">1.2.1.</span> <span class="toc-text">数据库操作</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A1%A8%E5%88%9B%E5%BB%BA%E2%80%94%E6%A0%BC%E5%BC%8F"><span class="toc-number">1.2.2.</span> <span class="toc-text">表创建—格式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B%E2%80%94%E6%95%B0%E5%80%BC%E7%B1%BB%E5%9E%8B-%E6%95%B0%E5%AD%97%E7%B1%BB%E5%9E%8B"><span class="toc-number">1.2.3.</span> <span class="toc-text">数据类型—数值类型(数字类型)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B%E2%80%94%E5%AD%97%E7%AC%A6%E4%B8%B2%E7%B1%BB%E5%9E%8B"><span class="toc-number">1.2.4.</span> <span class="toc-text">数据类型—字符串类型</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B%E2%80%94%E6%97%A5%E6%9C%9F%E5%92%8C%E6%97%B6%E9%97%B4%E7%B1%BB%E5%9E%8B"><span class="toc-number">1.2.5.</span> <span class="toc-text">数据类型—日期和时间类型</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%BF%98%E6%9C%89-null-%E7%B1%BB%E5%9E%8B"><span class="toc-number">1.2.5.1.</span> <span class="toc-text">还有 null 类型</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E5%BA%93%E7%9A%84%E5%AD%97%E6%AE%B5%E5%B1%9E%E6%80%A7"><span class="toc-number">1.2.6.</span> <span class="toc-text">数据库的字段属性</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A1%A8%E7%9A%84%E5%85%B6%E4%BB%96%E6%93%8D%E4%BD%9C"><span class="toc-number">1.2.7.</span> <span class="toc-text">表的其他操作</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BF%AE%E6%94%B9%E8%A1%A8%E7%BB%93%E6%9E%84"><span class="toc-number">1.2.8.</span> <span class="toc-text">修改表结构</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BF%AE%E6%94%B9%E8%A1%A8%E6%B7%BB%E5%8A%A0%E5%88%97%EF%BC%88%E5%AD%97%E6%AE%B5%EF%BC%89"><span class="toc-number">1.2.8.1.</span> <span class="toc-text">修改表添加列（字段）</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BF%AE%E6%94%B9%E5%88%97%E5%90%8D%E5%92%8C%E7%B1%BB%E5%9E%8B"><span class="toc-number">1.2.8.2.</span> <span class="toc-text">修改列名和类型</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BF%AE%E6%94%B9%E8%A1%A8%E5%88%A0%E9%99%A4%E5%88%97"><span class="toc-number">1.2.8.3.</span> <span class="toc-text">修改表删除列</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BF%AE%E6%94%B9%E8%A1%A8%E5%90%8D"><span class="toc-number">1.2.8.4.</span> <span class="toc-text">修改表名</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#MySQL%E6%95%B0%E6%8D%AE%E5%BA%93%E5%9F%BA%E6%9C%AC%E6%93%8D%E4%BD%9C%E2%80%94DML"><span class="toc-number">1.3.</span> <span class="toc-text">MySQL数据库基本操作—DML</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#DML%E5%9F%BA%E6%9C%AC%E4%BB%8B%E7%BB%8D"><span class="toc-number">1.3.1.</span> <span class="toc-text">DML基本介绍</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E6%8F%92%E5%85%A5"><span class="toc-number">1.3.2.</span> <span class="toc-text">数据插入</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E4%BF%AE%E6%94%B9"><span class="toc-number">1.3.3.</span> <span class="toc-text">数据修改</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E5%88%A0%E9%99%A4"><span class="toc-number">1.3.4.</span> <span class="toc-text">数据删除</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#MySQL%E7%BA%A6%E6%9D%9F"><span class="toc-number">1.4.</span> <span class="toc-text">MySQL约束</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AE%80%E4%BB%8B"><span class="toc-number">1.4.1.</span> <span class="toc-text">简介</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%A6%82%E5%BF%B5%EF%BC%9A"><span class="toc-number">1.4.1.1.</span> <span class="toc-text">概念：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BD%9C%E7%94%A8"><span class="toc-number">1.4.1.2.</span> <span class="toc-text">作用</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%88%86%E7%B1%BB"><span class="toc-number">1.4.1.3.</span> <span class="toc-text">分类</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%BB%E9%94%AE%E7%BA%A6%E6%9D%9F"><span class="toc-number">1.4.2.</span> <span class="toc-text">主键约束*</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%A6%82%E5%BF%B5%EF%BC%9A-2"><span class="toc-number">1.4.2.1.</span> <span class="toc-text">概念：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%93%8D%E4%BD%9C"><span class="toc-number">1.4.2.2.</span> <span class="toc-text">操作</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%87%AA%E5%A2%9E%E9%95%BF%E7%BA%A6%E6%9D%9F-auto-increment"><span class="toc-number">1.4.3.</span> <span class="toc-text">自增长约束(auto_increment)</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%A6%82%E5%BF%B5%EF%BC%9A-3"><span class="toc-number">1.4.3.1.</span> <span class="toc-text">概念：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%8C%87%E5%AE%9A%E8%87%AA%E5%A2%9E%E5%AD%97%E6%AE%B5%E5%88%9D%E5%A7%8B%E5%80%BC"><span class="toc-number">1.4.3.2.</span> <span class="toc-text">指定自增字段初始值</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%9D%9E%E7%A9%BA%E7%BA%A6%E6%9D%9F-not-null"><span class="toc-number">1.4.4.</span> <span class="toc-text">非空约束(not null)</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%A6%82%E5%BF%B5"><span class="toc-number">1.4.4.1.</span> <span class="toc-text">概念</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%94%AF%E4%B8%80%E7%BA%A6%E6%9D%9F-unique"><span class="toc-number">1.4.5.</span> <span class="toc-text">唯一约束(unique)</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%A6%82%E5%BF%B5-2"><span class="toc-number">1.4.5.1.</span> <span class="toc-text">概念</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%BB%98%E8%AE%A4%E7%BA%A6%E6%9D%9F-default"><span class="toc-number">1.4.6.</span> <span class="toc-text">默认约束(default)</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%A6%82%E5%BF%B5-3"><span class="toc-number">1.4.6.1.</span> <span class="toc-text">概念</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%9B%B6%E5%A1%AB%E5%85%85%E7%BA%A6%E6%9D%9F-zerofill"><span class="toc-number">1.4.7.</span> <span class="toc-text">零填充约束(zerofill)</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%A6%82%E5%BF%B5-4"><span class="toc-number">1.4.7.1.</span> <span class="toc-text">概念</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%93%8D%E4%BD%9C-2"><span class="toc-number">1.4.7.2.</span> <span class="toc-text">操作</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#MySQL%E6%95%B0%E6%8D%AE%E5%BA%93%E5%9F%BA%E6%9C%AC%E6%93%8D%E4%BD%9C%E2%80%94DQL"><span class="toc-number">1.5.</span> <span class="toc-text">MySQL数据库基本操作—DQL</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9F%BA%E6%9C%AC%E4%BB%8B%E7%BB%8D"><span class="toc-number">1.5.1.</span> <span class="toc-text">基本介绍</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%A6%82%E5%BF%B5-5"><span class="toc-number">1.5.1.1.</span> <span class="toc-text">概念</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%AF%AD%E6%B3%95"><span class="toc-number">1.5.1.2.</span> <span class="toc-text">语法</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9F%BA%E6%9C%AC%E6%9F%A5%E8%AF%A2%E2%80%94%E6%95%B0%E6%8D%AE%E5%87%86%E5%A4%87"><span class="toc-number">1.5.2.</span> <span class="toc-text">基本查询—数据准备</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9F%BA%E6%9C%AC%E6%9F%A5%E8%AF%A2%E2%80%94%E7%AE%80%E5%8D%95%E6%9F%A5%E8%AF%A2"><span class="toc-number">1.5.3.</span> <span class="toc-text">基本查询—简单查询</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9F%BA%E6%9C%AC%E6%9F%A5%E8%AF%A2%E2%80%94%E8%BF%90%E7%AE%97%E7%AC%A6"><span class="toc-number">1.5.4.</span> <span class="toc-text">基本查询—运算符</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%AE%80%E4%BB%8B-2"><span class="toc-number">1.5.4.1.</span> <span class="toc-text">简介</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%AE%97%E6%9C%AF%E8%BF%90%E7%AE%97%E7%AC%A6"><span class="toc-number">1.5.4.2.</span> <span class="toc-text">算术运算符</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%AF%94%E8%BE%83%E8%BF%90%E7%AE%97%E7%AC%A6"><span class="toc-number">1.5.4.3.</span> <span class="toc-text">比较运算符</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%80%BB%E8%BE%91%E8%BF%90%E7%AE%97%E7%AC%A6"><span class="toc-number">1.5.4.4.</span> <span class="toc-text">逻辑运算符</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BD%8D%E8%BF%90%E7%AE%97%E7%AC%A6"><span class="toc-number">1.5.4.5.</span> <span class="toc-text">位运算符</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%BF%90%E7%AE%97%E7%AC%A6%E6%93%8D%E4%BD%9C"><span class="toc-number">1.5.4.6.</span> <span class="toc-text">运算符操作</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E7%AE%97%E6%9C%AF%E8%BF%90%E7%AE%97%E7%AC%A6-2"><span class="toc-number">1.5.4.6.1.</span> <span class="toc-text">算术运算符</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%AF%94%E8%BE%83%E8%BF%90%E7%AE%97%E7%AC%A6-2"><span class="toc-number">1.5.4.6.2.</span> <span class="toc-text">比较运算符</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%BD%8D%E8%BF%90%E7%AE%97%E7%AC%A6%EF%BC%88%E4%BA%86%E8%A7%A3%EF%BC%89"><span class="toc-number">1.5.4.6.3.</span> <span class="toc-text">位运算符（了解）</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9F%BA%E6%9C%AC%E6%9F%A5%E8%AF%A2%E2%80%94%E6%8E%92%E5%BA%8F%E6%9F%A5%E8%AF%A2"><span class="toc-number">1.5.5.</span> <span class="toc-text">基本查询—排序查询</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BB%8B%E7%BB%8D"><span class="toc-number">1.5.5.1.</span> <span class="toc-text">介绍</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%89%B9%E7%82%B9"><span class="toc-number">1.5.5.2.</span> <span class="toc-text">特点</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%93%8D%E4%BD%9C-3"><span class="toc-number">1.5.5.3.</span> <span class="toc-text">操作</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9F%BA%E6%9C%AC%E6%9F%A5%E8%AF%A2%E2%80%94%E8%81%9A%E5%90%88%E6%9F%A5%E8%AF%A2"><span class="toc-number">1.5.6.</span> <span class="toc-text">基本查询—聚合查询</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%AE%80%E4%BB%8B-3"><span class="toc-number">1.5.6.1.</span> <span class="toc-text">简介</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%93%8D%E4%BD%9C-4"><span class="toc-number">1.5.6.2.</span> <span class="toc-text">操作</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#NULL%E5%80%BC%E7%9A%84%E5%A4%84%E7%90%86"><span class="toc-number">1.5.6.3.</span> <span class="toc-text">NULL值的处理</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%BB%8B%E7%BB%8D-2"><span class="toc-number">1.5.6.3.1.</span> <span class="toc-text">介绍</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%93%8D%E4%BD%9C-5"><span class="toc-number">1.5.6.3.2.</span> <span class="toc-text">操作</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9F%BA%E6%9C%AC%E6%9F%A5%E8%AF%A2%E2%80%94%E5%88%86%E7%BB%84%E6%9F%A5%E8%AF%A2%E2%80%94group-by"><span class="toc-number">1.5.7.</span> <span class="toc-text">基本查询—分组查询—group by</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%AE%80%E4%BB%8B-4"><span class="toc-number">1.5.7.1.</span> <span class="toc-text">简介</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%88%86%E7%BB%84%E4%B9%8B%E5%90%8E%E7%9A%84%E6%9D%A1%E4%BB%B6%E7%AD%9B%E9%80%89%E2%80%94having"><span class="toc-number">1.5.7.2.</span> <span class="toc-text">分组之后的条件筛选—having</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9F%BA%E6%9C%AC%E6%9F%A5%E8%AF%A2%E2%80%94%E5%88%86%E9%A1%B5%E6%9F%A5%E8%AF%A2%E2%80%94limit"><span class="toc-number">1.5.8.</span> <span class="toc-text">基本查询—分页查询—limit</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%AE%80%E4%BB%8B-5"><span class="toc-number">1.5.8.1.</span> <span class="toc-text">简介</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%A0%BC%E5%BC%8F"><span class="toc-number">1.5.8.2.</span> <span class="toc-text">格式</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%93%8D%E4%BD%9C-6"><span class="toc-number">1.5.8.3.</span> <span class="toc-text">操作</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9F%BA%E6%9C%AC%E6%9F%A5%E8%AF%A2%E2%80%94INSERT-INTO-SELECT%E8%AF%AD%E5%8F%A5"><span class="toc-number">1.5.9.</span> <span class="toc-text">基本查询—INSERT INTO SELECT语句</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%AE%80%E4%BB%8B-6"><span class="toc-number">1.5.9.1.</span> <span class="toc-text">简介</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%A0%BC%E5%BC%8F-2"><span class="toc-number">1.5.9.2.</span> <span class="toc-text">格式</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%93%8D%E4%BD%9C-7"><span class="toc-number">1.5.9.3.</span> <span class="toc-text">操作</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SELECT-INTO-FROM%E8%AF%AD%E5%8F%A5"><span class="toc-number">1.5.10.</span> <span class="toc-text">SELECT INTO FROM语句</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%AE%80%E4%BB%8B-7"><span class="toc-number">1.5.10.1.</span> <span class="toc-text">简介</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%A0%BC%E5%BC%8F-3"><span class="toc-number">1.5.10.2.</span> <span class="toc-text">格式</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%93%8D%E4%BD%9C-8"><span class="toc-number">1.5.10.3.</span> <span class="toc-text">操作</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BB%83%E4%B9%A01"><span class="toc-number">1.5.11.</span> <span class="toc-text">练习1</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BB%83%E4%B9%A02"><span class="toc-number">1.5.12.</span> <span class="toc-text">练习2</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F"><span class="toc-number">1.5.13.</span> <span class="toc-text">正则表达式</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BB%8B%E7%BB%8D-3"><span class="toc-number">1.5.13.1.</span> <span class="toc-text">介绍</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%A0%BC%E5%BC%8F-4"><span class="toc-number">1.5.13.2.</span> <span class="toc-text">格式</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F%E5%8C%B9%E9%85%8D%E6%9F%A5%E8%AF%A2"><span class="toc-number">1.5.14.</span> <span class="toc-text">正则表达式匹配查询</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%93%8D%E4%BD%9C%E4%B8%8A"><span class="toc-number">1.5.14.1.</span> <span class="toc-text">操作上</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%93%8D%E4%BD%9C%E4%B8%8B"><span class="toc-number">1.5.14.2.</span> <span class="toc-text">操作下</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%A4%9A%E8%A1%A8%E6%93%8D%E4%BD%9C"><span class="toc-number">1.6.</span> <span class="toc-text">多表操作</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BB%8B%E7%BB%8D-4"><span class="toc-number">1.6.1.</span> <span class="toc-text">介绍</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A4%9A%E8%A1%A8%E5%85%B3%E7%B3%BB"><span class="toc-number">1.6.2.</span> <span class="toc-text">多表关系</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%B8%80%E5%AF%B9%E4%B8%80%E5%85%B3%E7%B3%BB"><span class="toc-number">1.6.2.1.</span> <span class="toc-text">一对一关系</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%B8%80%E5%AF%B9%E5%A4%9A-%E5%A4%9A%E5%AF%B9%E4%B8%80%E5%85%B3%E7%B3%BB"><span class="toc-number">1.6.2.2.</span> <span class="toc-text">一对多&#x2F;多对一关系</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%A4%9A%E5%AF%B9%E5%A4%9A%E5%85%B3%E7%B3%BB"><span class="toc-number">1.6.2.3.</span> <span class="toc-text">多对多关系</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A4%96%E9%94%AE%E7%BA%A6%E6%9D%9F%E2%80%94%E6%A6%82%E5%BF%B5"><span class="toc-number">1.6.3.</span> <span class="toc-text">外键约束—概念</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BB%8B%E7%BB%8D-5"><span class="toc-number">1.6.3.1.</span> <span class="toc-text">介绍</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%89%B9%E7%82%B9-2"><span class="toc-number">1.6.3.2.</span> <span class="toc-text">特点</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A4%96%E9%94%AE%E7%BA%A6%E6%9D%9F%E2%80%94%E4%B8%80%E5%AF%B9%E5%A4%9A%E5%85%B3%E7%B3%BB"><span class="toc-number">1.6.4.</span> <span class="toc-text">外键约束—一对多关系</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%93%8D%E4%BD%9C-%E5%88%9B%E5%BB%BA%E5%A4%96%E9%94%AE%E7%BA%A6%E6%9D%9F"><span class="toc-number">1.6.4.1.</span> <span class="toc-text">操作-创建外键约束</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%93%8D%E4%BD%9C-%E5%9C%A8%E5%A4%96%E9%94%AE%E7%BA%A6%E6%9D%9F%E4%B8%8B%E7%9A%84%E6%95%B0%E6%8D%AE%E6%93%8D%E4%BD%9C"><span class="toc-number">1.6.4.2.</span> <span class="toc-text">操作-在外键约束下的数据操作</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%93%8D%E4%BD%9C-%E5%88%A0%E9%99%A4%E5%A4%96%E9%94%AE%E7%BA%A6%E6%9D%9F"><span class="toc-number">1.6.4.3.</span> <span class="toc-text">操作-删除外键约束</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A4%96%E9%94%AE%E7%BA%A6%E6%9D%9F-%E5%A4%9A%E5%AF%B9%E5%A4%9A%E5%85%B3%E7%B3%BB"><span class="toc-number">1.6.5.</span> <span class="toc-text">外键约束-多对多关系</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BB%8B%E7%BB%8D-6"><span class="toc-number">1.6.5.1.</span> <span class="toc-text">介绍</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%93%8D%E4%BD%9C-9"><span class="toc-number">1.6.5.2.</span> <span class="toc-text">操作</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A4%9A%E8%A1%A8%E8%81%94%E5%90%88%E6%9F%A5%E8%AF%A2"><span class="toc-number">1.6.6.</span> <span class="toc-text">多表联合查询</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BB%8B%E7%BB%8D-7"><span class="toc-number">1.6.6.1.</span> <span class="toc-text">介绍</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%87%86%E5%A4%87%E6%9F%A5%E8%AF%A2%E6%95%B0%E6%8D%AE"><span class="toc-number">1.6.6.2.</span> <span class="toc-text">准备查询数据</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A4%9A%E8%A1%A8%E8%81%94%E5%90%88%E6%9F%A5%E8%AF%A2%E2%80%94%E4%BA%A4%E5%8F%89%E8%BF%9E%E6%8E%A5%E6%9F%A5%E8%AF%A2"><span class="toc-number">1.6.7.</span> <span class="toc-text">多表联合查询—交叉连接查询</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%A0%BC%E5%BC%8F%EF%BC%9A"><span class="toc-number">1.6.7.1.</span> <span class="toc-text">格式：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%9E%E7%8E%B0%EF%BC%9A"><span class="toc-number">1.6.7.2.</span> <span class="toc-text">实现：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%BB%93%E6%9E%9C%EF%BC%9A"><span class="toc-number">1.6.7.3.</span> <span class="toc-text">结果：</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A4%9A%E8%A1%A8%E8%81%94%E5%90%88%E6%9F%A5%E8%AF%A2%E2%80%94%E5%86%85%E8%BF%9E%E6%8E%A5%E6%9F%A5%E8%AF%A2"><span class="toc-number">1.6.8.</span> <span class="toc-text">多表联合查询—内连接查询</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%A0%BC%E5%BC%8F-5"><span class="toc-number">1.6.8.1.</span> <span class="toc-text">格式</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%93%8D%E4%BD%9C-10"><span class="toc-number">1.6.8.2.</span> <span class="toc-text">操作</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A4%96%E8%BF%9E%E6%8E%A5%E6%9F%A5%E8%AF%A2"><span class="toc-number">1.6.9.</span> <span class="toc-text">外连接查询</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%A0%BC%E5%BC%8F-6"><span class="toc-number">1.6.9.1.</span> <span class="toc-text">格式</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%93%8D%E4%BD%9C-11"><span class="toc-number">1.6.9.2.</span> <span class="toc-text">操作</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AD%90%E6%9F%A5%E8%AF%A2"><span class="toc-number">1.6.10.</span> <span class="toc-text">子查询</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BB%8B%E7%BB%8D-8"><span class="toc-number">1.6.10.1.</span> <span class="toc-text">介绍</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%89%B9%E7%82%B9-3"><span class="toc-number">1.6.10.2.</span> <span class="toc-text">特点</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%93%8D%E4%BD%9C-12"><span class="toc-number">1.6.10.3.</span> <span class="toc-text">操作</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AD%90%E6%9F%A5%E8%AF%A2%E5%85%B3%E9%94%AE%E5%AD%97"><span class="toc-number">1.6.11.</span> <span class="toc-text">子查询关键字</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BB%8B%E7%BB%8D-9"><span class="toc-number">1.6.11.1.</span> <span class="toc-text">介绍</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AD%90%E6%9F%A5%E8%AF%A2%E5%85%B3%E9%94%AE%E5%AD%97%E2%80%94ALL"><span class="toc-number">1.6.11.2.</span> <span class="toc-text">子查询关键字—ALL</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%A0%BC%E5%BC%8F-7"><span class="toc-number">1.6.11.2.1.</span> <span class="toc-text">格式</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E7%89%B9%E7%82%B9-4"><span class="toc-number">1.6.11.2.2.</span> <span class="toc-text">特点</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%93%8D%E4%BD%9C-13"><span class="toc-number">1.6.11.2.3.</span> <span class="toc-text">操作</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AD%90%E6%9F%A5%E8%AF%A2%E5%85%B3%E9%94%AE%E5%AD%97-ANY%E5%92%8CSOME"><span class="toc-number">1.6.11.3.</span> <span class="toc-text">子查询关键字-ANY和SOME</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%A0%BC%E5%BC%8F-8"><span class="toc-number">1.6.11.3.1.</span> <span class="toc-text">格式</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E7%89%B9%E7%82%B9-5"><span class="toc-number">1.6.11.3.2.</span> <span class="toc-text">特点</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%93%8D%E4%BD%9C-14"><span class="toc-number">1.6.11.3.3.</span> <span class="toc-text">操作</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AD%90%E6%9F%A5%E8%AF%A2%E5%85%B3%E9%94%AE%E5%AD%97-IN"><span class="toc-number">1.6.11.4.</span> <span class="toc-text">子查询关键字-IN</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%A0%BC%E5%BC%8F-9"><span class="toc-number">1.6.11.4.1.</span> <span class="toc-text">格式</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E7%89%B9%E7%82%B9-6"><span class="toc-number">1.6.11.4.2.</span> <span class="toc-text">特点</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%93%8D%E4%BD%9C-15"><span class="toc-number">1.6.11.4.3.</span> <span class="toc-text">操作</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AD%90%E6%9F%A5%E8%AF%A2%E5%85%B3%E9%94%AE%E5%AD%97-EXISTS"><span class="toc-number">1.6.11.5.</span> <span class="toc-text">子查询关键字-EXISTS</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%A0%BC%E5%BC%8F-10"><span class="toc-number">1.6.11.5.1.</span> <span class="toc-text">格式</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E7%89%B9%E7%82%B9-7"><span class="toc-number">1.6.11.5.2.</span> <span class="toc-text">特点</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%93%8D%E4%BD%9C-16"><span class="toc-number">1.6.11.5.3.</span> <span class="toc-text">操作</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%87%AA%E5%85%B3%E8%81%94%E6%9F%A5%E8%AF%A2"><span class="toc-number">1.6.12.</span> <span class="toc-text">自关联查询</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%A6%82%E5%BF%B5-6"><span class="toc-number">1.6.12.1.</span> <span class="toc-text">概念</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%A0%BC%E5%BC%8F-11"><span class="toc-number">1.6.12.2.</span> <span class="toc-text">格式</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%93%8D%E4%BD%9C-17"><span class="toc-number">1.6.12.3.</span> <span class="toc-text">操作</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BB%83%E4%B9%A0"><span class="toc-number">1.6.13.</span> <span class="toc-text">练习</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#MySQL%E5%87%BD%E6%95%B0"><span class="toc-number">1.7.</span> <span class="toc-text">MySQL函数</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9F%BA%E6%9C%AC%E4%BB%8B%E7%BB%8D-2"><span class="toc-number">1.7.1.</span> <span class="toc-text">基本介绍</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%A6%82%E8%BF%B0"><span class="toc-number">1.7.1.1.</span> <span class="toc-text">概述</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%88%86%E7%B1%BB-2"><span class="toc-number">1.7.1.2.</span> <span class="toc-text">分类</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%81%9A%E5%90%88%E5%87%BD%E6%95%B0"><span class="toc-number">1.7.2.</span> <span class="toc-text">聚合函数</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%A6%82%E8%BF%B0-2"><span class="toc-number">1.7.2.1.</span> <span class="toc-text">概述</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%A0%BC%E5%BC%8F-12"><span class="toc-number">1.7.2.2.</span> <span class="toc-text">格式</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%93%8D%E4%BD%9C-18"><span class="toc-number">1.7.2.3.</span> <span class="toc-text">操作</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%B0%E5%AD%A6%E5%87%BD%E6%95%B0"><span class="toc-number">1.7.3.</span> <span class="toc-text">数学函数</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%87%BD%E6%95%B0%E5%90%8D"><span class="toc-number">1.7.3.1.</span> <span class="toc-text">函数名</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%93%8D%E4%BD%9C-19"><span class="toc-number">1.7.3.2.</span> <span class="toc-text">操作</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AD%97%E7%AC%A6%E4%B8%B2%E5%87%BD%E6%95%B0"><span class="toc-number">1.7.4.</span> <span class="toc-text">字符串函数</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%87%BD%E6%95%B0%E5%90%8D-2"><span class="toc-number">1.7.4.1.</span> <span class="toc-text">函数名</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%93%8D%E4%BD%9C-20"><span class="toc-number">1.7.4.2.</span> <span class="toc-text">操作</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%97%A5%E6%9C%9F%E5%87%BD%E6%95%B0"><span class="toc-number">1.7.5.</span> <span class="toc-text">日期函数</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%87%BD%E6%95%B0%E5%90%8D-3"><span class="toc-number">1.7.5.1.</span> <span class="toc-text">函数名</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%93%8D%E4%BD%9C-21"><span class="toc-number">1.7.5.2.</span> <span class="toc-text">操作</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8E%A7%E5%88%B6%E6%B5%81%E5%87%BD%E6%95%B0"><span class="toc-number">1.7.6.</span> <span class="toc-text">控制流函数</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#if%E9%80%BB%E8%BE%91%E5%88%A4%E6%96%AD%E8%AF%AD%E5%8F%A5"><span class="toc-number">1.7.6.1.</span> <span class="toc-text">if逻辑判断语句</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#case-when%E8%AF%AD%E5%8F%A5"><span class="toc-number">1.7.6.2.</span> <span class="toc-text">case when语句</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%A1%88%E4%BE%8B"><span class="toc-number">1.7.6.2.1.</span> <span class="toc-text">案例</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AA%97%E5%8F%A3%E5%87%BD%E6%95%B0"><span class="toc-number">1.7.7.</span> <span class="toc-text">窗口函数</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BB%8B%E7%BB%8D-10"><span class="toc-number">1.7.7.1.</span> <span class="toc-text">介绍</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%88%86%E7%B1%BB-3"><span class="toc-number">1.7.7.2.</span> <span class="toc-text">分类</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%AF%AD%E6%B3%95%E7%BB%93%E6%9E%84"><span class="toc-number">1.7.7.3.</span> <span class="toc-text">语法结构</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%BA%8F%E5%8F%B7%E5%87%BD%E6%95%B0"><span class="toc-number">1.7.7.4.</span> <span class="toc-text">序号函数</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%A0%BC%E5%BC%8F-13"><span class="toc-number">1.7.7.4.1.</span> <span class="toc-text">格式</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%93%8D%E4%BD%9C-22"><span class="toc-number">1.7.7.4.2.</span> <span class="toc-text">操作</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%BC%80%E7%AA%97%E8%81%9A%E5%90%88%E5%87%BD%E6%95%B0-SUM-AVG-MIN-MAX"><span class="toc-number">1.7.7.5.</span> <span class="toc-text">开窗聚合函数- SUM,AVG,MIN,MAX</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%A6%82%E5%BF%B5-7"><span class="toc-number">1.7.7.5.1.</span> <span class="toc-text">概念</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%93%8D%E4%BD%9C-23"><span class="toc-number">1.7.7.5.2.</span> <span class="toc-text">操作</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%88%86%E5%B8%83%E5%87%BD%E6%95%B0-CUME-DIST"><span class="toc-number">1.7.7.6.</span> <span class="toc-text">分布函数-(CUME_DIST)</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%BB%8B%E7%BB%8D-11"><span class="toc-number">1.7.7.6.1.</span> <span class="toc-text">介绍</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%93%8D%E4%BD%9C-24"><span class="toc-number">1.7.7.6.2.</span> <span class="toc-text">操作</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%88%86%E5%B8%83%E5%87%BD%E6%95%B0-PERCENT-RANK"><span class="toc-number">1.7.7.7.</span> <span class="toc-text">分布函数-(PERCENT_RANK)</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%BB%8B%E7%BB%8D-12"><span class="toc-number">1.7.7.7.1.</span> <span class="toc-text">介绍</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%93%8D%E4%BD%9C-25"><span class="toc-number">1.7.7.7.2.</span> <span class="toc-text">操作</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%89%8D%E5%90%8E%E5%87%BD%E6%95%B0-LAG%E5%92%8CLEAD"><span class="toc-number">1.7.7.8.</span> <span class="toc-text">前后函数-LAG和LEAD</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%BB%8B%E7%BB%8D-13"><span class="toc-number">1.7.7.8.1.</span> <span class="toc-text">介绍</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%93%8D%E4%BD%9C-26"><span class="toc-number">1.7.7.8.2.</span> <span class="toc-text">操作</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%A4%B4%E5%B0%BE%E5%87%BD%E6%95%B0-FIRST-VALUE%E5%92%8CLAST-VALUE"><span class="toc-number">1.7.7.9.</span> <span class="toc-text">头尾函数-FIRST_VALUE和LAST_VALUE</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%BB%8B%E7%BB%8D-14"><span class="toc-number">1.7.7.9.1.</span> <span class="toc-text">介绍</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%93%8D%E4%BD%9C-27"><span class="toc-number">1.7.7.9.2.</span> <span class="toc-text">操作</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%85%B6%E4%BB%96%E5%87%BD%E6%95%B0-NTH-VALUE-expr-n-%E3%80%81NTILE-n"><span class="toc-number">1.7.7.10.</span> <span class="toc-text">其他函数-NTH_VALUE(expr, n)、NTILE(n)</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%BB%8B%E7%BB%8D-NTH-VALUE-expr-n"><span class="toc-number">1.7.7.10.1.</span> <span class="toc-text">介绍-NTH_VALUE(expr,n)</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%93%8D%E4%BD%9C-28"><span class="toc-number">1.7.7.10.2.</span> <span class="toc-text">操作</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%BB%8B%E7%BB%8D-NTILE"><span class="toc-number">1.7.7.10.3.</span> <span class="toc-text">介绍-NTILE</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%93%8D%E4%BD%9C-29"><span class="toc-number">1.7.7.10.4.</span> <span class="toc-text">操作</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E7%BB%83%E4%B9%A0-2"><span class="toc-number">1.7.7.10.5.</span> <span class="toc-text">练习</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#MySQL%E7%9A%84%E8%A7%86%E5%9B%BE"><span class="toc-number">1.8.</span> <span class="toc-text">MySQL的视图</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BB%8B%E7%BB%8D-15"><span class="toc-number">1.8.1.</span> <span class="toc-text">介绍</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%9C%E7%94%A8-2"><span class="toc-number">1.8.2.</span> <span class="toc-text">作用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A7%86%E5%9B%BE%E7%9A%84%E5%88%9B%E5%BB%BA"><span class="toc-number">1.8.3.</span> <span class="toc-text">视图的创建</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%A0%BC%E5%BC%8F-14"><span class="toc-number">1.8.3.1.</span> <span class="toc-text">格式</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E5%87%86%E5%A4%87"><span class="toc-number">1.8.3.2.</span> <span class="toc-text">数据准备</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%93%8D%E4%BD%9C-30"><span class="toc-number">1.8.3.3.</span> <span class="toc-text">操作</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BF%AE%E6%94%B9%E8%A7%86%E5%9B%BE"><span class="toc-number">1.8.4.</span> <span class="toc-text">修改视图</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%A0%BC%E5%BC%8F-15"><span class="toc-number">1.8.4.1.</span> <span class="toc-text">格式</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%93%8D%E4%BD%9C-31"><span class="toc-number">1.8.4.2.</span> <span class="toc-text">操作</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9B%B4%E6%96%B0%E8%A7%86%E5%9B%BE"><span class="toc-number">1.8.5.</span> <span class="toc-text">更新视图</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BB%8B%E7%BB%8D-16"><span class="toc-number">1.8.5.1.</span> <span class="toc-text">介绍</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%93%8D%E4%BD%9C-32"><span class="toc-number">1.8.5.2.</span> <span class="toc-text">操作</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%85%B6%E4%BB%96%E6%93%8D%E4%BD%9C"><span class="toc-number">1.8.6.</span> <span class="toc-text">其他操作</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%87%8D%E5%91%BD%E5%90%8D%E8%A7%86%E5%9B%BE"><span class="toc-number">1.8.6.1.</span> <span class="toc-text">重命名视图</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%88%A0%E9%99%A4%E8%A7%86%E5%9B%BE"><span class="toc-number">1.8.6.2.</span> <span class="toc-text">删除视图</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BB%83%E4%B9%A0-3"><span class="toc-number">1.8.7.</span> <span class="toc-text">练习</span></a></li></ol></li></ol></li></ol></div></div><footer><nobr>Published with <a target="_blank" rel="noopener" href="http://hexo.io">Hexo</a></nobr><wbr><nobr> Theme <a target="_blank" rel="noopener" href="https://github.com/Yue-plus/hexo-theme-arknights">Arknights</a></nobr><wbr><nobr> by <a target="_blank" rel="noopener" href="https://github.com/Yue-plus">Yue_plus</a></nobr></footer></aside></main><canvas id="canvas-dust"></canvas></body></html>